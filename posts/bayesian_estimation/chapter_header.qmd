---
title: "ãƒ™ã‚¤ã‚ºæ¨å®š"
author: "Ryo Nakagami"
date: "2024-10-03"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

## ãƒ™ã‚¤ã‚ºæ¨æ¸¬ã®è€ƒãˆæ–¹

ãƒ™ã‚¤ã‚ºæ¨æ¸¬ã«ãŠã‘ã‚‹ç¢ºç‡ã¯ï¼Œ**æœªçŸ¥ã®é‡ã«ã¤ã„ã¦äººã€…ã®ã‚‚ã¤åˆç†çš„ãªæƒ…å ±ã‚„ä¿¡å¿µ(belief)ã‚’æ•°å€¤çš„ã«è¡¨ã—ãŸã‚‚ã®**ã¨ã—ã¦ã„ã¾ã™ï¼
æ—¥å¸¸ç”Ÿæ´»ã«ãŠã„ã¦ï¼Œæƒ…å ±ãŒæ›´æ–°ã•ã‚Œã‚‹ã“ã¨ã«ã‚ã‚ã›ã¦ä¿¡å¿µãŒæ›´æ–°ã•ã‚Œã¾ã™ãŒ(ä¾‹: ç›¸æ‰‹ãŒé£›è»Šã‚’æŒ¯ã£ã¦ããŸã‚‰ï¼Œå°‘ãªãã¨ã‚‚å±…é£›è»Šã¯ãªã„ã ã‚ã†ãªã©)ï¼Œ
ãƒ™ã‚¤ã‚ºæ¨æ¸¬ã§ã‚‚ãƒ™ã‚¤ã‚ºãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ï¼Œæ–°ãŸãªæƒ…å ±ã®è¦³æ¸¬ã«ã‚ˆã£ã¦ä¿¡å¿µã‚’æ›´æ–°ã—ã¦ã„ãã¾ã™ï¼

ã‚ã‚‹é›†å›£ã®ä¸€èˆ¬çš„ãªç‰¹æ€§ã‚’è¡¨ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\theta$ ã«ã¤ã„ã¦ï¼Œãã®é›†å›£ã‹ã‚‰ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã•ã‚ŒãŸæ¨™æœ¬ãƒ‡ãƒ¼ã‚¿ $y$ ãŒå¾—ã‚‰ã‚Œã‚‹å‰ã§ã¯ï¼Œ
ãã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ä¸ç¢ºå®šã§ã™ãŒï¼Œãƒ‡ãƒ¼ã‚¿ $y$ ãŒå¾—ã‚‰ã‚ŒãŸã‚ã¨ã§ã¯ï¼Œãã®æƒ…å ±ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹ä¸ç¢ºå®Ÿæ€§(uncertainty)ã‚’æ¸›ã‚‰ã™ã“ã¨ã«ãªã‚Šã¾ã™ï¼
ã“ã®ä¸ç¢ºå®Ÿæ€§ã®å¤‰åŒ–ã‚’æ¸¬ã‚‹ã®ãŒãƒ™ã‚¤ã‚ºæ¨æ¸¬ã®ç›®çš„ã®ä¸€ã¤ã¨ãªã‚Šã¾ã™ï¼

::: {.callout-note}
# ãƒ™ã‚¤ã‚ºãƒ«ãƒ¼ãƒ«

$$
p(\theta\vert y)
    = \frac{p(y\vert \theta)p(\theta)}{\int_{\Theta}p(y\vert\tilde\theta)p(\tilde\theta)\,\mathrm{d}\tilde\theta}
$$

ä¸Šã«åŸºã¥ã„ã¦ï¼Œè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã¨äº‹å‰åˆ†å¸ƒã‹ã‚‰äº‹å¾Œåˆ†å¸ƒã‚’æ›´æ–°ã—ã¾ã™ãŒï¼Œãƒ™ã‚¤ã‚ºãƒ«ãƒ¼ãƒ«ãŒç¤ºã—ã¦ã„ã‚‹ã®ã¯
äº‹å¾Œåˆ†å¸ƒãŒã©ã†ã‚ã‚‹ã¹ãã§ã¯ãªãã¦ï¼Œæ–°ãŸãªæƒ…å ±ã‚’å¾—ãŸã¨ãã«äº‹å¾Œåˆ†å¸ƒãŒã©ã†å¤‰åŒ–ã™ã‚‹ã‹ï¼Ÿã§ã™ï¼

:::

### ãƒ™ã‚¤ã‚ºæ³•ã«ã‚ˆã‚‹æ¨å®š

ç¢ºç‡å¤‰æ•° $\pmb X \sim D(\pmb\theta)$ ã«ã¤ã„ã¦ï¼Œç¢ºç‡åˆ†å¸ƒ $D$ ã‚’ç‰¹å¾´ã¥ã‘ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ $\pmb\theta$
ã‚’æ¨å®šã—ãŸã„ã¨ã—ã¾ã™ï¼ãƒ™ã‚¤ã‚ºæ¨æ¸¬ã§ã¯ï¼ŒåŒæ™‚ç¢ºç‡ï¼ˆå¯†åº¦ï¼‰é–¢æ•° $f(\pmb x\vert \pmb \theta)$ ã«ãŠã„ã¦
$\pmb \theta$ ã‚’ç¢ºç‡å¤‰æ•°ã¨ã¿ãªã—ã¦ç¢ºç‡åˆ†å¸ƒã‚’ä»®å®šã—ã¾ã™ï¼

ã“ã® $\pmb \theta$ ã«ã¤ã„ã¦ä»®å®šã•ã‚ŒãŸåˆ†å¸ƒã®ã“ã¨ã‚’ $\pmb \theta$ ã«ã¤ã„ã¦ã®äº‹å‰åˆ†å¸ƒã¨ã„ã„ï¼Œ

$$
\pi(\pmb \theta\vert \pmb\xi)
$$

ã¨è¡¨ã—ãŸã‚Šã—ã¾ã™ï¼$\pmb\xi$ ã¯äº‹å‰åˆ†å¸ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§hyper-parameter(è¶…æ¯æ•°)ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã™ï¼
ã“ã“ã¾ã§ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ•´ç†ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

$$
\begin{align*}
\left\{\begin{array}{c}
\pmb X\vert \pmb\theta & \sim f(\pmb x\vert \pmb\theta)\\
\pmb\theta & \sim \pi(\pmb \theta\vert \pmb\xi)
\end{array}\right.
\end{align*}
$$

ã“ã®ã¨ãï¼Œ$\pmb X = \pmb x$ ã‚’ä¸ãˆãŸã¨ãã® $\pmb\theta$ ã®äº‹å¾Œåˆ†å¸ƒã¯ï¼Œ$f_\pi(\pmb x\vert\pmb\xi)$ ã‚’
$\pmb X$ ã®å‘¨è¾ºåˆ†å¸ƒã¨ã™ã‚‹ã¨

$$
\begin{gather}
f_\pi(\pmb x\vert\pmb\xi) = \int f(\pmb x\vert \pmb\theta)\pi(\pmb\theta\vert\xi)\,\mathrm{d}\theta\\
\pi(\pmb\theta\vert \pmb x, \pmb \xi) = \frac{f(\pmb x\vert \pmb\theta)\pi(\pmb \theta\vert \pmb\xi)}{f_\pi(\pmb x\vert\pmb\xi)}
\end{gather}
$$

ã“ã®äº‹å¾Œåˆ†å¸ƒ $\pi(\pmb\theta\vert \pmb x, \pmb \xi)$ ã‹ã‚‰æ¨å®šé‡ã‚’å°ãã®ãŒãƒ™ã‚¤ã‚ºæ³•ã§ã™ï¼äº‹å¾Œåˆ†å¸ƒã®ãƒ¢ãƒ¼ãƒ‰ã‚’
Bayesian maximum likelihood estimatorã¨å‘¼ã‚“ã ã‚Šã—ã¾ã™ï¼

<strong > &#9654;&nbsp; ååˆ†çµ±è¨ˆé‡ã¨ãƒ™ã‚¤ã‚ºæ³•</strong>

$\pmb\theta$ ã«å¯¾ã™ã‚‹ååˆ†çµ±è¨ˆé‡ã‚’ $T(\pmb X)$ ã¨ã™ã‚‹ã¨ï¼Œ$\pmb X$ ã®æ¡ä»¶ä»˜ãç¢ºç‡å¯†åº¦é–¢æ•°ã¯

$$
\begin{align*}
f(\pmb x\vert\pmb\theta) &= h(\pmb x) g(T(\pmb x)\vert\pmb\theta)\\
h(\pmb x) &= P(\pmb X = \pmb x\vert T(\pmb X))
\end{align*}
$$

ã¨ååˆ†çµ±è¨ˆé‡ã®å®šç¾©ã‚ˆã‚Šè¡¨ã›ã¾ã™ï¼ã“ã‚Œã‚’ç”¨ã„ã‚‹ã¨äº‹å¾Œåˆ†å¸ƒ $\pi(\pmb\theta\vert \pmb x, \pmb \xi)$ ã¯æ¬¡ã®ã‚ˆã†ã«æ•´ç†ã§ãã¾ã™:

$$
\begin{align*}
\pi(\pmb\theta\vert \pmb x, \pmb \xi)
    &= \frac{f(\pmb x\vert \pmb\theta) \pi(\pmb\theta \vert\pmb\xi)}{\int f(\pmb x\vert \pmb\theta)\pi(\pmb\theta\vert\xi)\,\mathrm{d}\theta}\\[5pt]
    &= \frac{h(\pmb x)g(T(\pmb x) \vert \pmb\theta)\pi(\pmb \theta\vert \pmb\xi)}{\int h(\pmb x)g(T(\pmb x) \vert \pmb\theta)\pi(\pmb\theta\vert\xi)\,\mathrm{d}\theta}\\[5pt]
    &= \frac{g(T(\pmb x) \vert \pmb\theta)\pi(\pmb \theta\vert \pmb\xi)}{\int g(T(\pmb x) \vert \pmb\theta)\pi(\pmb\theta\vert\xi)\,\mathrm{d}\theta}\\
\end{align*}
$$

::: {#exm- .custom_problem }
**: äº‹å‰åˆ†å¸ƒå¹³å‡ã¨æ¨™æœ¬å¹³å‡ã®åŠ é‡å¹³å‡**
<br>

ç¢ºç‡å¤‰æ•° $X\sim\operatorname{Binom}(n, \theta)$ ã¨ã—ï¼Œ$\theta$ ã«äº‹å‰åˆ†å¸ƒ $\operatorname{Beta}(\alpha, \beta)$ ã‚’ä»®å®šã—ã¾ã™ï¼
$x$ ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦è¦³æ¸¬ã—ãŸã¨ãï¼Œ$\theta$ ã®äº‹å¾Œåˆ†å¸ƒã¯ï¼Œ$x, \theta$ ã®åŒæ™‚åˆ†å¸ƒã«æ¯”ä¾‹ã™ã‚‹ã®ã§

$$
\begin{align*}
f(x\vert\theta)\pi(\theta\vert\alpha,\beta)
    &\propto \theta^x(1 - \theta)^{n-x}\theta^{\alpha-1}(1 - \theta)^{\beta-1}\\[5pt]
    &= \theta^{x+\alpha-1}(1 - \theta)^{n-x+\beta-1}
\end{align*}
$${#eq-bayesian-exm} 

å¾“ã£ã¦ï¼Œ$\theta$ ã®äº‹å¾Œåˆ†å¸ƒã¯

$$
\theta\vert\pmb x, \alpha,\beta \sim \operatorname{Beta}(x+\alpha, n-x+\beta)
$$

äº‹å¾Œåˆ†å¸ƒã®æœŸå¾…å€¤ã‚’ãƒ™ã‚¤ã‚ºæ¨å®šé‡ $\hat\theta$ ã¨ã™ã‚‹ã¨, $w = \alpha + \beta, \theta_0 = \frac{\alpha }{\alpha + \beta}$ ã¨ãŠãã“ã¨ã§

$$
\hat\theta = \frac{n}{w + n}\frac{X}{n} + \frac{w}{w + n}\theta_0
$$

ãƒ™ã‚¤ã‚ºæ›´æ–°å¾Œã® $\theta$ ã®æœŸå¾…å€¤ã¯äº‹å‰åˆ†å¸ƒã«ãŠã‘ã‚‹æœŸå¾…å€¤ã¨æ¨™æœ¬å¹³å‡ã®åŠ é‡å¹³å‡ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

::: {.nte- .callout-tip icon="false"}
# ğŸµ Green Tea Break

@eq-bayesian-exm ã§ ${}_nC_{x}$ (ä»¥ä¸‹ã§ã¯ $C(x)$ ã¨è¡¨è¨˜ã™ã‚‹) åŠã³ ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã®è¦æ ¼åŒ–å®šæ•°($\operatorname{B}$ ã¨è¡¨è¨˜ã™ã‚‹)ã¨ã„ã†é …ãŒæ¶ˆãˆã¦ã„ã¾ã™ãŒï¼Œæ¬¡ã®ã‚ˆã†ã«äº‹å¾Œåˆ†å¸ƒã®è¨ˆç®—ã«ã¯ä¸å¿…è¦ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™

$$
\begin{align*}
&\frac{C(x)\theta^x(1 - \theta)^{n-x}\operatorname{B}\theta^{\alpha-1}(1 - \theta)^{\beta-1}}{\int C(x)\theta^x(1 - \theta)^{n-x}\operatorname{B}\theta^{\alpha-1}(1 - \theta)^{\beta-1}\mathrm{d}\theta }\\
&=\frac{\theta^{x+\alpha-1}(1 - \theta)^{n-x+\beta-1}}{\int \theta^{x+\alpha-1}(1 - \theta)^{n-x+\beta-1}\mathrm{d}\theta }\\
\end{align*}
$$

çµå±€åˆ†å­ã¨åˆ†æ¯ã§æ‰“ã¡æ¶ˆã•ã‚Œã‚ã†ã®ã§è€ƒæ…®ã—ãªãã¦è‰¯ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ã¾ãŸæœ€å¾Œã®å¼ã¯ $\operatorname{Beta}(x+\alpha, n-x+\beta)$ ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼
ã“ã®ä¾‹ã§ã¯ï¼Œäº‹å‰åˆ†å¸ƒã¨äº‹å¾Œåˆ†å¸ƒãŒåŒã˜åˆ†å¸ƒæ—ã«å…¥ã£ã¦ã„ã¾ã™ï¼ã“ã®ã‚ˆã†ãªäº‹å‰åˆ†å¸ƒã‚’**å…±å½¹äº‹å‰åˆ†å¸ƒ(conjugate prioor distribution)**ã¨å‘¼ã³ã¾ã™ï¼


:::
:::

::: {#exm- .custom_problem }
**: æ­£è¦åˆ†å¸ƒã¨ãƒ™ã‚¤ã‚ºæ¨å®š**
<br>

$X_1, \cdots, X_n \overset{\mathrm{iid}}{\sim} N(\mu, \sigma)$, $\mu$ ã«ã¤ã„ã¦ã®äº‹å‰åˆ†å¸ƒã‚’ $N(\xi, \tau^2)$ ã¨ã™ã‚‹ï¼
ã“ã“ã§ã¯ $(\sigma, \xi, \tau^2)$ ã¯ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã™ã‚‹ï¼

$(x_1, \cdots, x_n)$ ã‚’è¦³æ¸¬ã—ãŸä¸‹ã§ã®, $\mu$ ã®äº‹å¾Œåˆ†å¸ƒ $\pi(\mu\vert \pmb x)$ ã¯

$$
\begin{align*}
\pi(\mu\vert \pmb x)
    &\propto \phi(\pmb x\vert \mu, \sigma^2)\pi(\mu\vert \xi, \tau^2)\\[5pt]
    &\propto \exp\left(-\frac{\sum (x_i -\mu)^2}{2\sigma^2}\right)\exp\left(-\frac{(\mu - \xi)^2}{2\tau^2}\right)
\end{align*}
$${#eq-base-loss}

ã“ã“ã§ï¼Œ$\overline{x}$ ã‚’æ¨™æœ¬å¹³å‡ã¨ã™ã‚‹ã¨

$$
\begin{align*}
\sum (x_i -\mu)^2 
    &= \sum (x_i -\overline{x} + \overline{x} - \mu)^2 \\
    &= \sum (x_i -\overline{x})^2 + 2 \underbrace{\sum x_i(x_i -\overline{x})}_{=0} + \sum (\overline{x} - \mu)^2\\
    &= \sum (x_i -\overline{x})^2 + n(\overline{x} - \mu)^2
\end{align*}
$$

å¾“ã£ã¦ï¼Œ@eq-base-loss ã¯æ¬¡ã®ã‚ˆã†ã«æ•´ç†ã§ãã¾ã™

$$
\begin{align*}
&\exp\left(-\frac{\sum (x_i -\mu)^2}{2\sigma^2}\right)\exp\left(-\frac{(\mu - \xi)^2}{2\tau^2}\right)\\
&=\exp\left\{-\frac{1}{2}\left(\frac{\sum (x_i - \overline{x})^2 + n(\overline{x} - \mu)^2}{\sigma^2} + \frac{\mu^2 - 2\xi\mu + \xi^2}{\tau^2}\right)\right\}\\
&\propto \exp\left\{-\frac{1}{2}\left(\frac{n\mu^2 - 2n\overline{x}\mu}{\sigma^2} + \frac{\mu^2 - 2\xi\mu}{\tau^2}\right)\right\}\\
&\propto \exp\left\{-\frac{1}{2}\left(\frac{n}{\sigma^2}{ + \frac{1}{\tau^2}}\right)\left(\mu - \frac{(n/\sigma^2)\overline{x} + (1/\tau^2)\xi}{n/\sigma^2 + 1/\tau^2}\right)^2\right\}
\end{align*}
$$

åˆ†å­åˆ†æ¯ã§ $\mu$ ã¨é–¢ä¿‚ã®ãªã„é …ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹ã®ã§

$$
\begin{align*}
\hat\mu_{B} &= \frac{(n/\sigma^2)\overline{x} + (1/\tau^2)\xi}{n/\sigma^2 + 1/\tau^2}
\end{align*}
$$

ã¨è¡¨è¨˜ã™ã‚‹ã¨

$$
\begin{align*}
\pi(\mu\vert \pmb x)
    &= \frac{\exp\left\{\frac{(\mu - \hat\mu_{B})^2}{2(n/\sigma^2 + 1/\tau^2)^{-1}}\right\}}{\int \exp\left\{\frac{(\mu - \hat\mu_{B})^2}{2(n/\sigma^2 + 1/\tau^2)^{-1}}\right\} \,\mathrm{d}\mu}\\
    &=\frac{1}{\sqrt{2\pi (n/\sigma^2 + 1/\tau^2)^{-1}}}\exp\left\{\frac{(\mu - \hat\mu_{B})^2}{2(n/\sigma^2 + 1/\tau^2)^{-1}}\right\}
\end{align*}
$$

å¾“ã£ã¦ï¼Œã“ã‚Œã¯ $N(\hat\mu_{B}, [n/\sigma^2 + 1/\tau^2]^{-1})$ ã®å¯†åº¦é–¢æ•°ã®å½¢ã‚’ã—ã¦ã„ã‚‹ã®ã§

$$
\mu\vert\pmb{X} \sim N(\hat\mu_{B}, [n/\sigma^2 + 1/\tau^2]^{-1})
$$

$$\tag*{\(\blacksquare\)}$$

:::
