---
title: "ã‚¸ãƒ‹ä¿‚æ•°"
author: "Ryo Nakagami"
date: "2024-09-06"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

## ã‚¸ãƒ‹ä¿‚æ•°ã¨ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·š

<div class="blog-custom-border">
<strong>Def: ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·š</strong> <br>

ãƒ‡ãƒ¼ã‚¿ $X = \{x_1, \cdots, x_n\}$ ã«ã¤ã„ã¦ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªé †åºçµ±è¨ˆé‡ã‚’ã¨ã‚‹

$$
x_{[1]} \leq \cdots \leq x_{[i]} \leq \cdots \leq x_{[n]}
$$

ã“ã®ã¨ãï¼Œç›¸å¯¾åº¦æ•° $r_i$ ã¨ç´¯ç©æ¯”ç‡ $I_i$ ã‚’ãã‚Œãã‚Œä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ï¼š

$$
\begin{align*}
r_i & = \frac{i}{n}\\
I_i &= \frac{\sum_{j=1}^i x_{[j]}}{\sum_{j=1}^n x_{[j]}}
\end{align*}
$$

ç‚¹ $(0,0), (r_1, I_1), \cdots , (r_n, I_n)$ ã‚’åŒºåˆ†çš„ã«ç›´ç·šã§çµã‚“ã§å¾—ã‚‰ã‚Œã‚‹æ›²ç·šãŒãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·šã§ã‚ã‚‹ï¼

</div>

Pythonã§å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ã‚¿ãƒ¼ 2.5 ã®ãƒ‘ãƒ¬ãƒ¼ãƒˆåˆ†å¸ƒã®ä¹±æ•°ã¨ $\operatorname{Unif}(0, 1)$ ã‚’20å€‹ãšã¤ç™ºç”Ÿã•ã›ä½œç”»ã—ãŸã®ãŒä»¥ä¸‹

```{python}
# | code-fold: true
import numpy as np
from scipy.stats import pareto
import polars as pl
import plotly.express as px

np.random.seed(42)

SAMPLESIZE = 20
shape_parameter = 1
x = pareto.rvs(shape_parameter, size=SAMPLESIZE)
x2 = np.random.uniform(0, 1, SAMPLESIZE)

# Compute ratio
relative_freq = np.arange(0, SAMPLESIZE + 1) / SAMPLESIZE
relative_cumulative_pareto = np.insert(np.cumsum(sorted(x)) / np.sum(x), 0, 0)
relative_cumulative_uniform = np.insert(np.cumsum(sorted(x2)) / np.sum(x2), 0, 0)

# create dataframe
df = pl.DataFrame(
    {
        "relative_freq": relative_freq,
        "pareto": relative_cumulative_pareto,
        "uniform": relative_cumulative_uniform,
    }
)


# compute gini
def compute_gini(relative_freq, relative_cumulative):
    a = relative_freq[1:-1] - relative_cumulative[1:-1]
    b = relative_freq[2:] - relative_freq[:-2]
    return np.sum(a * b)


# plot
pareto_gini = compute_gini(relative_freq, relative_cumulative_pareto)
uniform_gini = compute_gini(relative_freq, relative_cumulative_uniform)
fig = px.line(
    df,
    x="relative_freq",
    y=["pareto", "uniform"],
    color_discrete_sequence=["blue", "red"],
    markers="x",
    title="""pareto gini coefficient: {:.2f}, uniform gini coeffient:  {:.2f}""".format(
        pareto_gini, uniform_gini
    ),
)

fig.update_yaxes(
    scaleanchor="x",
    scaleratio=1,
)
BASE_SIZE = 600
fig.update_layout(
    autosize=True,
    width=BASE_SIZE,
    height=BASE_SIZE,
    shapes=[
        dict(
            type="line",
            line_dash="dot",
            yref="y",
            y0=0,
            y1=1,
            xref="x",
            x0=0,
            x1=1,
            line=dict(color="gray"),
            label=dict(text="å®Œå…¨å¹³ç­‰ç·š", textposition="middle center"),
        )
    ],
)

fig.show()
```

ä¸Šè¨˜ã®figureã«ãŠã‘ã‚‹45åº¦ç·šã¯**å®Œå…¨å¹³ç­‰ç·š**ã¨å‘¼ã°ã‚Œã‚‹ç·šã§ã™ï¼ã“ã®èµ¤ç·šã¨ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·šã§å›²ã¾ã‚ŒãŸã‚¨ãƒªã‚¢ã®é¢ç©ã®ï¼’å€ãŒã‚¸ãƒ‹ä¿‚æ•°ã«ç›¸å½“ã—ã¾ã™ï¼ã‚¸ãƒ‹ä¿‚æ•°ã¯èµ¤ç·šã¨é’ç·šã®ã‚¨ãƒªã‚¢ã‚’ä¸‰è§’å½¢ã¨å°å½¢ã«åˆ†ã‘ã¦ãã‚Œãã‚Œã‚’è¨ˆç®—ã—ï¼Œãã®åˆè¨ˆã®ï¼’å€ã§è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

<div class="blog-custom-border">
<strong>Def: ã‚¸ãƒ‹ä¿‚æ•°</strong> <br>

- ã‚¸ãƒ‹ä¿‚æ•°ã¯ãƒ‡ãƒ¼ã‚¿ã®åã‚Šã‚’ç¤ºã™æŒ‡æ¨™

<strong > &#9654;&nbsp; ç›¸å¯¾åº¦æ•°ã«åŸºã¥ãã‚¸ãƒ‹ä¿‚æ•°</strong>

$a_i$ ã‚’åº¦æ•°è¡¨ã«åŸºã¥ãç´¯ç©ç›¸å¯¾é »åº¦ï¼Œ $b_i$ ã‚’ç´¯ç©ç›¸å¯¾éšç´šå€¤ã¨ã—ãŸã¨ã

$$
\begin{align*}
\operatorname{Gini} = \sum_{i=1}^{k-1} (a_i - b_i)(a_{i+1} - a_{i-1}) \  \ \text{where } a_0 = 0, b_0 = 0
\end{align*}
$$

<strong > &#9654;&nbsp; ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã‚¸ãƒ‹ä¿‚æ•°</strong>

$$
\begin{align*}
\operatorname{Gini} 
    &= \frac{2}{n}\sum_{n-1}^{i=1}\left(\frac{i}{n} - \frac{\sum_{j=1}^i x_{[j]}}{n\overline{x}}\right) \\
    &= \frac{1}{2n^2\overline{x}}\sum_{i=1}^n\sum_{j=1}^n \vert x_i - x_j\vert
\end{align*}
$$


</div>
<br>
ä¸Šè¨˜ã®ã‚ˆã†ã«sampleã‚¸ãƒ‹ä¿‚æ•°ã¯å°å½¢ã®é¢ç©ã®ï¼’å€ã§è¨ˆç®—ã—ã¾ã™ãŒï¼Œæ¯é›†å›£ã‚¸ãƒ‹ä¿‚æ•°ã¨æ¯”è¼ƒã—ã¦å°ã•ã‚ã«è¨ˆç®—ã•ã‚Œã¾ã™ï¼
ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒååˆ†å¤§ãã„å ´åˆã¯ç„¡è¦–ã§ãã‚‹ç¨‹åº¦ã§ã™ãŒï¼Œåº¦æ•°åˆ†å¸ƒè¡¨ã«åŸºã¥ãè¨ˆç®—ã®å ´åˆã‚„small sampleã®å ´åˆã¯
éå°æ–¹å‘ãƒã‚¤ã‚¢ã‚¹ã®ä¿®æ­£ãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼

ã¾ãŸï¼Œã‚¸ãƒ‹ä¿‚æ•°ã®å°å‡ºå¼ã‚ˆã‚Šï¼ŒMAD(Mean absolute difference)ã¨ sample meanã®ç›¸å¯¾æ¯”ã«ã‚¸ãƒ‹ä¿‚æ•°ãŒæ¯”ä¾‹ã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

$$
\begin{align*}
\operatorname{Gini} &= \frac{1}{2n^2\overline{x}}\sum_{i=1}^n\sum_{j=1}^n \vert x_i - x_j\vert\\
                    &= \frac{1}{2}\frac{\sum_{i=1}^n\sum_{j=1}^n \vert x_i - x_j\vert}{n^2}\frac{1}{\overline x}\\
                    &\propto \frac{\operatorname{MAD}}{\operatorname{sample mean}}
\end{align*}
$$

<strong > &#9654;&nbsp; ã‚¸ãƒ‹ä¿‚æ•°ã®ç‰¹å¾´</strong>

- ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·šï¼Œã‚¸ãƒ‹ä¿‚æ•°ã¨ã‚‚ã«åˆ†å¸ƒã®å°ºåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«ä¾å­˜ã—ãªã„
- 1ç‚¹ã«é›†ä¸­ã™ã‚‹åˆ†å¸ƒã®å ´åˆï¼Œãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·šã¯å®Œå…¨å¹³ç­‰ç·šã¨ä¸€è‡´ã—ï¼Œã‚¸ãƒ‹ä¿‚æ•°ã¯0ã¨ãªã‚‹
- ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ç•°ãªã‚Šï¼Œä¸€æ§˜åˆ†å¸ƒã®å ´åˆã«ã‚¸ãƒ‹ä¿‚æ•°ãŒæœ€å¤§ã‚’ã¨ã‚‹ã¨ã‹ã§ã¯ãªã„


<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

- ãƒ‡ãƒ¼ã‚¿ã®åã‚Šã‚„é›†ä¸­æ€§ã‚’è¦‹ã‚‹æŒ‡æ¨™ã¨ã—ã¦ã‚¸ãƒ‹ä¿‚æ•°ã¯ä½¿ç”¨ã•ã‚Œã¾ã™ãŒï¼Œä»–ã«ã‚‚ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ã„ã†æŒ‡æ¨™ãŒã‚ã‚‹

ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã«åˆ†é¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«ãŠã„ã¦ï¼Œå„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®ç·ä½“é »åº¦ã‚’ $\hat p_i = f_i/n$ ã¨ã—ãŸã¨ã

$$
\begin{align*}
H(\mathbf p) = -\sum \hat p_i \log(\hat p_i)
\end{align*}
$$

HãŒå¤§ãã„ã»ã©ãƒ‡ãƒ¼ã‚¿ã¯ä¸€æ§˜ã«ãªã‚Šï¼Œé›†ä¸­æ€§ãŒã‚ã‚‹ã»ã©æŒ‡æ¨™ã¯å°ã•ããªã‚‹ï¼

</div>

### ç„¡é™æ¯é›†å›£ã«ãŠã‘ã‚‹ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·š

å®šç¾©åŸŸ $(0, \infty)$, æœŸå¾…å€¤ $\mu$ ã‚’æŒã¤é€£ç¶šç¢ºç‡å¤‰æ•° $X$ ã«ã¤ã„ã¦ï¼Œç´¯ç©åˆ†å¸ƒé–¢æ•°ã‚’ $F(x)$, ç¢ºç‡å¯†åº¦é–¢æ•° $f(x)$ ã¨ãŠãã¾ã™ï¼ã“ã®ã¨ãï¼Œ$z = F(x)$ ã¨ã—ãŸã¨ãã®ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æ›²ç·šã¯

$$
\begin{align*}
&F^{-1}(z) = x \  \ \text{ (inverse function of cdf)}\\
&L(z) =\frac{\int_0^{F^{-1}(z)} t f(t) \mathrm{d}t}{\mathbb E[X]}
\end{align*}
$$

ã¨ã—ã¦, $(z, L(z))$ ã§ä½œã‚‰ã‚Œã‚‹æ›²ç·šã¨ãªã‚Šã¾ã™ï¼ã‚¸ãƒ‹ä¿‚æ•°ã¯

$$
\begin{align*}
\operatorname{gini} &= 2\int_0^1 (u - L(u))\mathrm{d}u\\
                    &= 1 - 2\int_0^1 L(u)\mathrm{d}u
\end{align*}
$$