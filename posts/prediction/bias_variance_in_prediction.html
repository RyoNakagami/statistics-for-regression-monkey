<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja_JP.UTF-8" xml:lang="ja_JP.UTF-8"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ryo Nakagami">
<meta name="dcterms.date" content="2024-10-09">

<title>30&nbsp; Bias and Variance – Statistics for Regression Monkeys</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../posts/mathematical_appendix/taylor_series.html" rel="next">
<link href="../../posts/prediction/chapter_header.html" rel="prev">
<link href="../.././img/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QEFX7FVCDM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QEFX7FVCDM', { 'anonymize_ip': true});
</script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-M27Z2BWG');</script>
<!-- End Google Tag Manager -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&amp;display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/prediction/chapter_header.html">Prediction</a></li><li class="breadcrumb-item"><a href="../../posts/prediction/bias_variance_in_prediction.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bias and Variance</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Statistics for Regression Monkeys</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="Blog Series" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Blog Series"><i class="bi bi-book"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://ryonakagami.github.io/">
            Ryo's Tech Blog
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://ryonakagami.github.io/cmdstan_for_regression_monkey/">
            cmdstanpy for regmonkey
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://ryonakagami.github.io/statistics_dojo/">
            statistics dojo
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://ohgoshgit.github.io/">
            OhGoshGit!?!
            </a>
          </li>
      </ul>
    </div>
    <a href="https://github.com/RyoNakagami/statistics-for-regression-monkey" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/statistics101/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">統計学入門</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/averages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">代表値</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">相関関係</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/infographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">インフォグラフィックス</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/random_variable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">確率変数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">期待値</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/moment_generating_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">母関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/order_statistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">順序統計量</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistics101/delta-method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">デルタ法</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/probability_distribution/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">確率分布</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/discrete_uniform_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">離散一様分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/binomial_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">二項分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/poisson_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ポワソン分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/geometric_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">幾何分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/negative_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">負の二項分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/hypergeometric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">超幾何分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/continuous_uniform_dis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">連続一様分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/normal_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">正規分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/exponential_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">指数分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/gamma_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">ガンマ分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/chi_squared_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">カイ２乗分布</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/probability_distribution/student_t_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">t分布</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/statistical_hypothesis_test_101/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">統計的仮説検定</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistical_hypothesis_test_101/fisher_exact_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Fisher’s exact test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistical_hypothesis_test_101/ks_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">KS検定</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/statistical_hypothesis_test_201/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">統計的仮説検定の実践</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/statistical_hypothesis_test_201/fisher_vs_neyman_pearson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Fisher流検定 vs Neyman-Pearson流検定</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/estimation/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">統計的推定</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/estimation/unbiased_estimator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">不偏推定量</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/estimation/method-of-moments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">モーメント法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/estimation/m-estimator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">M-Estimator</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/bayesian_estimation/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ベイズ推定</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/bayesian_estimation/bayesian_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">ベイジアン線形回帰</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/survey_sampling/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">標本調査法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/survey_sampling/simple_sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">無作為抽出法</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ExplanatoryDataAnalysis/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explanatory Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ExplanatoryDataAnalysis/gini_coefficient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">ジニ係数</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Data Analysis and Outliers</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Econometrics Topics</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/prediction/chapter_header.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prediction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/prediction/bias_variance_in_prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bias and Variance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/taylor_series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">テイラー展開</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/permutation_combination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">二項級数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/complex_number.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">複素数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/beta_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">ベータ関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/gamma_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">ガンマ関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/jensen_inequality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Jensen’s Inequality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/mathematical_appendix/Lhopitals_rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">ロピタルの定理</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bias-and-variance-in-prediction" id="toc-bias-and-variance-in-prediction" class="nav-link active" data-scroll-target="#bias-and-variance-in-prediction">Bias and Variance in Prediction</a></li>
  <li><a href="#decomposition-of-expected-test-error" id="toc-decomposition-of-expected-test-error" class="nav-link" data-scroll-target="#decomposition-of-expected-test-error">Decomposition of Expected Test Error</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/RyoNakagami/statistics-for-regression-monkey/edit/main/posts/prediction/bias_variance_in_prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RyoNakagami/statistics-for-regression-monkey/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/prediction/chapter_header.html">Prediction</a></li><li class="breadcrumb-item"><a href="../../posts/prediction/bias_variance_in_prediction.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bias and Variance</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bias and Variance</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ryo Nakagami </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-10-09</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2024-10-19</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="bias-and-variance-in-prediction" class="level2">
<h2 class="anchored" data-anchor-id="bias-and-variance-in-prediction">Bias and Variance in Prediction</h2>
<p>未知のパラメーターの推定量に焦点を当てた統計的推定とことなり，教師あり機械学習の予測では <span class="math inline">\(x\)</span> が与えられたときに <span class="math inline">\(y\)</span> を良く予測できる関数 <span class="math inline">\(h\)</span></p>
<p><span class="math display">\[
\begin{align*}
&amp;y = h(x) + \epsilon\\
&amp;\text{where }  \mathbb E[\epsilon \vert x] = 0
\end{align*}
\]</span></p>
<p>を学習することを目指します．予測関数の<em>良さ</em>については決定理論(decision theory)で議論されるものですが，一旦L2距離で良さを判断する場合，良い関数は <span class="math inline">\(\mathbb E[y\vert x]\)</span> となります．この関数の学習を目指して，</p>
<p><span class="math display">\[
D = \{x^{(i)}, y^{(i)}\}_{i=1}^n
\]</span></p>
<p>をtraining datasetとして，<span class="math inline">\(\hat f_D\)</span> という関数を構築したとします．母集団からランダムサンプリング された <span class="math inline">\(S\)</span> にはノイズ <span class="math inline">\(\epsilon_i\)</span> が含まれており，<span class="math inline">\(S\)</span> を用いて学習した <span class="math inline">\(\hat f_D\)</span> は確率的に変動する側面があります．その上で同じ母集団からi.i.dでサンプリングされた未知のデータセット <span class="math inline">\(\{x^{*}, y^{*}\}\)</span> においても <span class="math inline">\(x\)</span> を特徴量として用いることで 精度良く <span class="math inline">\(y\)</span> を予測することができること = 汎化誤差(generalization error)が小さい <span class="math inline">\(\hat f_D\)</span> が望ましい予測関数となります．</p>
<p>汎化誤差を <span class="math inline">\(y\)</span> と <span class="math inline">\(\hat f_D\)</span> のL2距離と考え，<span class="math inline">\(x^*\)</span> で条件づけた場合，</p>
<p><span id="eq-pred-bias-variance"><span class="math display">\[
\begin{align*}
&amp;\operatorname{MSE}(\hat f_D)\\[5pt]
    &amp;= \mathbb E_{D, y^*}[(y^* - \hat f_D(x^*))^2]\\[5pt]
    &amp;= \mathbb E_{D, y^*}[(h(x^*) + \epsilon - \hat f_D(x^*))^2]\\[5pt]
    &amp;= \mathbb E_{y^*}[\epsilon^2] + \mathbb E_D[(h(x^*) -\hat f_D(x^*))^2]\\[5pt]
    &amp;= \mathbb E_D[\epsilon^2] + \underbrace{\mathbb E_D[h(x^*) -\hat f_D(x^*)]^2}_{=\text{bias and constant}} + \operatorname{Var}(h(x^*) -\hat f_D(x^*))\\[5pt]
    &amp;= \underbrace{\operatorname{Var}(\epsilon)}_{\text{irreducible error}} + \text{Bias}(\hat f_D)^2 + \operatorname{Var}(\hat f_D)
\end{align*}
\tag{30.1}\]</span></span></p>
<p>上式の第３項のVarianceは予測関数 <span class="math inline">\(f\)</span> の特定のtraing data集合 <span class="math inline">\(D\)</span> の選び方に関する敏感さを表していると解釈されます．</p>
<p><strong> ▶&nbsp; regession with gauss basis function</strong></p>
<p>上記の議論を踏まえると，Bias, Varianceをバランス良く小さくするモデルがMSEの意味で良い予測モデルということになります．</p>
<p>経験則的に，柔軟性のある複雑なモデルはBiasは小さいがVarianceが大きく，逆に柔軟性の低いモデルはBiasが大きいがVarianceが小さいことが知られています．</p>
<p>以下の例では，</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp;= \sin(2\pi x_i) + \epsilon_i\\
\epsilon_i &amp;\overset{\mathrm{iid}}{\sim}   N(0, 0.5^2)\\
x_i &amp;\overset{\mathrm{iid}}{\sim} \operatorname{Uniform}(0, 1)
\end{align*}
\]</span></p>
<p>というData Generating Processのもとで <span class="math inline">\(N_{train} = 25\)</span> からなるsampleを生成し，そのsample生成を100回繰り返す処理を考えます．つまり，</p>
<ul>
<li>それぞれのsample sizeは <span class="math inline">\(N_{train} = 25\)</span></li>
<li>sample数は <span class="math inline">\(L = 100\)</span></li>
</ul>
<p>ということです．24個のガウス基底を基底関数と用いたRidge Linear Regressionをそれぞれのsampleに対して実行し，その結果得られた各予測モデル(100個の予測モデル)の予測結果についてPythonで確認してみました．</p>
<p>なお，Ridge penaltyは <span class="math inline">\([0.1, 1.5, 15]\)</span> と恣意的に設定しています．なおTest datasetのsample sizeは <span class="math inline">\(N_{test} = 1000\)</span> としています</p>
<div id="feada15c" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> regmonkey_style.stylewizard <span class="im">as</span> sw</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sw.set_templates(<span class="st">"regmonkey_line"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">## create data function</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> true_func(x):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> x)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_data(func, sample_size, std, domain<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>]):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.random.uniform(domain[<span class="dv">0</span>], domain[<span class="dv">1</span>], sample_size)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> func(x) <span class="op">+</span> np.random.normal(scale<span class="op">=</span>std, size<span class="op">=</span>x.shape)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, t</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_gauss_basis(x, gauss_mean, gauss_var):</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x.ndim <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x[:, <span class="va">None</span>]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> x.ndim <span class="op">==</span> <span class="dv">2</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    basis <span class="op">=</span> [np.ones(<span class="bu">len</span>(x))]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> m <span class="kw">in</span> gauss_mean:</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        gauss_transfomred <span class="op">=</span> np.exp(<span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> np.square(x <span class="op">-</span> m) <span class="op">/</span> gauss_var)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        basis.append(gauss_transfomred.flatten())</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.asarray(basis).transpose()</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">## Generate Data</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1212</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>gauss_basis_mean <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi <span class="op">/</span> <span class="dv">2</span>, <span class="dv">24</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>gauss_basis_var <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>penalty_list <span class="op">=</span> [<span class="dv">15</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span>]</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>X_model_test <span class="op">=</span> create_gauss_basis(x_test, gauss_basis_mean, gauss_basis_var)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> true_func(x_test)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>x_train, y_train <span class="op">=</span> generate_data(true_func, <span class="dv">25</span> <span class="op">*</span> <span class="dv">100</span>, <span class="fl">0.5</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>x_train, y_train <span class="op">=</span> x_train.reshape(<span class="dv">100</span>, <span class="dv">25</span>), y_train.reshape(<span class="dv">100</span>, <span class="dv">25</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> penalty <span class="kw">in</span> penalty_list:</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    y_list <span class="op">=</span> []</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">3</span>))</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        X_model_train <span class="op">=</span> create_gauss_basis(</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            x_train[i, :], gauss_basis_mean, gauss_basis_var</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        clf <span class="op">=</span> Ridge(alpha<span class="op">=</span>penalty)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        clf.fit(X_model_train, y_train[i, :])</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> clf.predict(X_model_test)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        y_list.append(y_pred)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> y <span class="kw">in</span> y_list[:<span class="dv">10</span>]:</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].plot(x_test, y, alpha<span class="op">=</span><span class="fl">0.8</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f"penalty: </span><span class="sc">{</span>penalty<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="ss">f"model regression with penalty: </span><span class="sc">{</span>penalty<span class="sc">:.1f}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        ax.set_ylim(<span class="op">-</span><span class="fl">1.9</span>, <span class="fl">1.9</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(x_test, y_test, label<span class="op">=</span><span class="st">"true"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        x_test, np.asarray(y_list).mean(axis<span class="op">=</span><span class="dv">0</span>), linestyle<span class="op">=</span><span class="st">"--"</span>, label<span class="op">=</span><span class="st">"pred-mean"</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].legend()</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias_variance_in_prediction_files/figure-html/cell-2-output-1.png" width="728" height="280" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias_variance_in_prediction_files/figure-html/cell-2-output-2.png" width="728" height="280" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias_variance_in_prediction_files/figure-html/cell-2-output-3.png" width="728" height="280" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Bias-Variance Decompositionをシミュレーション標本で計算する場合は <a href="#eq-pred-bias-variance" class="quarto-xref">Equation&nbsp;<span>30.1</span></a> をシミュレーション標本と対応させれば良いので</p>
<p><span class="math display">\[
\begin{align*}
\overline{f}(x) &amp;= \frac{1}{L}\sum_l^L\hat f^{(l)}(x)\\
\operatorname{Bias}^2 &amp;= \frac{1}{N_{test}}\sum_{n} \{\overline{f}(x_n) - h(x_n)\}^2\\
\operatorname{Variance} &amp;= \frac{1}{N_{test}}\sum_{n}\frac{1}{L}\sum_l\left\{\hat f^{(l)}(x_n) - \overline{f}(x_n)\right\}^2
\end{align*}
\]</span></p>
<p>この考えに基づいて ridge penalty に対するBias, Variance, MSEをそれぞれplotすると以下のようにトレードオフ関係が確認できます</p>
<div id="a0423c1a" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Computes the bias-variance decomposition for a given list of penalty values.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * @param penalty_list - A list of penalty values.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"> * @returns An array of bias and variance values corresponding to each penalty value.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> multiprocessing <span class="im">import</span> Pool</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>penalty_list <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="dv">8</span>, <span class="dv">500</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>bias_list <span class="op">=</span> []</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>variance_list <span class="op">=</span> []</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>h_test <span class="op">=</span> true_func(x_test)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>x_train, y_train <span class="op">=</span> generate_data(true_func, <span class="dv">25</span> <span class="op">*</span> <span class="dv">100</span>, <span class="fl">0.5</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>x_train, y_train <span class="op">=</span> x_train.reshape(<span class="dv">100</span>, <span class="dv">25</span>), y_train.reshape(<span class="dv">100</span>, <span class="dv">25</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_bias_variance(penalty):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    y_list <span class="op">=</span> []</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        X_model_train <span class="op">=</span> create_gauss_basis(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            x_train[i, :], gauss_basis_mean, gauss_basis_var</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        clf <span class="op">=</span> Ridge(alpha<span class="op">=</span>penalty)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        clf.fit(X_model_train, y_train[i, :])</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> clf.predict(X_model_test)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        y_list.append(y_pred)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    y_list <span class="op">=</span> np.asanyarray(y_list)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    bias_term <span class="op">=</span> np.mean((h_test <span class="op">-</span> np.mean(y_list, axis<span class="op">=</span><span class="dv">0</span>)) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    variance_term <span class="op">=</span> np.mean(np.mean((y_list <span class="op">-</span> np.mean(y_list, axis<span class="op">=</span><span class="dv">0</span>)) <span class="op">**</span> <span class="dv">2</span>, axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bias_term, variance_term</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Pool() <span class="im">as</span> pool:</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pool.<span class="bu">map</span>(compute_bias_variance, penalty_list)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>bias_list, variance_list <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>results)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot bias vs penalty</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>penalty_list, y<span class="op">=</span>bias_list, mode<span class="op">=</span><span class="st">"lines"</span>, name<span class="op">=</span><span class="st">"Bias"</span>))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>fig.add_trace(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    go.Scatter(x<span class="op">=</span>penalty_list, y<span class="op">=</span>variance_list, mode<span class="op">=</span><span class="st">"lines"</span>, name<span class="op">=</span><span class="st">"Variance"</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>fig.add_trace(</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    go.Scatter(</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>penalty_list,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>np.asarray(bias_list) <span class="op">+</span> np.asarray(variance_list),</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"Total"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Bias-Variance decomposition"</span>, xaxis_title<span class="op">=</span><span class="st">"Penalty"</span>, yaxis_title<span class="op">=</span><span class="st">"Value"</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="6bfd76e6-c068-4e75-91d7-32518de3516c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6bfd76e6-c068-4e75-91d7-32518de3516c")) {                    Plotly.newPlot(                        "6bfd76e6-c068-4e75-91d7-32518de3516c",                        [{"mode":"lines","name":"Bias","x":[0.1,0.11583166332665332,0.13166332665330663,0.1474949899799599,0.16332665330661322,0.17915831663326653,0.19498997995991985,0.21082164328657316,0.22665330661322647,0.24248496993987978,0.2583166332665331,0.2741482965931864,0.2899799599198397,0.305811623246493,0.32164328657314634,0.33747494989979965,0.35330661322645296,0.36913827655310627,0.3849699398797596,0.4008016032064129,0.4166332665330662,0.4324649298597195,0.4482965931863728,0.46412825651302614,0.47995991983967934,0.49579158316633265,0.511623246492986,0.5274549098196393,0.5432865731462926,0.5591182364729459,0.5749498997995992,0.5907815631262525,0.6066132264529058,0.6224448897795591,0.6382765531062125,0.6541082164328658,0.6699398797595191,0.6857715430861724,0.7016032064128257,0.717434869739479,0.7332665330661323,0.7490981963927856,0.7649298597194389,0.7807615230460923,0.7965931863727456,0.8124248496993989,0.8282565130260522,0.8440881763527055,0.8599198396793587,0.875751503006012,0.8915831663326653,0.9074148296593186,0.923246492985972,0.9390781563126253,0.9549098196392786,0.9707414829659319,0.9865731462925852,1.0024048096192386,1.018236472945892,1.0340681362725452,1.0498997995991985,1.0657314629258519,1.0815631262525052,1.0973947895791585,1.1132264529058118,1.129058116232465,1.1448897795591184,1.1607214428857717,1.176553106212425,1.1923847695390783,1.2082164328657317,1.224048096192385,1.2398797595190383,1.2557114228456916,1.271543086172345,1.2873747494989982,1.3032064128256515,1.3190380761523048,1.3348697394789582,1.3507014028056115,1.3665330661322648,1.382364729458918,1.3981963927855714,1.4140280561122247,1.429859719438878,1.4456913827655313,1.4615230460921846,1.477354709418838,1.4931863727454913,1.5090180360721446,1.5248496993987979,1.5406813627254512,1.5565130260521045,1.5723446893787578,1.5881763527054111,1.6040080160320644,1.6198396793587175,1.6356713426853708,1.6515030060120242,1.6673346693386775,1.6831663326653308,1.698997995991984,1.7148296593186374,1.7306613226452907,1.746492985971944,1.7623246492985973,1.7781563126252506,1.793987975951904,1.8098196392785573,1.8256513026052106,1.841482965931864,1.8573146292585172,1.8731462925851705,1.8889779559118238,1.9048096192384771,1.9206412825651304,1.9364729458917838,1.952304609218437,1.9681362725450904,1.9839679358717437,1.999799599198397,2.01563126252505,2.0314629258517036,2.0472945891783567,2.0631262525050102,2.0789579158316633,2.094789579158317,2.1106212424849704,2.1264529058116235,2.1422845691382766,2.15811623246493,2.173947895791583,2.1897795591182367,2.20561122244489,2.2214428857715434,2.2372745490981965,2.25310621242485,2.268937875751503,2.2847695390781566,2.3006012024048097,2.3164328657314632,2.3322645290581163,2.34809619238477,2.363927855711423,2.3797595190380765,2.3955911823647296,2.411422845691383,2.427254509018036,2.4430861723446897,2.458917835671343,2.4747494989979963,2.4905811623246494,2.506412825651303,2.522244488977956,2.5380761523046096,2.5539078156312627,2.569739478957916,2.5855711422845693,2.601402805611223,2.617234468937876,2.6330661322645295,2.6488977955911825,2.664729458917836,2.680561122244489,2.6963927855711427,2.712224448897796,2.7280561122244493,2.7438877755511024,2.759719438877756,2.775551102204409,2.7913827655310626,2.8072144288577157,2.823046092184369,2.8388777555110223,2.854709418837676,2.870541082164329,2.8863727454909824,2.9022044088176355,2.918036072144289,2.933867735470942,2.9496993987975957,2.9655310621242488,2.9813627254509023,2.9971943887775554,3.013026052104209,3.028857715430862,3.0446893787575156,3.0605210420841686,3.076352705410822,3.0921843687374753,3.108016032064129,3.123847695390782,3.139679358717435,3.1555110220440885,3.1713426853707416,3.187174348697395,3.203006012024048,3.2188376753507018,3.234669338677355,3.2505010020040084,3.2663326653306615,3.282164328657315,3.297995991983968,3.3138276553106216,3.3296593186372747,3.3454909819639282,3.3613226452905813,3.377154308617235,3.392985971943888,3.4088176352705415,3.4246492985971946,3.440480961923848,3.456312625250501,3.4721442885771547,3.487975951903808,3.5038076152304614,3.5196392785571144,3.535470941883768,3.551302605210421,3.5671342685370746,3.5829659318637277,3.5987975951903812,3.6146292585170343,3.630460921843688,3.646292585170341,3.6621242484969945,3.6779559118236476,3.693787575150301,3.709619238476954,3.7254509018036077,3.741282565130261,3.7571142284569143,3.7729458917835674,3.788777555110221,3.804609218436874,3.8204408817635276,3.8362725450901807,3.852104208416834,3.8679358717434873,3.883767535070141,3.899599198396794,3.9154308617234475,3.9312625250501005,3.947094188376754,3.962925851703407,3.9787575150300607,3.994589178356714,4.010420841683367,4.02625250501002,4.0420841683366735,4.057915831663327,4.073747494989981,4.089579158316633,4.105410821643287,4.12124248496994,4.137074148296593,4.1529058116232465,4.1687374749499,4.184569138276553,4.200400801603206,4.21623246492986,4.232064128256513,4.247895791583166,4.263727454909819,4.279559118236473,4.2953907815631265,4.311222444889779,4.327054108216433,4.342885771543086,4.35871743486974,4.374549098196392,4.390380761523046,4.406212424849699,4.422044088176353,4.437875751503006,4.453707414829659,4.469539078156313,4.485370741482966,4.501202404809619,4.517034068136272,4.532865731462926,4.5486973947895795,4.564529058116232,4.580360721442886,4.596192384769539,4.612024048096193,4.627855711422845,4.643687374749499,4.659519038076152,4.675350701402806,4.691182364729459,4.707014028056112,4.722845691382766,4.738677354709419,4.754509018036072,4.770340681362725,4.786172344689379,4.802004008016032,4.817835671342685,4.833667334669339,4.849498997995992,4.865330661322646,4.881162324649298,4.896993987975952,4.912825651302605,4.928657314629259,4.944488977955912,4.960320641282565,4.976152304609219,4.991983967935872,5.007815631262525,5.023647294589178,5.039478957915832,5.055310621242485,5.071142284569138,5.086973947895792,5.102805611222445,5.118637274549099,5.134468937875751,5.150300601202405,5.166132264529058,5.181963927855711,5.197795591182365,5.213627254509018,5.229458917835672,5.245290581162324,5.261122244488978,5.276953907815631,5.292785571142285,5.3086172344689375,5.324448897795591,5.340280561122245,5.356112224448898,5.371943887775551,5.387775551102204,5.403607214428858,5.419438877755511,5.435270541082164,5.4511022044088175,5.466933867735471,5.482765531062125,5.498597194388777,5.514428857715431,5.530260521042084,5.546092184368738,5.5619238476953905,5.577755511022044,5.593587174348698,5.609418837675351,5.625250501002004,5.641082164328657,5.656913827655311,5.672745490981964,5.688577154308617,5.7044088176352705,5.720240480961924,5.736072144288578,5.75190380761523,5.767735470941884,5.783567134268537,5.799398797595191,5.8152304609218435,5.831062124248497,5.8468937875751505,5.862725450901804,5.878557114228457,5.89438877755511,5.910220440881764,5.926052104208417,5.94188376753507,5.9577154308617235,5.973547094188377,5.989378757515031,6.005210420841683,6.021042084168337,6.03687374749499,6.052705410821644,6.0685370741482965,6.08436873747495,6.1002004008016035,6.116032064128257,6.13186372745491,6.147695390781563,6.163527054108217,6.179358717434869,6.195190380761523,6.2110220440881765,6.22685370741483,6.242685370741483,6.258517034068136,6.27434869739479,6.290180360721443,6.306012024048096,6.321843687374749,6.337675350701403,6.3535070140280565,6.369338677354709,6.385170340681363,6.401002004008016,6.41683366733467,6.432665330661322,6.448496993987976,6.4643286573146295,6.480160320641283,6.495991983967936,6.511823647294589,6.527655310621243,6.543486973947896,6.559318637274549,6.575150300601202,6.590981963927856,6.6068136272545095,6.622645290581162,6.638476953907816,6.654308617234469,6.670140280561123,6.685971943887775,6.701803607214429,6.7176352705410824,6.733466933867736,6.749298597194389,6.765130260521042,6.780961923847696,6.796793587174349,6.812625250501002,6.828456913827655,6.844288577154309,6.8601202404809625,6.875951903807615,6.891783567134269,6.907615230460922,6.923446893787576,6.939278557114228,6.955110220440882,6.970941883767535,6.986773547094189,7.002605210420842,7.018436873747495,7.034268537074149,7.050100200400802,7.065931863727455,7.081763527054108,7.097595190380762,7.1134268537074155,7.129258517034068,7.145090180360722,7.160921843687375,7.176753507014029,7.192585170340681,7.208416833667335,7.224248496993988,7.240080160320641,7.255911823647295,7.271743486973948,7.287575150300602,7.303406813627254,7.319238476953908,7.335070140280561,7.350901803607215,7.3667334669338675,7.382565130260521,7.398396793587175,7.414228456913828,7.430060120240481,7.445891783567134,7.461723446893788,7.477555110220441,7.493386773547094,7.509218436873748,7.525050100200401,7.540881763527055,7.556713426853707,7.572545090180361,7.588376753507014,7.604208416833668,7.6200400801603205,7.635871743486974,7.651703406813628,7.667535070140281,7.683366733466934,7.699198396793587,7.715030060120241,7.730861723446894,7.746693386773547,7.7625250501002006,7.778356713426854,7.794188376753508,7.81002004008016,7.825851703406814,7.841683366733467,7.857515030060121,7.8733466933867735,7.889178356713427,7.905010020040081,7.920841683366734,7.936673346693387,7.95250501002004,7.968336673346694,7.984168336673347,8.0],"y":[0.000935876380167805,0.0009738828856042443,0.0010126318021202927,0.0010520236985544838,0.0010920538188920735,0.0011327557974921433,0.0011741763617594595,0.0012163638379586413,0.0012593630854410226,0.001303213503746816,0.001347948517165411,0.0013935957541546444,0.001440177530513721,0.0014877114400112083,0.001536210955427504,0.0015856859942855656,0.0016361434301782403,0.001687587544286648,0.0017400204184948686,0.0017934422746508107,0.0018478517657258666,0.00190324622482159,0.0019596218776705716,0.0020169740237571663,0.0020752971905901945,0.002134585265070664,0.002194831605350001,0.0022560291360836696,0.002318170429554993,0.002381247774772442,0.0024452532363252633,0.0025101787045114466,0.0025760159380221214,0.002642756600271999,0.0027103922903010404,0.0027789145690336565,0.0028483149815643587,0.002918585076039632,0.002989716419621849,0.0030617006119499955,0.0031345292964517933,0.003208194169810633,0.003282686989847344,0.003357999582039822,0.0034341238448721096,0.0035110517541775475,0.0035887753666177637,0.003667286822419559,0.00374657834747493,0.003826642254895062,0.003907470946096654,0.003989056911488403,0.004071392730816149,0.0041544710732173635,0.004238284697028826,0.00432282644938541,0.004408089265642788,0.0044940661686525465,0.004580750267914226,0.004668134758625634,0.004756212920649831,0.004844978117414683,0.004934423794758763,0.0050245434797354495,0.005115330779385452,0.005206779379486574,0.0052988830432882566,0.00539163561023744,0.005485030994701187,0.0055790631846909305,0.00567372624059222,0.005769014293903466,0.005864921545986485,0.005961442266831231,0.006058570793836743,0.00615630153060982,0.006254628945782897,0.006353547571851996,0.006453052004035722,0.006553136899155818,0.006653796974539771,0.006755027006945744,0.006856821831510021,0.006959176340717026,0.007062085483391815,0.007165544263715056,0.007269547740260151,0.007374091025052436,0.007479169282650003,0.007584777729245973,0.0076909116317917135,0.007797566307140756,0.007904737121212922,0.008012419488178239,0.008120608869660277,0.008229300773958382,0.00833849075528844,0.00844817441304166,0.008558347391060941,0.008669005376934416,0.00878014410130568,0.008891759337200263,0.009003846899367946,0.009116402643640473,0.009229422466304196,0.009342902303487324,0.009456838130561305,0.009571225961555931,0.009686061848587866,0.009801341881302104,0.009917062186326066,0.010033218926735971,0.010149808301535071,0.01026682654514347,0.010384269926899191,0.010502134750570121,0.010620417353876588,0.010739114108024195,0.010858221417246681,0.010977735718358491,0.011097653480316785,0.011217971203792584,0.011338685420750894,0.011459792694039402,0.011581289616985672,0.011703172813002436,0.0118254389352009,0.011948084666011759,0.012071106716813688,0.012194501827569187,0.012318266766467544,0.012442398329574616,0.01256689334048946,0.0126917486500074,0.012816961135789548,0.012942527702038426,0.01306844527917971,0.013194710823549784,0.013321321317089052,0.013448273767040754,0.013575565205655312,0.01370319268989984,0.01383115330117289,0.013959444145024157,0.014088062350879137,0.014217005071768464,0.014346269484061971,0.014475852787207245,0.01460575220347264,0.014735964977694511,0.014866488377028792,0.014997319690706548,0.015128456229793617,0.015259895326954123,0.015391634336217855,0.015523670632751297,0.015656001612632385,0.01578862469262875,0.015921537309979503,0.016054736922180353,0.016188221006772096,0.01632198706113233,0.01645603260227034,0.01659035516662505,0.0167249523098661,0.016859821606697814,0.016994960650666087,0.017130367053968115,0.01726603844726494,0.01740197247949663,0.017538166817700252,0.017674619146830273,0.017811327169581753,0.017948288606215758,0.018085501194387503,0.018222962688976666,0.0183606708619202,0.018498623502047364,0.01863681841491708,0.018775253422657432,0.018913926363807412,0.01905283509316071,0.019191977481611666,0.019331351416003235,0.01947095479897695,0.01961078554882485,0.019750841599343403,0.019891120899689245,0.020031621414236814,0.020172341122437813,0.020313278018682483,0.020454430112162567,0.02059579542673612,0.020737372000793904,0.020879157887127492,0.021021151152799056,0.021163349879012666,0.02130575216098729,0.0214483561078312,0.0215911598424181,0.021734161501264525,0.021877359234408922,0.022020751205292056,0.022164335590638868,0.022308110580341777,0.022452074377345293,0.02259622519753205,0.02274056126961014,0.022885080835001743,0.023029782147733085,0.023174663474325646,0.023319723093688634,0.02346495929701262,0.023610370387664538,0.023755954681083644,0.023901710504678913,0.024047636197727366,0.024193730111273674,0.024339990608030774,0.02448641606228173,0.02463300485978251,0.024779755397665974,0.02492666608434682,0.025073735339427628,0.02522096159360588,0.025368343288582035,0.025515878876968524,0.025663566822199817,0.025811405598443367,0.025959393690511548,0.026107529593774534,0.02625581181407405,0.026404238867638107,0.026552809280996566,0.026701521590897618,0.026850374344225124,0.02699936609791684,0.027148495418883464,0.027297760883928462,0.02744716107966888,0.027596694602456763,0.027746360058301583,0.027896156062793238,0.028046081241026057,0.028196134227523362,0.02834631366616297,0.02849661821010332,0.028647046521710393,0.028797597272485338,0.028948269142992884,0.02909906082279033,0.02924997101035735,0.02940099841302648,0.029552141746914243,0.029703399736852928,0.02985477111632315,0.030006254627386937,0.030157849020621533,0.030309553055053826,0.030461365498095427,0.030613285125478347,0.030765310721191284,0.030917441077416556,0.031069674994467635,0.031222011280727217,0.03137444875258594,0.03152698623438162,0.031679622558339206,0.03183235656451105,0.03198518710071799,0.03213811302249081,0.03229113319301238,0.032444246483060164,0.03259745177094944,0.03275074794247694,0.03290413389086505,0.03305760851670649,0.033211170727909564,0.03336481943964377,0.033518553574286146,0.03367237206136788,0.03382627383752149,0.03398025784642851,0.034134323038767615,0.03428846837216323,0.03444269281113458,0.03459699532704518,0.03475137489805292,0.03490583050906034,0.0350603611516656,0.0352149658241137,0.0353696435312483,0.0355243932844638,0.03567921410165795,0.035834105007184834,0.035989065031808334,0.03614409321265588,0.036299188593172715,0.03645435022307651,0.03660957715831237,0.03676486846100828,0.036920223199430856,0.03707564044794157,0.03723111928695328,0.03738665880288714,0.03754225808812998,0.037697916240991856,0.037853632365664226,0.03800940557217824,0.03816523497636346,0.03832111969980707,0.03847705886981323,0.038633051619362875,0.03878909708707386,0.038945194417161405,0.039101342759398944,0.03925754126907917,0.039413789106975516,0.03957008543930396,0.0397264294376851,0.039882820279106564,0.04003925714588566,0.04019573922563259,0.04035226571121358,0.040508835800714654,0.040665448697405536,0.04082210360970389,0.04097879975113983,0.041135536340320814,0.04129231260089664,0.04144912776152499,0.041605981055836995,0.04176287172240321,0.04191979900469989,0.04207676215107552,0.04223376041471753,0.04239079305361935,0.042547859330547805,0.042704958513010594,0.042862089873224235,0.04301925268808208,0.043176446239122646,0.0433336698124984,0.04349092269894439,0.04364820419374747,0.043805513596715674,0.043962850212147776,0.04412021334880311,0.044277602319871656,0.044435016442944376,0.04459245503998374,0.044749917437294555,0.044907402965494884,0.045064910959487336,0.04522244075843055,0.045379991705710825,0.04553756314891408,0.04569515443979793,0.04585276493426409,0.04601039399233084,0.04616804097810592,0.046325705259759375,0.046483386209496894,0.04664108320353306,0.04679879562206504,0.0469565228492464,0.047114264273161066,0.047272019285797544,0.04742978728302332,0.047587567664559495,0.04774535983395556,0.04790316319856436,0.04806097716951729,0.04821880116169964,0.04837663459372622,0.04853447688791701,0.0486923274702731,0.04885018577045284,0.049008051221748075,0.049165923261060646,0.04932380132887898,0.04948168486925496,0.049639573329780855,0.04979746616156654,0.049955362819216816,0.05011326276080885,0.05027116544786992,0.0504290703453552,0.0505869769216258,0.050744884648426906,0.05090279300086608,0.051060701457391784,0.05121860949977203,0.05137651661307315,0.05153442228563875,0.05169232600906887,0.05185022727819918,0.052008125591080485,0.052166020448958204,0.05232391135625216,0.0524817978205364,0.05263967935251924,0.052797555466023396,0.052955425677966315,0.0531132895083406,0.053271146480194626,0.053428996119613215,0.05358683795569858,0.05374467152055126,0.05390249634925131,0.05406031197983957,0.05421811795329907,0.054375913813536576,0.0545336991073643,0.054691473384481694,0.054849236197457366,0.05500698710171115,0.05516472565549641,0.0553224514198822,0.05548016395873586,0.055637862838705504,0.055795547629202746,0.055953217902385576,0.05611087323314118,0.056268513199069135,0.05642613738046454,0.05658374536030131,0.05674133672421559,0.056898911060489325,0.05705646796003392,0.05721400701637396,0.057371527825631145,0.05752902998650824,0.057686513100273236,0.05784397677074351,0.05800142060427016,0.05815884420972252,0.05831624719847258,0.058473629184379795,0.05863098978377568,0.05878832861544876,0.0589456453006296,0.059102939462975734,0.05926021072855698,0.0594174587258406,0.05957468308567682,0.05973188344128419,0.05988905942823519,0.060046210684441985,0.060203336850142106,0.06036043756788439,0.060517512482514926,0.06067456124116314,0.06083158349322794,0.060988578890364006,0.061145547086468084,0.0613024877376655,0.061459400502296674,0.06161628504090368,0.06177314101621709,0.06192996809314268,0.0620867659387484,0.06224353422225126,0.062400272615004526,0.06255698079048483,0.06271365842427937,0.06287030519407334,0.06302692077963724,0.06318350486281449,0.06334005712750894,0.06349657725967255,0.06365306494729317,0.06380951988038239,0.06396594175096336,0.06412233025305893,0.06427868508267955,0.06443500593781167,0.06459129251840567,0.06474754452636447,0.06490376166553165,0.06505994364168018,0.06521609016250071,0.06537220093759043,0.06552827567844154,0.06568431409843015,0.06584031591280515,0.06599628083867703,0.06615220859500688,0.06630809890259551,0.06646395148407257,0.06661976606388573,0.06677554236828989,0.06693128012533674,0.0670869790648639,0.0672426389184846,0.06739825941957714,0.06755384030327455,0.0677093813064543,0.06786488216772793,0.06802034262743101],"type":"scatter"},{"mode":"lines","name":"Variance","x":[0.1,0.11583166332665332,0.13166332665330663,0.1474949899799599,0.16332665330661322,0.17915831663326653,0.19498997995991985,0.21082164328657316,0.22665330661322647,0.24248496993987978,0.2583166332665331,0.2741482965931864,0.2899799599198397,0.305811623246493,0.32164328657314634,0.33747494989979965,0.35330661322645296,0.36913827655310627,0.3849699398797596,0.4008016032064129,0.4166332665330662,0.4324649298597195,0.4482965931863728,0.46412825651302614,0.47995991983967934,0.49579158316633265,0.511623246492986,0.5274549098196393,0.5432865731462926,0.5591182364729459,0.5749498997995992,0.5907815631262525,0.6066132264529058,0.6224448897795591,0.6382765531062125,0.6541082164328658,0.6699398797595191,0.6857715430861724,0.7016032064128257,0.717434869739479,0.7332665330661323,0.7490981963927856,0.7649298597194389,0.7807615230460923,0.7965931863727456,0.8124248496993989,0.8282565130260522,0.8440881763527055,0.8599198396793587,0.875751503006012,0.8915831663326653,0.9074148296593186,0.923246492985972,0.9390781563126253,0.9549098196392786,0.9707414829659319,0.9865731462925852,1.0024048096192386,1.018236472945892,1.0340681362725452,1.0498997995991985,1.0657314629258519,1.0815631262525052,1.0973947895791585,1.1132264529058118,1.129058116232465,1.1448897795591184,1.1607214428857717,1.176553106212425,1.1923847695390783,1.2082164328657317,1.224048096192385,1.2398797595190383,1.2557114228456916,1.271543086172345,1.2873747494989982,1.3032064128256515,1.3190380761523048,1.3348697394789582,1.3507014028056115,1.3665330661322648,1.382364729458918,1.3981963927855714,1.4140280561122247,1.429859719438878,1.4456913827655313,1.4615230460921846,1.477354709418838,1.4931863727454913,1.5090180360721446,1.5248496993987979,1.5406813627254512,1.5565130260521045,1.5723446893787578,1.5881763527054111,1.6040080160320644,1.6198396793587175,1.6356713426853708,1.6515030060120242,1.6673346693386775,1.6831663326653308,1.698997995991984,1.7148296593186374,1.7306613226452907,1.746492985971944,1.7623246492985973,1.7781563126252506,1.793987975951904,1.8098196392785573,1.8256513026052106,1.841482965931864,1.8573146292585172,1.8731462925851705,1.8889779559118238,1.9048096192384771,1.9206412825651304,1.9364729458917838,1.952304609218437,1.9681362725450904,1.9839679358717437,1.999799599198397,2.01563126252505,2.0314629258517036,2.0472945891783567,2.0631262525050102,2.0789579158316633,2.094789579158317,2.1106212424849704,2.1264529058116235,2.1422845691382766,2.15811623246493,2.173947895791583,2.1897795591182367,2.20561122244489,2.2214428857715434,2.2372745490981965,2.25310621242485,2.268937875751503,2.2847695390781566,2.3006012024048097,2.3164328657314632,2.3322645290581163,2.34809619238477,2.363927855711423,2.3797595190380765,2.3955911823647296,2.411422845691383,2.427254509018036,2.4430861723446897,2.458917835671343,2.4747494989979963,2.4905811623246494,2.506412825651303,2.522244488977956,2.5380761523046096,2.5539078156312627,2.569739478957916,2.5855711422845693,2.601402805611223,2.617234468937876,2.6330661322645295,2.6488977955911825,2.664729458917836,2.680561122244489,2.6963927855711427,2.712224448897796,2.7280561122244493,2.7438877755511024,2.759719438877756,2.775551102204409,2.7913827655310626,2.8072144288577157,2.823046092184369,2.8388777555110223,2.854709418837676,2.870541082164329,2.8863727454909824,2.9022044088176355,2.918036072144289,2.933867735470942,2.9496993987975957,2.9655310621242488,2.9813627254509023,2.9971943887775554,3.013026052104209,3.028857715430862,3.0446893787575156,3.0605210420841686,3.076352705410822,3.0921843687374753,3.108016032064129,3.123847695390782,3.139679358717435,3.1555110220440885,3.1713426853707416,3.187174348697395,3.203006012024048,3.2188376753507018,3.234669338677355,3.2505010020040084,3.2663326653306615,3.282164328657315,3.297995991983968,3.3138276553106216,3.3296593186372747,3.3454909819639282,3.3613226452905813,3.377154308617235,3.392985971943888,3.4088176352705415,3.4246492985971946,3.440480961923848,3.456312625250501,3.4721442885771547,3.487975951903808,3.5038076152304614,3.5196392785571144,3.535470941883768,3.551302605210421,3.5671342685370746,3.5829659318637277,3.5987975951903812,3.6146292585170343,3.630460921843688,3.646292585170341,3.6621242484969945,3.6779559118236476,3.693787575150301,3.709619238476954,3.7254509018036077,3.741282565130261,3.7571142284569143,3.7729458917835674,3.788777555110221,3.804609218436874,3.8204408817635276,3.8362725450901807,3.852104208416834,3.8679358717434873,3.883767535070141,3.899599198396794,3.9154308617234475,3.9312625250501005,3.947094188376754,3.962925851703407,3.9787575150300607,3.994589178356714,4.010420841683367,4.02625250501002,4.0420841683366735,4.057915831663327,4.073747494989981,4.089579158316633,4.105410821643287,4.12124248496994,4.137074148296593,4.1529058116232465,4.1687374749499,4.184569138276553,4.200400801603206,4.21623246492986,4.232064128256513,4.247895791583166,4.263727454909819,4.279559118236473,4.2953907815631265,4.311222444889779,4.327054108216433,4.342885771543086,4.35871743486974,4.374549098196392,4.390380761523046,4.406212424849699,4.422044088176353,4.437875751503006,4.453707414829659,4.469539078156313,4.485370741482966,4.501202404809619,4.517034068136272,4.532865731462926,4.5486973947895795,4.564529058116232,4.580360721442886,4.596192384769539,4.612024048096193,4.627855711422845,4.643687374749499,4.659519038076152,4.675350701402806,4.691182364729459,4.707014028056112,4.722845691382766,4.738677354709419,4.754509018036072,4.770340681362725,4.786172344689379,4.802004008016032,4.817835671342685,4.833667334669339,4.849498997995992,4.865330661322646,4.881162324649298,4.896993987975952,4.912825651302605,4.928657314629259,4.944488977955912,4.960320641282565,4.976152304609219,4.991983967935872,5.007815631262525,5.023647294589178,5.039478957915832,5.055310621242485,5.071142284569138,5.086973947895792,5.102805611222445,5.118637274549099,5.134468937875751,5.150300601202405,5.166132264529058,5.181963927855711,5.197795591182365,5.213627254509018,5.229458917835672,5.245290581162324,5.261122244488978,5.276953907815631,5.292785571142285,5.3086172344689375,5.324448897795591,5.340280561122245,5.356112224448898,5.371943887775551,5.387775551102204,5.403607214428858,5.419438877755511,5.435270541082164,5.4511022044088175,5.466933867735471,5.482765531062125,5.498597194388777,5.514428857715431,5.530260521042084,5.546092184368738,5.5619238476953905,5.577755511022044,5.593587174348698,5.609418837675351,5.625250501002004,5.641082164328657,5.656913827655311,5.672745490981964,5.688577154308617,5.7044088176352705,5.720240480961924,5.736072144288578,5.75190380761523,5.767735470941884,5.783567134268537,5.799398797595191,5.8152304609218435,5.831062124248497,5.8468937875751505,5.862725450901804,5.878557114228457,5.89438877755511,5.910220440881764,5.926052104208417,5.94188376753507,5.9577154308617235,5.973547094188377,5.989378757515031,6.005210420841683,6.021042084168337,6.03687374749499,6.052705410821644,6.0685370741482965,6.08436873747495,6.1002004008016035,6.116032064128257,6.13186372745491,6.147695390781563,6.163527054108217,6.179358717434869,6.195190380761523,6.2110220440881765,6.22685370741483,6.242685370741483,6.258517034068136,6.27434869739479,6.290180360721443,6.306012024048096,6.321843687374749,6.337675350701403,6.3535070140280565,6.369338677354709,6.385170340681363,6.401002004008016,6.41683366733467,6.432665330661322,6.448496993987976,6.4643286573146295,6.480160320641283,6.495991983967936,6.511823647294589,6.527655310621243,6.543486973947896,6.559318637274549,6.575150300601202,6.590981963927856,6.6068136272545095,6.622645290581162,6.638476953907816,6.654308617234469,6.670140280561123,6.685971943887775,6.701803607214429,6.7176352705410824,6.733466933867736,6.749298597194389,6.765130260521042,6.780961923847696,6.796793587174349,6.812625250501002,6.828456913827655,6.844288577154309,6.8601202404809625,6.875951903807615,6.891783567134269,6.907615230460922,6.923446893787576,6.939278557114228,6.955110220440882,6.970941883767535,6.986773547094189,7.002605210420842,7.018436873747495,7.034268537074149,7.050100200400802,7.065931863727455,7.081763527054108,7.097595190380762,7.1134268537074155,7.129258517034068,7.145090180360722,7.160921843687375,7.176753507014029,7.192585170340681,7.208416833667335,7.224248496993988,7.240080160320641,7.255911823647295,7.271743486973948,7.287575150300602,7.303406813627254,7.319238476953908,7.335070140280561,7.350901803607215,7.3667334669338675,7.382565130260521,7.398396793587175,7.414228456913828,7.430060120240481,7.445891783567134,7.461723446893788,7.477555110220441,7.493386773547094,7.509218436873748,7.525050100200401,7.540881763527055,7.556713426853707,7.572545090180361,7.588376753507014,7.604208416833668,7.6200400801603205,7.635871743486974,7.651703406813628,7.667535070140281,7.683366733466934,7.699198396793587,7.715030060120241,7.730861723446894,7.746693386773547,7.7625250501002006,7.778356713426854,7.794188376753508,7.81002004008016,7.825851703406814,7.841683366733467,7.857515030060121,7.8733466933867735,7.889178356713427,7.905010020040081,7.920841683366734,7.936673346693387,7.95250501002004,7.968336673346694,7.984168336673347,8.0],"y":[0.09816032876921114,0.09492945506417096,0.09216273699086355,0.08974749752767727,0.08760746446445761,0.08568864683746964,0.08395144076111438,0.08236594091183778,0.08090901560172988,0.07956240627494399,0.0783114495730284,0.07714419249818864,0.07605076405984476,0.07502291909942879,0.07405370061758396,0.07313718547772725,0.0722682899330049,0.07144261883712227,0.0706563472618657,0.06990612650170844,0.06918900867069246,0.0685023856430108,0.0678439391806236,0.06721159987367763,0.06660351308776535,0.06601801052993733,0.0654535863562201,0.06490887697709093,0.0643826438948166,0.06387375904256735,0.06338119220035747,0.06290400014480871,0.06244131725408807,0.06199234734027528,0.06155635652195431,0.06113266698231308,0.06072065148423265,0.060319728535090975,0.05992935811132736,0.059549037867008464,0.059178299762327025,0.05881670705763701,0.058463851626666966,0.05811935154926194,0.05778284894962589,0.05745400805076534,0.05713251341982731,0.056818068382407265,0.056510393586779145,0.0562092257014519,0.05591431623155598,0.05562543044136425,0.05534234637180143,0.05506485394313448,0.05479275413419291,0.05452585823047323,0.05426398713435418,0.054006970731411454,0.0537546473074853,0.05350686301173743,0.05326347136144481,0.053024332784727415,0.05278931419780365,0.052558288613716794,0.05233113477978514,0.05210773684130338,0.05188798402926582,0.05167177037009864,0.05145899441558172,0.05124955899131223,0.051043370962216325,0.05084034101375307,0.050640383447577854,0.05044341599054347,0.050249359616016995,0.05005813837657971,0.04986967924725853,0.04968391197851019,0.04950076895824546,0.04932018508224023,0.04914209763233427,0.04896644616186789,0.0487931723878505,0.048622220089396234,0.04845353501199833,0.048287064777247264,0.04812275879762872,0.04796056819606484,0.04780044572988833,0.04764234571896161,0.04748622397767525,0.047332037750579044,0.04717974565141721,0.04702930760535572,0.04688068479420477,0.04673383960445348,0.04658873557794667,0.04644533736504532,0.04630361068012327,0.04616352225926283,0.04602503982002095,0.045888132023146656,0.04575276843613787,0.04561891949853346,0.04548655648884282,0.04535565149302202,0.04522617737441087,0.04509810774505095,0.044971416938309944,0.04484607998274153,0.04472207257711534,0.0445993710665548,0.044477952419724846,0.04435779420701482,0.04423887457966536,0.044121172249790716,0.044004666471251196,0.04388933702133292,0.043775164183194465,0.04366212872904248,0.04355021190400034,0.04343939541063606,0.043329661394117536,0.04322099242796505,0.04311337150037231,0.04300678200106954,0.04290120770870264,0.04279663277870493,0.04269304173163812,0.04259041944198139,0.04248875112734797,0.042388022338109795,0.04228821894741203,0.04218932714156013,0.04209133341076263,0.04199422454021435,0.041897987601504996,0.04180260994433904,0.041708079188553515,0.041614383216420914,0.04152151016522519,0.04142944842009926,0.04133818660711302,0.04124771358660158,0.041158018446723614,0.04106909049724056,0.04098091926350745,0.04089349448066699,0.040806806088038584,0.04072084422369462,0.040635599219216285,0.04055106159462234,0.04046722205346348,0.040384071478076315,0.04030160092499038,0.0402198016204827,0.040138664956273835,0.0400581824853604,0.03997834591797864,0.03989914711769426,0.039820578097613794,0.03974263101671299,0.03966529817627787,0.03958857201645437,0.03951244511290256,0.03943691017355177,0.039361960035452795,0.039287587661723945,0.03921378613858736,0.039140548672492545,0.03906786858732409,0.038995739321690495,0.03892415442629134,0.03885310756136016,0.038782592494180305,0.03871260309667146,0.03864313334304416,0.038574177307520274,0.03850572916211709,0.03843778317449294,0.03837033370585219,0.038303375208907905,0.03823690222589994,0.03817090938666698,0.03810539140677051,0.038040343085669205,0.037975759304942104,0.0379116350265588,0.037847965291195565,0.037784745216595424,0.037721969995971355,0.03765963489645074,0.0375977352575602,0.03753626648974929,0.03747522407295199,0.03741460355518484,0.03735440055118042,0.037294610741055424,0.03723522986901193,0.037176253742071154,0.03711767822883855,0.03705949925829937,0.03700171281864372,0.0369443149561205,0.036887301773918975,0.03683066943107747,0.03677441414141836,0.03671853217250848,0.036663019844644276,0.03660787352986115,0.03655308965096596,0.036498664680592444,0.03644459514027846,0.03639087759956496,0.036337508675115544,0.036284485029856435,0.036231803372136114,0.03617946045490409,0.03612745307490842,0.036075778071911126,0.03602443232792156,0.03597341276644662,0.035922716351757915,0.03587234008817501,0.03582228101936453,0.03577253622765478,0.03572310283336512,0.03567397799415016,0.035625158904358085,0.035576642794402744,0.03552842693014935,0.03548050861231324,0.035432885175871495,0.0353855539894869,0.03533851245494421,0.035291758006598166,0.035245288110833085,0.03519910026553371,0.03515319199956696,0.03510756087227448,0.03506220447297559,0.03501712042048034,0.034972306362612594,0.03492775997574268,0.03488347896432958,0.034839461060472275,0.03479570402347013,0.03475220563939194,0.03470896372065373,0.03466597610560466,0.034623240658121335,0.034580755267209926,0.034538517846616094,0.03449652633444256,0.034454778692773996,0.03441327290730928,0.03437200698700067,0.03433097896370008,0.03429018689181187,0.03424962884795249,0.03420930293061633,0.03416920725984803,0.03412933997692088,0.034089699244021235,0.03405028324393879,0.03401109017976267,0.03397211827458308,0.033933365771198425,0.03389483093182793,0.033856512037829294,0.033818407389421754,0.0337805153054139,0.03374283412293662,0.03370536219718073,0.03366809790113935,0.03363103962535488,0.03359418577767045,0.03355753478298583,0.03352108508301763,0.03348483513606364,0.03344878341677149,0.03341292841591113,0.03337726864015144,0.0333418026118406,0.033306528868790375,0.03327144596406393,0.03323655246576754,0.03320184695684562,0.03316732803487933,0.03313299431188875,0.0330988444141381,0.033064876981944484,0.03303109066948982,0.03299748414463573,0.0329640560887418,0.03293080519648662,0.032897730175691905,0.03286482974714952,0.0328321026444513,0.03279954761382167,0.03276716341395307,0.03273494881584392,0.03270290260263939,0.032671023569474586,0.03263931052332031,0.03260776228283142,0.03257637767819742,0.03254515555099552,0.03251409475404612,0.032483194151270434,0.032452452617550434,0.03242186903859108,0.03239144231078449,0.03236117134107651,0.032331055046835144,0.03230109235572115,0.032271282205560595,0.03224162354421937,0.03221211532947969,0.03218275652891842,0.03215354611978731,0.03212448308889502,0.032095566432490986,0.032066795156150976,0.03203816827466448,0.03200968481192365,0.03198134380081404,0.03195314428310692,0.031925085309353195,0.031897165938778886,0.03186938523918223,0.03184174228683223,0.03181423616636871,0.03178686597070389,0.03175963080092532,0.0317325297662003,0.03170556198368164,0.03167872657841488,0.0316520226832467,0.03162544943873477,0.03159900599305889,0.03157269150193335,0.03154650512852056,0.03152044604334594,0.031494513424214,0.0314687064561256,0.0314430243311964,0.03141746624857641,0.03139203141437078,0.03136671904156157,0.03134152834993066,0.03131645856598381,0.03129150892287561,0.03126667866033569,0.031241967024595686,0.031217373268317472,0.031192896650522186,0.031168536436520327,0.031144291897842766,0.031120162312172704,0.031096146963278577,0.031072245140947828,0.031048456140921613,0.03102477926483035,0.03100121382013016,0.030977759120040173,0.030954414483480595,0.030931179235011704,0.03090805270477358,0.03088503422842667,0.03086212314709312,0.03083931880729888,0.0308166205609166,0.030794027765109228,0.030771539782274367,0.03074915597998938,0.03072687573095715,0.030704698412952623,0.030682623408769958,0.03066065010617043,0.030638777897830958,0.0306170061812933,0.030595334358913904,0.030573761837814434,0.03055228802983286,0.030530912351475193,0.030509634223867876,0.030488453072710715,0.030467368328230413,0.030446379425134746,0.030425485802567223,0.03040468690406239,0.030383982177501656,0.030363371075069666,0.030342853053211216,0.03032242757258873,0.03030209409804022,0.030281852098537815,0.030261701047146712,0.030241640420984733,0.03022166970118232,0.03020178837284302,0.030181995925004458,0.0301622918505998,0.030142675646419634,0.030123146813074375,0.030103704854957076,0.030084349280206705,0.03006507960067186,0.030045895331874902,0.030026795992976554,0.030007781106740863,0.029988850199500677,0.029970002801123385,0.02995123844497719,0.029932556667897736,0.02991395701015511,0.02989543901542124,0.029877002230737703,0.029858646206483846,0.02984037049634538,0.029822174657283214,0.029804058249502753,0.029786020836423496,0.029768061984649017,0.029750181263937255,0.02973237824717117,0.02971465251032975,0.02969700363245932,0.029679431195645183,0.029661934784983593,0.029644513988554052,0.029627168397391913,0.029609897605461278,0.02959270120962824,0.029575578809634365,0.029558530008070565,0.02954155441035116,0.02952465162468829,0.029507821262066632,0.02949106293621832,0.029474376263598223,0.029457760863359467,0.029441216357329193,0.029424742369984658,0.029408338528429532,0.02939200446237049,0.029375739804094025,0.0293595441884436,0.029343417252796922,0.029327358637043565,0.029311367983562826,0.02929544493720173,0.029279589145253422,0.029263800257435645,0.029248077925869555,0.029232421805058726,0.02921683155186834,0.029201306825504703,0.029185847287494838,0.029170452601666463,0.02915512243412801,0.029139856453248996,0.029124654329640527,0.029109515736136012,0.029094440347772112,0.02907942784176989,0.0290644778975161,0.029049590196544735,0.02903476442251876,0.029020000261211997,0.029005297400491258,0.028990655530298597,0.028976074342633794,0.028961553531537013,0.02894709279307164,0.028932691825307253,0.028918350328302842,0.028904068004090164,0.028889844556657253,0.028875679691932117,0.028861573117766614,0.028847524543920457,0.028833533682045435,0.028819600245669732,0.02880572395018243,0.028791904512818243,0.028778141652642218,0.02876443509053483,0.028750784549177018,0.028737189753035502,0.028723650428348194,0.02871016630310976,0.02869673710705734,0.028683362571656382,0.02867004243008667,0.028656776417228413,0.028643564269648543,0.02863040572558713,0.028617300524943885],"type":"scatter"},{"mode":"lines","name":"Total","x":[0.1,0.11583166332665332,0.13166332665330663,0.1474949899799599,0.16332665330661322,0.17915831663326653,0.19498997995991985,0.21082164328657316,0.22665330661322647,0.24248496993987978,0.2583166332665331,0.2741482965931864,0.2899799599198397,0.305811623246493,0.32164328657314634,0.33747494989979965,0.35330661322645296,0.36913827655310627,0.3849699398797596,0.4008016032064129,0.4166332665330662,0.4324649298597195,0.4482965931863728,0.46412825651302614,0.47995991983967934,0.49579158316633265,0.511623246492986,0.5274549098196393,0.5432865731462926,0.5591182364729459,0.5749498997995992,0.5907815631262525,0.6066132264529058,0.6224448897795591,0.6382765531062125,0.6541082164328658,0.6699398797595191,0.6857715430861724,0.7016032064128257,0.717434869739479,0.7332665330661323,0.7490981963927856,0.7649298597194389,0.7807615230460923,0.7965931863727456,0.8124248496993989,0.8282565130260522,0.8440881763527055,0.8599198396793587,0.875751503006012,0.8915831663326653,0.9074148296593186,0.923246492985972,0.9390781563126253,0.9549098196392786,0.9707414829659319,0.9865731462925852,1.0024048096192386,1.018236472945892,1.0340681362725452,1.0498997995991985,1.0657314629258519,1.0815631262525052,1.0973947895791585,1.1132264529058118,1.129058116232465,1.1448897795591184,1.1607214428857717,1.176553106212425,1.1923847695390783,1.2082164328657317,1.224048096192385,1.2398797595190383,1.2557114228456916,1.271543086172345,1.2873747494989982,1.3032064128256515,1.3190380761523048,1.3348697394789582,1.3507014028056115,1.3665330661322648,1.382364729458918,1.3981963927855714,1.4140280561122247,1.429859719438878,1.4456913827655313,1.4615230460921846,1.477354709418838,1.4931863727454913,1.5090180360721446,1.5248496993987979,1.5406813627254512,1.5565130260521045,1.5723446893787578,1.5881763527054111,1.6040080160320644,1.6198396793587175,1.6356713426853708,1.6515030060120242,1.6673346693386775,1.6831663326653308,1.698997995991984,1.7148296593186374,1.7306613226452907,1.746492985971944,1.7623246492985973,1.7781563126252506,1.793987975951904,1.8098196392785573,1.8256513026052106,1.841482965931864,1.8573146292585172,1.8731462925851705,1.8889779559118238,1.9048096192384771,1.9206412825651304,1.9364729458917838,1.952304609218437,1.9681362725450904,1.9839679358717437,1.999799599198397,2.01563126252505,2.0314629258517036,2.0472945891783567,2.0631262525050102,2.0789579158316633,2.094789579158317,2.1106212424849704,2.1264529058116235,2.1422845691382766,2.15811623246493,2.173947895791583,2.1897795591182367,2.20561122244489,2.2214428857715434,2.2372745490981965,2.25310621242485,2.268937875751503,2.2847695390781566,2.3006012024048097,2.3164328657314632,2.3322645290581163,2.34809619238477,2.363927855711423,2.3797595190380765,2.3955911823647296,2.411422845691383,2.427254509018036,2.4430861723446897,2.458917835671343,2.4747494989979963,2.4905811623246494,2.506412825651303,2.522244488977956,2.5380761523046096,2.5539078156312627,2.569739478957916,2.5855711422845693,2.601402805611223,2.617234468937876,2.6330661322645295,2.6488977955911825,2.664729458917836,2.680561122244489,2.6963927855711427,2.712224448897796,2.7280561122244493,2.7438877755511024,2.759719438877756,2.775551102204409,2.7913827655310626,2.8072144288577157,2.823046092184369,2.8388777555110223,2.854709418837676,2.870541082164329,2.8863727454909824,2.9022044088176355,2.918036072144289,2.933867735470942,2.9496993987975957,2.9655310621242488,2.9813627254509023,2.9971943887775554,3.013026052104209,3.028857715430862,3.0446893787575156,3.0605210420841686,3.076352705410822,3.0921843687374753,3.108016032064129,3.123847695390782,3.139679358717435,3.1555110220440885,3.1713426853707416,3.187174348697395,3.203006012024048,3.2188376753507018,3.234669338677355,3.2505010020040084,3.2663326653306615,3.282164328657315,3.297995991983968,3.3138276553106216,3.3296593186372747,3.3454909819639282,3.3613226452905813,3.377154308617235,3.392985971943888,3.4088176352705415,3.4246492985971946,3.440480961923848,3.456312625250501,3.4721442885771547,3.487975951903808,3.5038076152304614,3.5196392785571144,3.535470941883768,3.551302605210421,3.5671342685370746,3.5829659318637277,3.5987975951903812,3.6146292585170343,3.630460921843688,3.646292585170341,3.6621242484969945,3.6779559118236476,3.693787575150301,3.709619238476954,3.7254509018036077,3.741282565130261,3.7571142284569143,3.7729458917835674,3.788777555110221,3.804609218436874,3.8204408817635276,3.8362725450901807,3.852104208416834,3.8679358717434873,3.883767535070141,3.899599198396794,3.9154308617234475,3.9312625250501005,3.947094188376754,3.962925851703407,3.9787575150300607,3.994589178356714,4.010420841683367,4.02625250501002,4.0420841683366735,4.057915831663327,4.073747494989981,4.089579158316633,4.105410821643287,4.12124248496994,4.137074148296593,4.1529058116232465,4.1687374749499,4.184569138276553,4.200400801603206,4.21623246492986,4.232064128256513,4.247895791583166,4.263727454909819,4.279559118236473,4.2953907815631265,4.311222444889779,4.327054108216433,4.342885771543086,4.35871743486974,4.374549098196392,4.390380761523046,4.406212424849699,4.422044088176353,4.437875751503006,4.453707414829659,4.469539078156313,4.485370741482966,4.501202404809619,4.517034068136272,4.532865731462926,4.5486973947895795,4.564529058116232,4.580360721442886,4.596192384769539,4.612024048096193,4.627855711422845,4.643687374749499,4.659519038076152,4.675350701402806,4.691182364729459,4.707014028056112,4.722845691382766,4.738677354709419,4.754509018036072,4.770340681362725,4.786172344689379,4.802004008016032,4.817835671342685,4.833667334669339,4.849498997995992,4.865330661322646,4.881162324649298,4.896993987975952,4.912825651302605,4.928657314629259,4.944488977955912,4.960320641282565,4.976152304609219,4.991983967935872,5.007815631262525,5.023647294589178,5.039478957915832,5.055310621242485,5.071142284569138,5.086973947895792,5.102805611222445,5.118637274549099,5.134468937875751,5.150300601202405,5.166132264529058,5.181963927855711,5.197795591182365,5.213627254509018,5.229458917835672,5.245290581162324,5.261122244488978,5.276953907815631,5.292785571142285,5.3086172344689375,5.324448897795591,5.340280561122245,5.356112224448898,5.371943887775551,5.387775551102204,5.403607214428858,5.419438877755511,5.435270541082164,5.4511022044088175,5.466933867735471,5.482765531062125,5.498597194388777,5.514428857715431,5.530260521042084,5.546092184368738,5.5619238476953905,5.577755511022044,5.593587174348698,5.609418837675351,5.625250501002004,5.641082164328657,5.656913827655311,5.672745490981964,5.688577154308617,5.7044088176352705,5.720240480961924,5.736072144288578,5.75190380761523,5.767735470941884,5.783567134268537,5.799398797595191,5.8152304609218435,5.831062124248497,5.8468937875751505,5.862725450901804,5.878557114228457,5.89438877755511,5.910220440881764,5.926052104208417,5.94188376753507,5.9577154308617235,5.973547094188377,5.989378757515031,6.005210420841683,6.021042084168337,6.03687374749499,6.052705410821644,6.0685370741482965,6.08436873747495,6.1002004008016035,6.116032064128257,6.13186372745491,6.147695390781563,6.163527054108217,6.179358717434869,6.195190380761523,6.2110220440881765,6.22685370741483,6.242685370741483,6.258517034068136,6.27434869739479,6.290180360721443,6.306012024048096,6.321843687374749,6.337675350701403,6.3535070140280565,6.369338677354709,6.385170340681363,6.401002004008016,6.41683366733467,6.432665330661322,6.448496993987976,6.4643286573146295,6.480160320641283,6.495991983967936,6.511823647294589,6.527655310621243,6.543486973947896,6.559318637274549,6.575150300601202,6.590981963927856,6.6068136272545095,6.622645290581162,6.638476953907816,6.654308617234469,6.670140280561123,6.685971943887775,6.701803607214429,6.7176352705410824,6.733466933867736,6.749298597194389,6.765130260521042,6.780961923847696,6.796793587174349,6.812625250501002,6.828456913827655,6.844288577154309,6.8601202404809625,6.875951903807615,6.891783567134269,6.907615230460922,6.923446893787576,6.939278557114228,6.955110220440882,6.970941883767535,6.986773547094189,7.002605210420842,7.018436873747495,7.034268537074149,7.050100200400802,7.065931863727455,7.081763527054108,7.097595190380762,7.1134268537074155,7.129258517034068,7.145090180360722,7.160921843687375,7.176753507014029,7.192585170340681,7.208416833667335,7.224248496993988,7.240080160320641,7.255911823647295,7.271743486973948,7.287575150300602,7.303406813627254,7.319238476953908,7.335070140280561,7.350901803607215,7.3667334669338675,7.382565130260521,7.398396793587175,7.414228456913828,7.430060120240481,7.445891783567134,7.461723446893788,7.477555110220441,7.493386773547094,7.509218436873748,7.525050100200401,7.540881763527055,7.556713426853707,7.572545090180361,7.588376753507014,7.604208416833668,7.6200400801603205,7.635871743486974,7.651703406813628,7.667535070140281,7.683366733466934,7.699198396793587,7.715030060120241,7.730861723446894,7.746693386773547,7.7625250501002006,7.778356713426854,7.794188376753508,7.81002004008016,7.825851703406814,7.841683366733467,7.857515030060121,7.8733466933867735,7.889178356713427,7.905010020040081,7.920841683366734,7.936673346693387,7.95250501002004,7.968336673346694,7.984168336673347,8.0],"y":[0.09909620514937895,0.0959033379497752,0.09317536879298384,0.09079952122623175,0.08869951828334968,0.08682140263496178,0.08512561712287384,0.08358230474979643,0.0821683786871709,0.0808656197786908,0.0796593980901938,0.07853778825234328,0.07749094159035848,0.07651063053944,0.07558991157301145,0.07472287147201281,0.07390443336318314,0.07313020638140892,0.07239636768036058,0.07169956877635925,0.07103686043641833,0.07040563186783239,0.06980356105829418,0.0692285738974348,0.06867881027835555,0.068152595795008,0.0676484179615701,0.06716490611317459,0.0667008143243716,0.0662550068173398,0.06582644543668273,0.06541417884932016,0.0650173331921102,0.06463510394054728,0.06426674881225536,0.06391158155134674,0.063568966465797,0.06323831361113061,0.0629190745309492,0.06261073847895846,0.062312829058778815,0.062024901227447644,0.06174653861651431,0.06147735113130176,0.061216972794498,0.060965059804942885,0.060721288786445074,0.06048535520482683,0.060256971934254076,0.06003586795634696,0.05982178717765264,0.05961448735285265,0.05941373910261758,0.05921932501635184,0.05903103883122174,0.05884868467985864,0.05867207639999697,0.058501036900064,0.058335397575399524,0.058174997770363064,0.05801968428209464,0.0578693109021421,0.05772373799256242,0.057582832093452246,0.057446465559170594,0.05731451622078996,0.057186867072554076,0.05706340598033608,0.05694402541028291,0.05682862217600316,0.05671709720280854,0.05660935530765654,0.05650530499356434,0.0564048582573747,0.05630793040985374,0.05621443990718953,0.05612430819304143,0.056037459550362184,0.05595382096228119,0.05587332198139605,0.05579589460687404,0.05572147316881364,0.05564999421936052,0.05558139643011326,0.05551562049539015,0.05545260904096232,0.055392306537888875,0.05533465922111728,0.05527961501253833,0.05522712344820758,0.05517713560946696,0.0551296040577198,0.05508448277263013,0.055041727093533964,0.055001293663865046,0.054963140378411865,0.05492722633323511,0.054893511778086976,0.054861958071184214,0.05483252763619725,0.05480518392132663,0.054779891360346916,0.05475661533550581,0.05473532214217393,0.054715978955147015,0.05469855379650935,0.05468301550497218,0.054669333706606885,0.054657478786897806,0.05464742186404364,0.05463913476344141,0.05463258999329077,0.05462776072125992,0.05462462075215829,0.05462314450656455,0.05462330700036084,0.05462508382512778,0.05462845112935712,0.05463338560044115,0.054639864447400974,0.054647865384317124,0.054657366614428646,0.05466834681486843,0.05468078512200446,0.05469466111735798,0.054709954814071975,0.054726646643903545,0.054744717444716685,0.05476414844845181,0.05478492126955058,0.054807017893815514,0.05483042066768441,0.05485511228790149,0.05488107579156753,0.054908294546552175,0.05493675224225278,0.05496643288068471,0.054997320767888824,0.05502940050564257,0.05506265698346167,0.0550970753708805,0.0551326411099991,0.05516933990828591,0.05520715773162574,0.05524608079760275,0.05528609556900902,0.05532718874756942,0.055369347267874236,0.055412558291511226,0.05545680920138913,0.05550208759624508,0.055548381285328886,0.055595678283257094,0.055643966805030434,0.055693235261208236,0.055743472253234,0.05579466656890622,0.05584680717798915,0.05589988322795815,0.05595388403987461,0.05600879910438589,0.056064618077845324,0.05612133077854821,0.056178927183079416,0.05623739742276866,0.05629673178024958,0.05635692068611888,0.05641795471569206,0.056479824585852295,0.05654252115198918,0.056606035405024346,0.05667035846852077,0.05673548159587309,0.056801396167575915,0.05686809368856781,0.05693556578564812,0.057003804204964356,0.05707280080956764,0.05714254757703417,0.057213036597150366,0.0572842600696596,0.05735621030206861,0.05742887970751161,0.057502260802670215,0.05757634620574746,0.05765112863449405,0.05772660090428551,0.05780275592624805,0.057879586705432376,0.05795708633903324,0.05803524801465384,0.058114065008613304,0.05819353068429632,0.05827363849054319,0.058354381960079485,0.0584357547079839,0.05851775043019308,0.058600362902042714,0.05868358597684313,0.05876741358448925,0.05885183973010308,0.05893685849270829,0.05902246402393578,0.05910865054675937,0.05919541235426075,0.05928274380842276,0.05937063933895041,0.05945909344211862,0.05954810067964602,0.05963765567759423,0.059727753125291605,0.05981838777428108,0.05990955443729108,0.0600012479872295,0.06009346335619919,0.060186195534535344,0.06027943956986348,0.060373190566177765,0.06046744368293919,0.06056219413419285,0.06065743718770407,0.060753168164112595,0.060849382436104736,0.060946075427602636,0.06104324261297041,0.06114087951623681,0.061238981710333644,0.06133754481634998,0.06143656450280145,0.06153603648491429,0.06163595652392388,0.0617363204263873,0.061837124043509606,0.061938363270483465,0.062040034045841824,0.06214213235082329,0.06224465420874993,0.062347595684417174,0.06245095288349542,0.06255472195194337,0.06265889907543234,0.06276348047878191,0.06286846242540584,0.06297384121676873,0.06307961319185294,0.06318577472663525,0.06329232223357345,0.06339925216110234,0.06350656099313906,0.06361424524859755,0.06372230148091167,0.06383072627756728,0.06393951625964257,0.0640486680813568,0.06415817842962693,0.06426804402363243,0.06437826161438762,0.06448882798432162,0.06459973994686569,0.06471099434604792,0.06482258805609467,0.06493451798103932,0.06504678105433744,0.06515937423848887,0.06527229452466601,0.06538553893234861,0.0654991045089647,0.06561298832953763,0.06572718749633898,0.06584169913854729,0.06595652041191256,0.06607164849842628,0.06618708060599679,0.06630281396813018,0.06641884584361629,0.06653517351621993,0.06665179429437694,0.0667687055108954,0.0668859045226614,0.06700338871034978,0.06712115547813938,0.06723920225343262,0.06735752648657994,0.06747612565060822,0.06759499724095361,0.06771413877519851,0.06783354779281273,0.06795322185489854,0.06807315854393967,0.06819335546355434,0.06831381023825181,0.06843452051319279,0.06855548395395361,0.06867669824629367,0.06879816109592662,0.06891987022829496,0.06904182338834779,0.06916401834032224,0.06928645286752781,0.06940912477213404,0.06953203187496135,0.06965517201527477,0.06977854305058095,0.06990214285642787,0.07002596932620744,0.07015002037096141,0.07027429391918927,0.07039878791665974,0.07052350032622436,0.07064842912763389,0.07077357231735751,0.07089892790840431,0.07102449393014737,0.07115026842815037,0.07127624946399655,0.0714024351151201,0.07152882347463976,0.07165541265119488,0.07178220076878365,0.07190918596660352,0.07203636639889388,0.07216374023478067,0.07229130565812358,0.07241906086736455,0.07254700407537913,0.07267513350932919,0.07280344741051793,0.07293194403424674,0.073060621649674,0.07318947853967553,0.07331851300070721,0.07344772334266922,0.07357710788877192,0.07370666497540378,0.07383639295200084,0.07396629018091783,0.074096355037301,0.0742265859089627,0.07435698119625729,0.074487539311959,0.07461825868114097,0.07474913774105599,0.07488017494101895,0.07501136874229034,0.07514271761796147,0.07527422005284128,0.07540587454334417,0.07553767959737952,0.07566963373424243,0.07580173548450594,0.0759339833899144,0.07606637600327837,0.0761989118883705,0.07633158961982303,0.07646440778302624,0.0765973649740283,0.07673045979943627,0.07686369087631825,0.07699705683210685,0.07713055630450355,0.0772641879413845,0.07739795040070721,0.0775318423504185,0.0776658624683634,0.0778000094421952,0.07793428196928658,0.07806867875664167,0.07820319852080924,0.0783378399877969,0.07847260189298616,0.07860748298104868,0.07874248200586324,0.07887759773043389,0.07901282892680886,0.0791481743760006,0.07928363286790639,0.07941920320123025,0.07955488418340546,0.07969067463051803,0.07982657336723108,0.07996257922670993,0.08009869105054826,0.08023490768869476,0.08037122799938098,0.08050765084904968,0.08064417511228404,0.08078079967173779,0.08091752341806592,0.08105434524985622,0.08119126407356166,0.0813282788034333,0.08146538836145417,0.08160259167727368,0.08173988768814282,0.08187727533884998,0.08201475358165759,0.0821523213762394,0.0822899776896183,0.08242772149610492,0.0825655517772369,0.08270346752171873,0.08284146772536226,0.08297955139102786,0.08311771752856612,0.08325596515476023,0.083394293293269,0.08353270097457029,0.08367118723590529,0.08380975112122313,0.08394839168112621,0.08408710797281613,0.08422589906003994,0.08436476401303725,0.08450370190848769,0.08464271182945889,0.0847817928653551,0.08492094411186626,0.08506016467091765,0.0851994536506199,0.08533881016521971,0.08547823333505089,0.08561772228648595,0.08575727615188833,0.08589689406956467,0.08603657518371816,0.0861763186444018,0.08631612360747248,0.08645598923454534,0.08659591469294864,0.0867358991556791,0.08687594180135755,0.0870160418141852,0.08715619838390015,0.08729641070573452,0.08743667798037175,0.08757699941390452,0.08771737421779308,0.08785780160882374,0.08799828080906809,0.08813881104584231,0.08827939155166709,0.08842002156422782,0.0885607003263352,0.08870142708588617,0.08884220109582526,0.08898302161410636,0.08912388790365468,0.08926479923232922,0.08940575487288559,0.08954675410293902,0.08968779620492795,0.08982888046607776,0.08997000617836487,0.09011117263848137,0.09025237914779966,0.09039362501233764,0.09053490954272422,0.09067623205416502,0.09081759186640839,0.09095898830371192,0.09110042069480914,0.09124188837287642,0.09138339067550026,0.09152492694464505,0.09166649652662084,0.09180809877205148,0.09194973303584324,0.09209139867715335,0.09223309505935923,0.0923748215500277,0.09251657752088455,0.09265836234778443,0.09280017541068099,0.09294201609359715,0.09308388378459594,0.09322577787575119,0.09336769776311891,0.09350964284670851,0.09365161253045463,0.09379360622218891,0.0939356233336123,0.09407766328026733,0.09421972548151089,0.09436180936048696,0.09450391434409988,0.09464603986298759,0.09478818535149527,0.09493035024764909,0.09507253399313034,0.09521473603324959,0.09535695581692123,0.09549919279663809,0.09564144642844649,0.09578371617192123,0.09592600149014098,0.0960683018496638,0.09621061672050296,0.09635294557610286,0.09649528789331506,0.09663764315237489],"type":"scatter"}],                        {"template":{"data":{"scatter":[{"connectgaps":true,"line":{"width":2},"marker":{"size":5},"mode":"lines","opacity":0.9,"type":"scatter"}]},"layout":{"autosize":true,"colorway":["#4477AA","#66CCEE","#CCBB44","#AA3377","#228833","#EE6677","#BBBBBB"],"font":{"color":"#3F5661","size":12},"legend":{"bgcolor":"rgba(255, 255, 255, 0)","font":{"size":12},"traceorder":"normal"},"margin":{"b":60,"l":70,"r":30,"t":60},"paper_bgcolor":"#EFF5F5","plot_bgcolor":"#EFF5F5","title":{"font":{"size":24},"x":0.001,"xanchor":"left","xref":"paper","yanchor":"top"},"xaxis":{"gridcolor":"#BBBBBB","griddash":"dot","gridwidth":0.1,"showgrid":true,"showline":true,"tickfont":{"size":12},"title":{"standoff":10,"text":"X-axis Title","font":{"size":16}},"zeroline":true,"zerolinecolor":"#B7C6CF","zerolinewidth":0.1},"yaxis":{"gridcolor":"#BBBBBB","griddash":"dot","gridwidth":0.1,"showgrid":true,"showline":true,"tickfont":{"size":12},"title":{"standoff":10,"text":"Y-axis Title","font":{"size":16}},"zeroline":true,"zerolinecolor":"#B7C6CF","zerolinewidth":0.1}}},"title":{"text":"Bias-Variance decomposition"},"xaxis":{"title":{"text":"Penalty"}},"yaxis":{"title":{"text":"Value"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6bfd76e6-c068-4e75-91d7-32518de3516c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div id="exm-" class="custom_problem theorem example">
<p><span class="theorem-title"><strong>Example 30.1</strong></span> <strong>線形クラスにおけるBias and Variance</strong> <br></p>
<p>True functionを</p>
<p><span class="math display">\[
f(x) = \pmb{\theta}^Tx
\]</span></p>
<p>と定義し，<span class="math inline">\(\pmb{\theta}\)</span> は未知であるとします．Training dataset <span class="math inline">\(D\)</span> を用いて，</p>
<p><span class="math display">\[
\hat f_D(x) = \widehat{\pmb{\theta}}_D^Tx
\]</span></p>
<p>を学習したとします．このとき，未知のデータセット <span class="math inline">\(\pmb{S} = \{(x^*, y^*)\}\)</span> において，</p>
<p><span class="math display">\[
\begin{align*}
\text{Bias}(\hat f_D)
    &amp;= \mathbb E[\hat f_D(x) - f(x) \vert \pmb{S}]\\
    &amp;= \mathbb E[\widehat{\pmb{\theta}}_D^Tx - \pmb{\theta}^Tx\vert \pmb{S}]\\
    &amp;= \mathbb E[\widehat{\pmb{\theta}}_D - \pmb{\theta}\vert \pmb{S}]^Tx\\
    &amp;= \text{Bias}(\widehat{\pmb{\theta}}_D)^Tx
\end{align*}
\]</span></p>
<p>同様に</p>
<p><span class="math display">\[
\begin{align*}
&amp;\operatorname{Var}(\hat f_D)\\
    &amp;= \mathbb E[(\hat f_D(x) - f(x))^2 \vert \pmb{S}]\\
    &amp;= \mathbb E[(\widehat{\pmb{\theta}}_D^Tx - \pmb{\theta}^Tx)^2\vert \pmb{S}]\\
    &amp;= \mathbb E[((\widehat{\pmb{\theta}}_D^T - \pmb{\theta}^T)x)^T((\widehat{\pmb{\theta}}_D^T - \pmb{\theta}^T)x)\vert \pmb{S}]\\
    &amp;= \mathbb E[x^T(\widehat{\pmb{\theta}}_D - \pmb{\theta})(\widehat{\pmb{\theta}}_D - \pmb{\theta})^Tx\vert  \pmb{S}]\\
    &amp;= x^T\operatorname{Var}(\widehat{\pmb{\theta}})x
\end{align*}
\]</span></p>
<p>なお，最後の式変形は <span class="math inline">\(a\)</span> を定数としたときに <span class="math inline">\(\operatorname{Var}(a - X) = \operatorname{Var}(X)\)</span> を用いています．</p>
</div>
<div class="nte- callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🍵 Green Tea Break
</div>
</div>
<div class="callout-body-container callout-body">
<p>予測におけるBias-Variance分解は <em>Overfitting</em>，<em>Underfitting</em> という結びつけて考えることができます．</p>
<p><strong> ▶&nbsp; Overfitting</strong></p>
<p>training dataにおける予測精度はとても良いがtest dataにおける予測精度がとても悪い予測モデルに対して<em>Overfitting</em>という評価をします．これは予測モデルがtraining dataのノイズを拾いすぎてしまったときに発生します．</p>
<p><em>Overfitting</em>は表現力(capacity)の高いモデルを用いたときに発生する可能性が高いです．実際に発生したときは，</p>
<ul>
<li>high bias and high variance</li>
<li>low bias and high variance</li>
</ul>
<p>いずれも考えることができますが，基本的にはhigh varianceを疑いアクションをとるという対処方針となります，対処方法として，</p>
<ul>
<li>正則化</li>
<li>より大きいデータセットの活用</li>
<li>inputeとして用いる特徴量の数を少なくする</li>
<li>より表現力が狭められたモデルを学習モデルに用いる</li>
<li>BoostingよりBagging</li>
</ul>
<p>といったことをトライすることが推奨されます．</p>
<p><strong> ▶&nbsp; Underfitting</strong></p>
<p><em>Underfitting</em>とは，training dataにおいても十分な学習ができていない状況を指す概念です． モデルの表現力が低い場合に起きることが多く，またhigh biasの状況と関連しているケースが多いです．この場合，traing dataset自体にfitできていないので，さらなるデータ収集することは費用対効果に見合いません．</p>
<ul>
<li>罰則項の緩和</li>
<li>特徴量の拡充</li>
<li>より表現力のあるモデルのトライ</li>
<li>Boosting</li>
</ul>
<p>が推奨されます．</p>
<p><strong> ▶&nbsp; Rule of thumbs</strong></p>
<p>汎化性能が悪い場合に，まずbias-varianceのどちらの要因が重きを占めているのか？を考えることが重要です．その判別方法として経験則的に知られているステップとして，</p>
<ul>
<li>Training data errorが大きい場合は，もしモデルがトレーニングデータ自体にうまくフィットできないということになるので，そのモデルはhigh biasを持っている可能性が高いと判断する</li>
<li>Cross validation errorとprediction erro in training datasetの差は、モデルや推定量の分散として扱うことができるので，Cross validation errorが高い場合は <em>overfitting</em> の状態と判断する</li>
</ul>
<p>Training dataset errorに比べCross validation errorが高いときに，線形モデルからneural networkモデルへ変更することはあまり意味のない（むしろ状況を悪化させる）となるケースが多いというアクションになります．</p>
</div>
</div>
</section>
<section id="decomposition-of-expected-test-error" class="level2">
<h2 class="anchored" data-anchor-id="decomposition-of-expected-test-error">Decomposition of Expected Test Error</h2>
<p>上では未知のデータセット <span class="math inline">\(\{x^*, y^*\}\)</span> について <span class="math inline">\(\{x^*\}\)</span> コントロールしたときのBias-Variance Decompositionを確認しましたが 未知のデータセット <span class="math inline">\((\pmb{x}, y)\)</span> とtraining dataset <span class="math inline">\(D\)</span> についてのexptected decompositonを確認していきます．</p>
<p>なお，Expected Prediction functionについて以下のnotationを導入します</p>
<p><span class="math display">\[
\bar{f} = E_{D} \left[ \hat f_D \right] = \int\limits_D \hat f_D \Pr(D) \partial D
\]</span></p>
<p><span class="math inline">\(\bar{f}\)</span> は <span class="math inline">\(D\)</span> の確率で重みづけたそれぞれの予測関数のweighted averageと理解できます．</p>
<p><span id="eq-bais-variance-decomposition-2"><span class="math display">\[
\begin{align*}
&amp;\mathbb E_{\pmb x, y, D}[(\hat f_D(\pmb x) - y)^2]\\
&amp;= \mathbb E_{\pmb x, y, D}[(\hat f_D(\pmb x) - \bar{f}(\pmb x) + \bar{f}(\pmb x) - y)^2]\\
&amp;= \underbrace{\mathbb E_{\pmb x, D}[(\hat f_D(\pmb x) - \bar{f}(\pmb x))^2]}_{\text{Variance}} +  \mathbb E_{\pmb x, y}[(\bar{f}(\pmb x) - y)^2]
\end{align*}
\tag{30.2}\]</span></span></p>
<p>なお途中の式変形において次の性質を利用しています</p>
<p><span class="math display">\[
\begin{align*}
    &amp;\mathbb E_{\mathbf{x}, y, D} \left[\left(\hat f_{D}(\mathbf{x}) - \bar{f}(\mathbf{x})\right) \left(\bar{f}(\mathbf{x}) - y\right)\right] \\
    &amp;= \mathbb E_{\mathbf{x}, y} \left[E_{D} \left[ \hat f_{D}(\mathbf{x}) - \bar{f}(\mathbf{x})\right] \left(\bar{f}(\mathbf{x}) - y\right) \right] \because{\text{LIE}}\\
    &amp;= \mathbb E_{\mathbf{x}, y} \left[ \left( E_{D} \left[ \hat f_{D}(\mathbf{x}) \right] - \bar{f}(\mathbf{x}) \right) \left(\bar{f}(\mathbf{x}) - y \right)\right] \\
    &amp;= \mathbb E_{\mathbf{x}, y} \left[ \left(\bar{f}(\mathbf{x}) - \bar{f}(\mathbf{x}) \right) \left(\bar{f}(\mathbf{x}) - y \right)\right] \\
    &amp;= \mathbb E_{\mathbf{x}, y} \left[ 0 \right] \\
    &amp;= 0
\end{align*}
\]</span></p>
<p>次に，<a href="#eq-bais-variance-decomposition-2" class="quarto-xref">Equation&nbsp;<span>30.2</span></a> の第二項について考えます．</p>
<p><span class="math display">\[
\begin{align*}
&amp;\mathbb E_{\pmb x, y}[(\bar{f}(\pmb x) - y)^2]\\
&amp;= \mathbb E_{\pmb x, y}[(\bar{f}(\pmb x) - h(\pmb x) + h(\pmb x) - y)^2]\\
&amp;= \mathbb E_{\pmb x}[(\bar{f}(\pmb x) - h(\pmb x))^2] + \mathbb E_{\pmb x, y}[(h(\pmb x) - y)^2]\\
&amp;= \mathbb E_{\pmb x}[\text{Bias}^2(\pmb{x})] + \mathbb E_{\pmb x}[\mathbb E[\epsilon^2 \vert \pmb{x}]]\\
&amp;= \mathbb E[\text{Bias}^2] + \mathbb E[\epsilon^2]
\end{align*}
\]</span></p>
<p>以上より</p>
<p><span class="math display">\[
\mathbb E_{\pmb x, y, D}[(\hat f_D(\pmb x) - y)^2] = \mathbb E[\text{Variance of }\hat f_D] + \mathbb E[\text{Bias}^2] + \mathbb E[\epsilon^2]
\]</span></p>


</section>

</main> <!-- /main -->
<script>
   document.querySelectorAll('.custom_problem .theorem-title').forEach((title) => {
       let modName = title.innerHTML;
       modName = modName.replace("Exercise", "Problem");
       modName = modName.replace("Example", "<strong>&#9654;</strong>&nbsp; Example");
       title.innerHTML = modName;
   });
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ryonakagami\.github\.io\/statistics-for-regression-monkey\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="RyoNakagami/statistics-for-regression-monkey" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../posts/prediction/chapter_header.html" class="pagination-link" aria-label="Prediction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Prediction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../posts/mathematical_appendix/taylor_series.html" class="pagination-link" aria-label="テイラー展開">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">テイラー展開</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © Copyright RyoNak
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../LICENSE">
<p>License</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/RyoNakagami/statistics-for-regression-monkey/edit/main/posts/prediction/bias_variance_in_prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RyoNakagami/statistics-for-regression-monkey/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>