---
title: "è² ã®äºŒé …åˆ†å¸ƒ"
author: "Ryo Nakagami"
date: "2024-09-28"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

å¹¾ä½•åˆ†å¸ƒã‚„ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚µã‚¯ã‚»ã‚¹åˆ†å¸ƒã§ã¯ï¼Œ1å›ç›®ã®æˆåŠŸã‚’å¾—ã‚‹ã¾ã§ã®å¤±æ•—ã®å›æ•°ã¨ã„ã†ç¢ºç‡å¤‰æ•°ã‚’æ‰±ã„ã¾ã—ãŸãŒï¼Œ
ãã‚Œã‚’ $k$ å›ç›®ã®æˆåŠŸã‚’å¾—ã‚‹ã¾ã§ã®å¤±æ•—ã®å›æ•°ã¨ã„ã†ç¢ºç‡å¤‰æ•°ã«ä¸€èˆ¬åŒ–ã—ãŸåˆ†å¸ƒã®ã“ã¨ã‚’**è² ã®äºŒé …åˆ†å¸ƒ(ãƒ‘ã‚¹ã‚«ãƒ«åˆ†å¸ƒ)**ã¨ã„ã„ã¾ã™ï¼

## è² ã®äºŒé …åˆ†å¸ƒã®æ€§è³ª

<div class="blog-custom-border">
<strong>Def: è² ã®äºŒé …åˆ†å¸ƒ</strong> <br>

ç¢ºç‡å¤‰æ•° $X$ ãŒæˆåŠŸå›æ•° $r\in\mathbb N_+$, æˆåŠŸç¢ºç‡ $0<p<1$ ã®è² ã®äºŒé …åˆ†å¸ƒã«å¾“ã†ã¨ãï¼Œæ¨™æœ¬ç©ºé–“ã¯ $\mathcal{X} = \{0, 1, \cdots, n\}$ï¼Œç¢ºç‡é–¢æ•° $f_X(x)$ ã¯

$$
f_X(x) = \bigg\{\begin{array}{c}{}_{r+x-1}C_x p^r(1-p)^x & x \in \mathcal{X}\\0 & \text{otherwise}\end{array}
$$

ã“ã®ã¨ãï¼Œ$X\sim \operatorname{NBin}(r,p)$ ã¨è¡¨ã™ï¼

</div>

<strong > &#9654;&nbsp; ç¢ºç‡é–¢æ•°ã®å’Œ</strong>

$1/(1-q)$ ã®ãƒã‚¯ãƒ­ãƒ¼ãƒªãƒ³å±•é–‹ã‚ˆã‚Šï¼Œ

$$
\frac{1}{1-q}=1 + q + q^2 +\cdots = \sum_{k=0}^\infty q^k
$$

ä¸¡è¾ºã‚’ $q$ ã«ã¤ã„ã¦å¾®åˆ†ã™ã‚‹ã¨

$$
\frac{1}{(1-q)^2} =  \sum_{k=1}^\infty kq^{k-1} =\sum_{k=0}^\infty (k+1)q^{k}
$$

ã“ã‚Œã‚’ $r-1$ å›ç¹°ã‚Šè¿”ã™ã¨

$$
(r-1)!\frac{1}{(1-q)^r} =  \sum_{k=0}^\infty \frac{(k+r-1)!}{k!}q^{k}
$$

å¾“ã£ã¦ï¼Œ

<div class="math display" style="overflow: auto">
$$
\frac{1}{(1-q)^r} = \sum_{k=0}^\infty \frac{(k+r-1)!}{(r-1)!k!}q^{k}
$${#eq-comb-seq}
</div>


ã“ã‚Œã‚’ç¢ºç‡é–¢æ•°ã®å’Œã«ä»£å…¥ã™ã‚‹ã¨

$$
\begin{align*}
\sum_{x=0}^\infty f_X(x) 
    &= \sum_{x=0}^\infty {}_{r-1 +x}C_x p^r(1-p)^x\\
    &= p^r\sum_{x=0}^\infty {}_{r-1 + x}C_x (1-p)^x\\
    &= p^r\sum_{x=0}^\infty \frac{(r-1 + x)!}{(r-1)!x!}q^{x}\\
    &= p^r\frac{1}{(1-q)^r}\\
    &= 1
\end{align*}
$$

$$\tag*{\(\blacksquare\)}$$

<strong > &#9654;&nbsp; æœŸå¾…å€¤ã®å°å‡º</strong>

$$
\begin{align*}
\sum_{x=0}^\infty xf_X(x) 
    &= p^r\sum_{x=0}^\infty {}_{r+x-1}C_x x(1-p)^x\\
    &= rp^rq\sum_{x=1}^\infty \frac{(x+r-1)!}{(r)!(x-1)!}q^{x-1}\\
    &= rp^rq\sum_{k=0}^\infty \frac{(r+k)!}{(r)!k!}q^{k}\\
    &= rp^rq\frac{1}{(1-q)^{r+1}}\\
    &= r\frac{1-p}{p}
\end{align*}
$$

$$\tag*{\(\blacksquare\)}$$

<strong > &#9654;&nbsp; å¾®åˆ†ã‚’ç”¨ã„ãŸæœŸå¾…å€¤ã®å°å‡º</strong>

@eq-comb-seq ã®ä¸¡è¾ºã‚’ $q$ ã«ã¤ã„ã¦å¾®åˆ†ã™ã‚‹ã¨

<div class="math display" style="overflow: auto">
$$
\begin{align*}
r\frac{1}{(1-q)^{r+1}} = \sum_{x=1}^\infty x\frac{(x+r-1)!}{(r-1)!x!}q^{x-1}
\end{align*}
$${#eq-comb-seq-first}
</div>

ã“ã‚Œã‚’æ•´ç†ã™ã‚‹ã¨

$$
r\frac{qp^r}{(1-q)^{r+1}} = \sum_{k=0}^\infty k\frac{(k+r-1)!}{(r-1)!k!}q^{k}p^r
$$

RHSã¯æœŸå¾…å€¤ã¨ä¸€è‡´ã™ã‚‹ã®ã§

$$
\mathbb E[X] = \frac{r(1-p)}{p}
$$

$$\tag*{\(\blacksquare\)}$$

<strong > &#9654;&nbsp; åˆ†æ•£ã®å°å‡º</strong>

$$
\begin{align*}
\mathbb E[X(X-1)]
    &= \sum_{x=0}^\infty x(x-1) \frac{(r-1 + x)!}{(r-1)!x!}q^{x}p^r\\
    &= p^rq^2 \sum_{x=2}^\infty\frac{(r-1 + x)!}{(r-1)!(x-2)!}q^{x-2}\\
    &= r(r+1)p^rq^2 \sum_{k=0}^\infty\frac{(r+1 + k)!}{(r+1)!k!}q^{k}\\
    &= r(r+1)q^2\frac{p^r}{p^{r+2}}\\
    &= r(r+1)\frac{q^2}{p^2}
\end{align*}
$$

å¾“ã£ã¦ï¼Œ

$$
\begin{align*}
\operatorname{Var}(X) 
    &= r(r+1)\frac{q^2}{p^2} + r\frac{1-p}{p}\left[1 - r\frac{1-p}{p}\right]\\
    &= r\frac{(1-p)}{p^2}
\end{align*}
$$


<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

- è² ã®äºŒé …åˆ†å¸ƒ $\operatorname{NBin}(r,p)$ ã®æœŸå¾…å€¤ã¨åˆ†æ•£ã¯ï¼Œå¹¾ä½•åˆ†å¸ƒ $\operatorname{Geo}$ ã® $r$ å€ã¨æ€ãˆã°ç†è§£ã—ã‚„ã™ã„ã§ã™

</div>

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: ç©ç‡æ¯é–¢æ•°**
<br>

$X\sim\operatorname{NBin}(r, p)$ ã®ç©ç‡æ¯é–¢æ•°ã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ã›ã‚‹ï¼Œ

$$
M_X(t) = p^r[1 - (1-p)e^t]^{-r} \quad \operatorname{s.t.} \, t < \log\frac{1}{1-p}
$$


:::

</div>

::: {.callout-note collapse="false" icon=false}
## Solution

$$
\begin{align*}
M_X(t)
    &= \mathbb E[\exp(tX)]\\
    &= \sum \exp(tx)\frac{(r-1+x)!}{(r-1)!x!}q^xp^r
\end{align*}
$$

ã“ã®ã¨ãï¼Œ$0 < e^tq < 1$, ã¤ã¾ã‚Šï¼Œ$t < \log(\frac{1}{q})$ ã§ã‚ã‚‹ãªã‚‰ã°

$$
M_X(t) = p^r [1 - e^tq]^{-r}
$$

:::
