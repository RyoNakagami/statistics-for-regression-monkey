---
title: "é›¢æ•£ä¸€æ§˜åˆ†å¸ƒ"
author: "Ryo Nakagami"
date: "2024-09-22"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

## é›¢æ•£ä¸€æ§˜åˆ†å¸ƒã®æ€§è³ª

<div class="blog-custom-border">
<strong>Def: é›¢æ•£ä¸€æ§˜åˆ†å¸ƒ</strong> <br>

$n\in\mathbb N$ ã«å¯¾ã—ã¦ï¼Œç¢ºç‡å¤‰æ•° $X$ ãŒ $S = \{1, 2, \cdots, n\}$ ã‚’æ¨™æœ¬ç©ºé–“ã—ï¼Œ

$$
\Pr(X = k) = \frac{1}{n}\quad k\in S
$$

ã‚’æº€ãŸã™ã¨ãï¼Œ$X$ ã¯é›¢æ•£ä¸€æ§˜åˆ†å¸ƒã«å¾“ã†ã¨ã„ã†ï¼($X\sim \operatorname{DU}(n)$)

</div>

ãƒ•ã‚§ã‚¢ãªã‚µã‚¤ã‚³ãƒ­ã‚’ãµã£ãŸã¨ãã«å‡ºã‚‹ç›®ã‚’ç¢ºç‡å¤‰æ•° $X$ ã¨ã¿ãªã—ãŸã¨ãï¼Œ$X\sim \operatorname{DU}(6)$ ã¨ãªã‚Šã¾ã™ï¼

:::{.callout-note}
## Property: ç´¯ç©åˆ†å¸ƒé–¢æ•°

é›¢æ•£ä¸€æ§˜åˆ†å¸ƒã®ç´¯ç©åˆ†å¸ƒé–¢æ•°(åˆ†å¸ƒé–¢æ•°)ã¯

$$
F(x) = \Pr(X\leq x) = \left\{\begin{array}{c}
0 & x < 1\\
\frac{\lfloor x\rfloor}{n} & 1\leq 1 \leq n\\
1 & x \geq n
\end{array}\right.
$$

:::

é›¢æ•£ä¸€æ§˜åˆ†å¸ƒã®Quantile functionã¯ï¼Œ

$$
Q_X(u) = \inf\{x\in\mathbb R: F_X(x) \geq u\}
$$

ãªã®ã§ï¼Œ$u\in(0, 1]$ ã«ã¤ã„ã¦

$$
Q_X(u) = \lceil np\rceil
$$

ã¨å®šç¾©ã•ã‚Œã¾ã™ï¼

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: æœŸå¾…å€¤ã¨åˆ†æ•£**
<br>

é›¢æ•£ä¸€æ§˜åˆ†å¸ƒã«å¾“ã†ç¢ºç‡å¤‰æ•° $X\sim \operatorname{DU}(n)$ ã«ã¤ã„ã¦ï¼Œ

$$
\begin{align*}
\mathbb E[X] &= \frac{n+1}{2}\\
\operatorname{Var}(X) &= \frac{n^2-1}{2}\\
\end{align*}
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
\mathbb E[X] &= \sum_{k=1}^nk\frac{1}{n} = \frac{n(n+1)}{2n}=\frac{n+1}{2}\\
\end{align*}
$$

åˆ†æ•£ã«ã¤ã„ã¦ã¯

$$
\begin{align*}
\mathbb E[X^2] &= \sum_{k=1}^nk^2\frac{1}{n} = \frac{(n+1)(2n+1)}{6}
\end{align*}
$$

å¾“ã£ã¦ï¼Œ

$$
\operatorname{Var}(X) = \frac{n^2-1}{12}
$$

:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: ç¢ºç‡æ¯é–¢æ•°**
<br>

$X\sim \operatorname{DU}(n)$ ã«ã¤ã„ã¦ï¼Œç¢ºç‡æ¯é–¢æ•° $G_X(s)$ ã¯

$$
G_X(s) = \frac{s(1 - s^n)}{n(1-s)}
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
G_X(s) &= \mathbb E[s^x]\\
       &= \sum_{k=1}^n \frac{s^x}{n}\\
       &= \frac{s(1-s^n)}{n(1-s)}
\end{align*}
$$

:::

<strong > &#9654;&nbsp; ç¢ºç‡æ¯é–¢æ•°ã‚’ç”¨ã„ãŸãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®è¨ˆç®—</strong>

$$
(1-s^n) = (1 - s)(1 + s + s^2 + \cdots + s^{n-1})
$$

ã‚ˆã‚Š

$$
G_X(s) = \frac{s + s^2 + \cdots + s^n}{n}
$$

å¾“ã£ã¦ï¼Œ

$$
\begin{align*}
\mathbb E[X] &= G_X^\prime(s)\bigg\vert_{s=0} \\
             &= \frac{n+1}{2}\\
\mathbb E[X(X-1)] 
    &= G_X^{\prime\prime}(s)\bigg\vert_{s=0}\\ 
    &= \frac{1}{n}\sum_{k=1}^nk(k-1)\\
    &= \frac{(n+1)(2n+1)}{6} - \frac{n+1}{2}
\end{align*}
$$

<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

$X\sim \operatorname{DU}(n)$ ã«ã¤ã„ã¦ï¼ŒMGF $M_X(t)$ ã¯

$$
M_X(t) = \frac{\exp(t) - \exp(t(n+1))}{n(1 - \exp(t))}
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\mathbb E[\exp(tX)] = \frac{1}{n}\sum_{k=1}^n \exp(tk) = \frac{\exp(t) - \exp(t(n+1))}{n(1 - \exp(t))}
$$

:::

<strong > &#9654;&nbsp; ç‰¹æ€§é–¢æ•°</strong>

ç‰¹æ€§é–¢æ•°ã¯

$$
\varphi_X(t) = \frac{\exp(it) - \exp(it(n+1))}{n(1 - \exp(it))}
$$


<strong > &#9654;&nbsp; æ­ªåº¦</strong>

$$
\mathbb E[(X - \mathbb E[X])^3] = (\mathbb E[X^3] â€“ 3\mathbb E[X^2]E[X] + 2\mathbb E[X]^3)
$$

ãªã®ã§ï¼Œã“ã‚Œã‚’ã¾ãšè¨ˆç®—ã—ã¾ã™ï¼

$$
\mathbb E[X^3] = M_X^{\prime\prime\prime}(t) \bigg\vert_{t=0} = n\left(\frac{n+1}{2}\right)^2
$$

ã“ã‚Œã‚’ç”¨ã„ã¦è¨ˆç®—ã™ã‚‹ã¨ï¼Œ$n - 2n-1 + n+1 = 0$ ã‚ˆã‚Š $\operatorname{skewness} = 0$ï¼
å¹³å‡ã‚’ä¸­å¿ƒã«å¯¾ç§°ãªåˆ†å¸ƒãªã®ã§ï¼Œè¨ˆç®—ã—ãªãã¦ã‚‚æ­ªåº¦ã¯0ã§ã‚ã‚‹ã¨åˆ¤æ–­ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼

<strong > &#9654;&nbsp; ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong>

é›¢æ•£ç¢ºç‡å¤‰æ•° $X$ ã®ç¢ºç‡é–¢æ•°ã‚’ $p(x)$ ã¨ã—ã¾ã™ï¼ã“ã®ã¨ãï¼Œã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ï¼

$$
\mathrm{H}(X) = -\sum_x p(x) \log(p(x)) \qquad (\lim_{p\to 0}p\log(p) = 0 \text{ã¨ã™ã‚‹})
$$

$X\sim \operatorname{DU}(n)$ ã¨ã—ãŸã¨ãï¼Œã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯

$$
\begin{align*}
\mathrm{H}(X) = -\frac{1}{n}\sum_x \log(\frac{1}{n}) = \log(n)
\end{align*}
$$

## $k$ å€‹ã®ã‚µã‚¤ã‚³ãƒ­ã®ç›®ã®åˆè¨ˆ

$k$ å€‹ã®ãƒ•ã‚§ã‚¢ãªã‚µã‚¤ã‚³ãƒ­ã®ç›®ã®åˆè¨ˆã®ç¢ºç‡åˆ†å¸ƒã¯ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆæ¯é–¢æ•°ã‚’ç”¨ã„ã¦å°å‡ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ç´¹ä»‹ã—ã¾ã™ï¼

<div class="blog-custom-border">
<strong>Def: é›¢æ•£ç¢ºç‡å¤‰æ•°ã®MGF</strong> <br>

ç¢ºç‡å¤‰æ•° $X$ ãŒé›¢æ•£ç¢ºç‡å¤‰æ•° $\Pr(X = x_i) = p_i, i = 1, \cdots, k$ ã®å ´åˆï¼ŒMGFã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¾ã•ã‚Œã‚‹ï¼š

$$
\begin{align*}
M_X(t)
    &= \mathbb E[\exp(tX)]\\
    &= p_1\exp(tx_1) + p_2\exp(tx_2) + \cdots + p_k\exp(tx_k)
\end{align*}
$$

</div>

ä¸Šè¨˜ã®å®šç¾©ã‚ˆã‚Šï¼Œãƒ•ã‚§ã‚¢ãªã‚µã‚¤ã‚³ãƒ­ã®MGFã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

$$
M_X(t) = \frac{1}{6}\left(\exp(t) + \exp(2t) + \cdots + \exp(6t)\right)
$$

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: äº’ã„ã«ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•°ã®å’Œã¨MGF**
<br>

äº’ã„ã«ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•° $X, Y$ ã«ã¤ã„ã¦ï¼Œ$Z = X +Y$ ã¨ç¢ºç‡å¤‰æ•°ã‚’å®šç¾©ã—ãŸã¨ãï¼Œ

$$
M_Z(t) = M_X(t)M_Y(t)
$$

ãŒæˆç«‹ã™ã‚‹ãƒ»

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
M_Z(t)
    &= \mathbb E[\exp(tZ)]\\
    &= \mathbb E[\exp(tX + tY)]\\
    &= \mathbb E[\exp(tX)\exp(tY)]\\
    &= \mathbb E[\exp(tX)]\mathbb E[\exp(tY)]\\
    &= M_X(t)M_Y(t)
\end{align*}
$$

:::

### $k$ å€‹ã®ã‚µã‚¤ã‚³ãƒ­ã®ç›®ã®åˆè¨ˆã®ç¢ºç‡åˆ†å¸ƒ

$k$ å€‹ã®ãƒ•ã‚§ã‚¢ãªã‚µã‚¤ã‚³ãƒ­ã‚’ç‹¬ç«‹ã«æŠ•ã’ï¼Œãã‚Œãã‚Œã®ç›®ã‚’ $X_1, \cdots, X_k$ ã¨ã—ãŸã¨ãï¼Œã‚µã‚¤ã‚³ãƒ­ã®ç›®ã®åˆè¨ˆ $Y$ ã¯

$$
Y = X_1 + \cdots + X_k
$$

ã“ã®ã¨ãï¼Œä¸Šã§ç¢ºèªã—ãŸMGFã®æ€§è³ªã‚ˆã‚Š

$$
M_Y(t) = \frac{1}{6}(\exp(t)+\exp(2t)+\cdots + \exp(6t))^k
$$


<strong > &#9654;&nbsp; $k=2$ ã®å ´åˆ</strong>

$$
\begin{align*}
M_Y(t)
    =& \frac{1}{6}(\exp(2t) + 2\exp(3t)+3\exp(4t) + 4\exp(5t)\\[4pt]
    &+ 5\exp(6t)+ 6\exp(7t)+ 5\exp(8t)+ 4\exp(9t)+ 3\exp(10t)\\[4pt]
    &+ + 2\exp(11t)+ \exp(12t))
\end{align*}
$$

å„ä¿‚æ•°ãŒç¢ºç‡é–¢æ•°ã«å¯¾å¿œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

<strong > &#9654;&nbsp; $k=4$ ã®å ´åˆ</strong>

åŸºæœ¬çš„ã«ã¯ï¼Œ$Y = \lfloor\mathbb E[X_i] \times 4\rfloor$ ãŒæœ€é »å€¤ã¨ãªã‚‹ã“ã¨ã‚’ç•™æ„ã™ã‚‹ã¨

+----------+----------+----------+-----------+
| $k=1$    |   $k=2$  | $k=3$    | $k=4$     |
+-----+----+-----+----+-----+----+-----+-----+
|value|freq|value|freq|value|freq|value|freq |
+-----+----+-----+----+-----+----+-----+-----+
| $1$ |$1$ | $2$ |$1$ |$3$  |$1$ |$4$  |$1$  |
+-----+----+-----+----+-----+----+-----+-----+
| $2$ |$1$ | $3$ |$2$ |$4$  |$3$ |$5$  |$4$  |
+-----+----+-----+----+-----+----+-----+-----+
| $3$ |$1$ | $4$ |$3$ |$5$  |$6$ |$6$  |$10$ |
+-----+----+-----+----+-----+----+-----+-----+
| $4$ |$1$ | $5$ |$4$ |$6$  |$10$|$7$  |$20$ |
+-----+----+-----+----+-----+----+-----+-----+
| $5$ |$1$ | $6$ |$5$ |$7$  |$15$|$8$  |$35$ |
+-----+----+-----+----+-----+----+-----+-----+
| $6$ |$1$ | $7$ |$6$ |$8$  |$21$|$9$  |$56$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    | $8$ |$5$ |$9$  |$25$|$10$ |$80$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    | $9$ |$4$ |$10$ |$27$|$11$ |$104$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |$10$ |$3$ |$11$ |$27$|$12$ |$125$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |$11$ |$2$ |$12$ |$25$|$13$ |$140$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |$12$ |$1$ |$13$ |$21$|$14$ |$146$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |$14$ |$15$|$15$ |$140$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |$15$ |$10$|$16$ |$125$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |$16$ |$6$ |$17$ |$104$|
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |$17$ |$3$ |$18$ |$80$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |$18$ |$1$ |$19$ |$56$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |     |    |$20$ |$35$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |     |    |$21$ |$20$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |     |    |$22$ |$10$ |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |     |    |$23$ |$4$  |
+-----+----+-----+----+-----+----+-----+-----+
|     |    |     |    |     |    |$24$ |$1$  |
+-----+----+-----+----+-----+----+-----+-----+

<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

- æœ€å°å€¤ã¨æœ€å¤§å€¤ã®é »åº¦ã¯ $1$ ã¨ãªã‚‹
- æœ€é »å€¤ã¯ã¡ã‚‡ã†ã©çœŸã‚“ä¸­ã®å€¤ã¨ãªã‚‹($Y = \lfloor\mathbb E[X_i] \times 4\rfloor$)
- é »åº¦ $f$ ã¯æœ€é »å€¤ã«é”ã™ã‚‹ã¾ã§ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«recursiveã«è¨ˆç®—ã§ãã‚‹

$$
f_k(y) = f_k(y-1) + f_{k-1}(y-1) - f_{k-1}(y-7) 
$$

ä¸Šè¨˜ã«ãŠã„ã¦ï¼Œ$f_{k}(y)$ ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ $0$ ã¨æ‰±ã†


</div>