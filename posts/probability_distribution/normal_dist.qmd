---
title: "æ­£è¦åˆ†å¸ƒ"
author: "Ryo Nakagami"
date: "2024-09-14"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

## æ­£è¦åˆ†å¸ƒã®æ€§è³ª

<div class="blog-custom-border">
<strong>Def: æ­£è¦åˆ†å¸ƒ</strong> <br>

ç¢ºç‡å¤‰æ•° $X$ ãŒå¹³å‡ã¨åˆ†æ•£ $\mu, \sigma^2$ ã‚’ã‚‚ã¤æ­£è¦åˆ†å¸ƒã«å¾“ã†ï¼Œã¤ã¾ã‚Š $X \sim N(\mu, \sigma^2)$ ã®ã¨ãï¼Œ$X$ ã®ç¢ºç‡å¯†åº¦é–¢æ•° $f_X(x)$ ã¯

$$
f_X(x) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}, \quad -\infty<x<\infty
$$


</div>

$X\sim N(\mu, \sigma^2)$ ã«ã¤ã„ã¦ï¼Œæ¨™æº–åŒ–å¤‰æ›(standardization)

$$
Z = \frac{X-\mu}{\sigma}
$$

ã‚’è¡Œã†ã¨ï¼Œå¤‰æ•°å¤‰æ›ã®å…¬å¼ã‚ˆã‚Š

$$
f_Z(z) = \sigma f_X(\sigma z + \mu)=\frac{1}{\sqrt{2\pi}}\exp\left\{-\frac{z^2}{2}\right\}
$$

ã¨ãªã‚Šã¾ã™ï¼$N(0, 1)$ ã®ã“ã¨ã‚’ç‰¹ã«æ¨™æº–æ­£è¦åˆ†å¸ƒã¨ã‚ˆã³ï¼Œãã®pdfã‚’ $\phi(z)$, CDFã‚’ $\Phi(z)$ ã§è¡¨ã—ã¾ã™ï¼

$f_X(x)$ ã®å½¢çŠ¶ã‹ã‚‰ï¼Œlocation parameter $\mu$ ã‚’ä¸­å¿ƒã«å¯¾ç§°ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ï¼ã¤ã¾ã‚Š, $\phi(z)$ ã¯ $z=0$ ã§å¯¾ç§°ã§ã‚ã‚Š

$$
\begin{gather*}
\Phi(0) = \frac{1}{2}\\
\Phi(-z) = 1 - \Phi(z)
\end{gather*}
$$

ãŒã‚ã‹ã‚‹ï¼


<strong > &#9654;&nbsp; $\sigma$ ç¯„å›²</strong>

$X\sim N(\mu, \sigma^2)$ ã¨ã„ã†ç¢ºç‡åˆ†å¸ƒã‚’è€ƒãˆãŸã¨ãï¼Œã‚·ã‚°ãƒç¯„å›²ã®ç›®å®‰ã¨ã—ã¦ä»¥ä¸‹ãŒçŸ¥ã‚‰ã‚Œã¦ã¾ã™

$$
\begin{gather*}
\Pr(\vert X - \mu\vert > \sigma) \approx \frac{1}{3}\\
\Pr(\vert X - \mu\vert > 2\sigma) \approx \frac{1}{20}\\
\Pr(\vert X - \mu\vert > 3\sigma) \approx \frac{3}{1000}\\
\Pr(\vert X - \mu\vert > 4\sigma) \approx \frac{1}{10000}
\end{gather*}
$$

å¤§ä½“ã®ç›®å®‰ã¨ã—ã¦, $3\sigma$ ç¯„å›²ã¯ã„ã‚ã‚†ã‚‹ã€Œåƒä¸‰ã¤ã€ã§ã‚ã‚‹ã“ã¨ã¯è¦šãˆã¨ã„ã¦æã¯ãªã„ã¨æ€ã„ã¾ã™ï¼


<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

$$
\int^\infty_{-\infty}\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}\mathrm{d}x = 1
$$

ãŒæˆç«‹ã™ã‚‹ï¼

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$z = \frac{x-\mu}{\sigma}$ ã¨å¤‰æ•°å¤‰æ›ã‚’ã™ã‚‹ã¨

$$
\int^\infty_{-\infty}\frac{1}{\sqrt{2\pi}}\exp\left\{-\frac{z^2}{2}\right\}\mathrm{d}z = 1
$$

ãŒç¤ºã›ã‚Œã°è‰¯ã„ï¼

$$
I = \int^\infty_{-\infty}\exp\left\{-\frac{z^2}{2}\right\}\mathrm{d}z
$$

ã¨ãŠãã¨ï¼Œ

$$
\begin{align*}
I^2 &= \left(\int^\infty_{-\infty}\exp\left\{-\frac{z^2}{2}\right\}\mathrm{d}z\right)^2\\
    &= \int^\infty_{-\infty}\int^\infty_{-\infty}\exp\left\{-\frac{a^2 + b^2}{2}\right\}\mathrm{d}a\mathrm{d}b
\end{align*}
$$

ã“ã“ã§ï¼Œ$a=r\cos\theta, b= r\sin\theta$ ã¨æ¥µåº§æ¨™å¤‰æ›ã‚’è¡Œã†. ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ $J$ ã¯ 

$$
\begin{align*}
\vert J\vert 
    &= \bigg\vert \frac{\partial a}{\partial r}\frac{\partial b}{\partial \theta} - \frac{\partial a}{\partial \theta}\frac{\partial b}{\partial r}\bigg\vert\\
    &= r
\end{align*}
$$

ã‚ˆã‚Š
$$
\begin{align*}
I^2 &= \int^\infty_{-\infty}\int^\infty_{-\infty}\exp\left\{-\frac{a^2 + b^2}{2}\right\}\mathrm{d}a\mathrm{d}b\\
    &= \int^\infty_{0}\int^{2\pi}_{0}\exp\left\{-\frac{r^2}{2}\right\}r \mathrm{d}\theta\mathrm{d}r\\
    &= 2\pi \int^\infty_{0}\exp\left\{-\frac{r^2}{2}\right\}r \mathrm{d}r\\
    &= 2\pi \left[\exp\left\{-\frac{r^2}{2}\right\}\right]^0_\infty\\
    &= 2\pi
\end{align*}
$$

ä»¥ä¸Šã‚ˆã‚Š, $I = \sqrt{2\pi}$ ã‚’å¾—ã‚‹ï¼

$$
\begin{align*}
\int^\infty_{-\infty}\frac{1}{\sqrt{2\pi}}\exp\left\{-\frac{z^2}{2}\right\}\mathrm{d}z
    &= \frac{1}{\sqrt{2\pi}}I\\
    &= 1
\end{align*}
$$


:::


<strong > &#9654;&nbsp; äºŒé …åˆ†å¸ƒã®æ¥µé™åˆ†å¸ƒã¨ã—ã¦ã®æ­£è¦åˆ†å¸ƒ</strong>

$n$ ã‚’æ­£ã®æ•´æ•°ã¨ã—ã¦ï¼Œ$Y_n \sim \operatorname{Binom}(n, 1/2)$ ã¨ã—ï¼Œ

$$
X_n = \frac{Y_n - n/2}{\sqrt{n}/2}
$$

ã¨ã„ã†ç¢ºç‡å¤‰æ•°ã‚’è€ƒãˆã¾ã™ï¼$X_n \in (x - 2/\sqrt{n}, x]$ ã¨ãªã‚‹ã‚ˆã†ãªç¢ºç‡ã‚’è€ƒãˆã¦ã¿ã‚‹ã¨

$$
\begin{align*}
&\Pr(x - 2/\sqrt{n} < X_n \leq x)\\
    &= \Pr\left(\frac{\sqrt{n}}{2}x + \frac{n}{2} - 1 < Y_n \leq \frac{\sqrt{n}}{2}x + \frac{n}{2}\right)\\
    &= \Pr\bigg(\bigg\lfloor Y_n = \frac{\sqrt{n}}{2}x + \frac{n}{2}\bigg\rfloor\bigg)\\
    &= \frac{n!}{\bigg\lfloor \frac{\sqrt{n}}{2}x + \frac{n}{2}\bigg\rfloor ! \bigg\lceil -\frac{\sqrt{n}}{2}x + \frac{n}{2}\bigg\rceil !}\left(\frac{1}{2}\right)^n
\end{align*}
$$


ã“ã“ã§ã‚¹ã‚¿ãƒ¼ãƒªãƒ³ã‚°ã®å…¬å¼ã‚ˆã‚Šååˆ†å¤§ãã„æ­£ã®æ•´æ•° $m$ ã«ã¤ã„ã¦

$$
m! \approx \sqrt{2\pi m} m^m\exp(-m)
$$

ã¨è¿‘ä¼¼ã§ãã‚‹ã®ã§

$$
\begin{align*}
&\lim_{n\to\infty}\Pr(x - 2/\sqrt{n} < X_n \leq x)\\
    &= \lim_{n\to\infty}\frac{n!}{\bigg\lfloor \frac{\sqrt{n}}{2}x + \frac{n}{2}\bigg\rfloor ! \bigg\lceil -\frac{\sqrt{n}}{2}x + \frac{n}{2}\bigg\rceil !}\left(\frac{1}{2}\right)^n\\
    &= \lim_{n\to\infty} \frac{1}{\sqrt{2\pi\left(\frac{n}{4}-\frac{x^2}{4}\right)}\left(1 - \frac{x^2}{n}\right)^{\frac{n}{2}}\left(1 + \frac{x}{\sqrt{n}}\right)^{\frac{\sqrt{n}}{2}x}\left(1 - \frac{x}{\sqrt{n}}\right)^{-\frac{\sqrt{n}}{2}x}}\left(\frac{1}{2}\right)^n\\
    &= \frac{1}{\sqrt{2\pi}\exp(-x^2/2)\exp(x^2/2)\exp(x^2/2)}\\
    &=\frac{1}{\sqrt{2\pi}}\exp(-x^2/2)\\[8pt]
    &= \phi(x)
\end{align*}
$$

$$\tag*{\(\blacksquare\)}$$


<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

æ¨™æº–æ­£è¦åˆ†å¸ƒã®ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’ $\phi(x)$ ã¨ã™ã‚‹ã¨ãï¼Œ

$$
\begin{gather*}
\int_\mathbb R x\phi(x) \mathrm{d}x = 0\\
\int_\mathbb R x^2\phi(x) \mathrm{d}x = 1\\
\end{gather*}
$$

ãŒæˆç«‹ã™ã‚‹ï¼

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$\phi(x)$ ãŒå¶é–¢æ•°ï¼Œ$x$ ãŒå¥‡é–¢æ•°ã‚ˆã‚Š, $x\phi(x)$ ã¯å¥‡é–¢æ•°ã«ãªã‚‹ï¼å¾“ã£ã¦ï¼Œ

$$
\int_\mathbb R x\phi(x) \mathrm{d}x = 0
$$

2æ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦ã¯

$$
\begin{align*}
\int_\mathbb R x^2\phi(x) \mathrm{d}x
    &=  2\int_0^\infty x^2\phi(x) \mathrm{d}x\\
    &= 2[-x\exp(-x^2/2)]^\infty_0 + 2\int^\infty_0 \phi(x) \mathrm{d}x\\
    &= 0 + 2 \times \frac{1}{2}\\
    &= 1
\end{align*}
$$


:::

::: {#exm- .custom_problem }
**: æ¨™æº–æ­£è¦åˆ†å¸ƒã®4æ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®å°å‡º**
<br>

$X\sim N(0, 1)$ ã®4æ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦ï¼Œã‚¬ãƒ³ãƒé–¢æ•° $\Gamma(1/2) = \sqrt{\pi}$ ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¨ˆç®—ã§ãã¾ã™ï¼

$$
\begin{align*}
\mathbb E[X^4]
    &= \frac{1}{\sqrt{2\pi}}\int^\infty_{-\infty}x^4\exp\left(-\frac{x^2}{2}\right)\mathrm{d}x\\
    &= \frac{2}{\sqrt{2\pi}}\int^\infty_{0}x^4\exp\left(-\frac{x^2}{2}\right)\mathrm{d}x \quad\because \text{å¶é–¢æ•°ã‚ˆã‚Š}
\end{align*}
$$

ã“ã“ã§, $x^2 = u$ ã¨ã„ã†å¤‰æ•°å¤‰æ›ã‚’è¡Œã†ï¼

$$
\begin{align*}
\frac{2}{\sqrt{2\pi}}\int^\infty_{0}x^4\exp\left(-\frac{x^2}{2}\right)\mathrm{d}x 
    &= \frac{2}{\sqrt{2\pi}}\int^\infty_{0}u^2 \exp\left(-\frac{u}{2}\right)\frac{u^{-1/2}}{2}\mathrm{d}u\\
    &= \frac{1}{\sqrt{2\pi}}\int^\infty_{0}u^{\frac{5}{2}-1} \exp\left(-\frac{u}{2}\right)\mathrm{d}u\\
    &= \frac{1}{\sqrt{2\pi}} \Gamma\left(\frac{5}{2}\right)\left(\frac{1}{2}\right)^{-5/2}\\
    &= \frac{\sqrt{\pi} \frac{1}{2}\frac{3}{2}}{\sqrt{2\pi}}2^{5/2}\\\\
    &= 3
\end{align*}
$$

$$\tag*{\(\blacksquare\)}$$

:::

<strong > &#9654;&nbsp; æ¨™æº–æ­£è¦åˆ†å¸ƒã®næ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦</strong>

æ¨™æº–æ­£è¦åˆ†å¸ƒã«ã¤ã„ã¦ï¼Œ$\phi(z)$ ãŒå¶é–¢æ•°ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ï¼Œ$n$ ãŒå¥‡æ•°ã®ã¨ãã¯

$$
\mathbb E[X^n] = 0
$$

ã§ã‚ã‚‹ã“ã¨ã¯ã™ãã«åˆ†ã‹ã‚Šã¾ã™ï¼ä¸€æ–¹ï¼Œ$l$ ã‚’è‡ªç„¶æ•°ã¨ã—ã¦, $n=2l$ ã¨è¡¨ã›ã‚‹ã¨ãã¯

$$
\begin{align*}
\mathbb E[X^n] &= \frac{1}{\sqrt{2\pi}}\int^{\infty}_{-\infty}x^n\exp\bigg(-\frac{x^2}{2}\bigg)\mathrm{d}x\\[3pt]
               &= \frac{2}{\sqrt{2\pi}}\int^{\infty}_{0}x^{2l}\exp\bigg(-\frac{x^2}{2}\bigg)\mathrm{d}x\\[3pt]
\end{align*}
$$

$x^2/2 = u$ ã¨å¤‰æ•°å¤‰æ›ã‚’è¡Œã†ã¨ï¼Œ$\frac{\mathrm{d}x}{\mathrm{d}u}=\frac{1}{\sqrt{2u}}$ ã‚ˆã‚Š

$$
\begin{align*}
\mathbb E[X^n] &= \frac{2^{l+1}}{\sqrt{2\pi}}\int^{\infty}_{0}u^{l}\exp(-u)\frac{1}{\sqrt{2u}}\mathrm{d}u\\[3pt]
               &= \frac{2^l}{\sqrt{\pi}}\int^{\infty}_{0}u^{l-\frac{1}{2}}\exp(-u)\mathrm{d}u\\[3pt]
               &= \frac{2^l}{\sqrt{\pi}}\int^{\infty}_{0}u^{l+\frac{1}{2}-1}\exp(-u)\mathrm{d}u\\[3pt]
               &= \frac{2^l}{\sqrt{\pi}}\Gamma\bigg(l+\frac{1}{2}\bigg)
\end{align*}
$$

$\Gamma(1/2) = \sqrt{\pi}$ ã§ã‚ã‚‹ã“ã¨ã«ç•™æ„ã™ã‚‹ã¨

$$
\begin{align*}
\Gamma\left(\frac{3}{2}\right) &= \frac{1}{2}\Gamma\left(\frac{1}{2}\right)\\
\Gamma\left(\frac{5}{2}\right) &= \frac{3}{2}\Gamma\left(\frac{3}{2}\right)\\
                               &= \frac{1 \times 3}{2^2}\sqrt{\pi}
\end{align*}
$$

ã«ãªã‚‹ã®ã§

$$
\begin{align*}
\mathbb E[X^n] 
    &= 1\times 3\times 5\times\cdots\times (2l-1)\\
    &= \prod_{i=1}^l(2i-1)           
\end{align*}
$$

ã¾ãŸã¯ã“ã‚Œã‚’å¤‰å½¢ã—ã¦ï¼Œ

$$
\frac{1}{2l!}\mathbb E[X^{2l}] = \prod^l_{k=1}\frac{1}{2k}
$$

ã¨è¡¨ã™ã“ã¨ã‚‚ã§ãã¾ã™ï¼


### MGFã¨ç‰¹æ€§é–¢æ•°

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: æ¨™æº–æ­£è¦åˆ†å¸ƒã®ç©ç‡æ¯é–¢æ•°ã¨ç‰¹æ€§é–¢æ•°**
<br>

$X\sim N(0, 1)$ ã¨ã—ãŸã¨ãï¼Œç©ç‡æ¯é–¢æ•° $M_Z(t)$ åŠã³ï¼Œç‰¹æ€§é–¢æ•° $\varphi_Z(t)$ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹

$$
\begin{align*}
M_Z(t) &= \exp(t^2/2)\\
\varphi_Z(t)&= \exp(-t^2/2)
\end{align*}
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
M_Z(t)
    &= \mathbb E[\exp(tZ)]\\
    &= \frac{1}{\sqrt{2\pi}}\int^\infty_{-\infty}\exp(tz-z^2/2)\mathrm{d}z\\
    &= \exp(t^2/2)\frac{1}{\sqrt{2\pi}}\int^\infty_{-\infty}\exp(-(t-z)^2/2)\mathrm{d}z\\
    &= \exp(t^2/2)
\end{align*}
$$

ç‰¹æ€§é–¢æ•°ã¯ $\varphi(t) = M_Z(it)$ ã‚ˆã‚Š $\varphi(t) = \exp(-t^2/2)$ ã¨ã‚ã‹ã‚‹ãŒï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«è¨ˆç®—ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ï¼

$$
\begin{align*}
\varphi_Z(t)
    &= \mathbb E[\exp(itZ)]\\[5pt]
    &= \mathbb E[\cos(tZ) + i\sin(tZ)]\\[5pt]
    &= \mathbb E[\cos(tZ)] + i\mathbb E[\sin(tZ)]\\[5pt]
    &= \int^\infty_{-\infty}\cos(tz)\phi(z)\mathrm{d}z + i\int^\infty_{-\infty}\sin(tz)\phi(z)\mathrm{d}z\\[5pt]
    &= \int^\infty_{-\infty}\cos(tz)\phi(z)\mathrm{d}z \quad \because\text{å¥‡é–¢æ•°}
\end{align*}
$$

æ¬¡ã«ï¼Œ$t$ ã«ã¤ã„ã¦ $\varphi_Z(t)$ ã‚’å¾®åˆ†ã™ã‚‹ã¨

$$
\begin{align*}
\frac{\mathrm{d}}{\mathrm{d}t}\varphi_Z(t)
    &= \frac{\mathrm{d}}{\mathrm{d}t}\mathbb E[\exp(itZ)]\\[5pt]
    &= \mathbb E\left[\frac{\mathrm{d}}{\mathrm{d}t}\exp(itZ)\right] \because\text{æœŸå¾…å€¤ã¨å¾®åˆ†ã®é †åºäº¤æ›æ€§}\\[5pt]
    &= i\mathbb E\left[Z\exp(itZ)\right]\\
    &= -\int^\infty_{-\infty}z\sin(tz)\phi(z)\mathrm{d}z
\end{align*}
$$

ã“ã®ã¨ãï¼Œ

$$
\frac{\mathrm{d}}{\mathrm{z}}\phi(z) = -z\phi(z)
$$

ã§ã‚ã‚‹ã®ã§

$$
\begin{align*}
-\int^\infty_{-\infty}z\sin(tz)\phi(z)\mathrm{d}z
    &= [\sin(tz)\phi(z)]^\infty_{-\infty} - \int^\infty_{-\infty}t\cos(tz)\phi(z)\mathrm{d}z\\
    &= - \int^\infty_{-\infty}t\cos(tz)\phi(z)\mathrm{d}z\\
    &= -t\varphi_Z(t)
\end{align*}
$$

$$
\frac{\mathrm{d}}{\mathrm{d}t}\varphi_Z(t)=-t\varphi_Z(t)
$$

$\varphi_Z(0) = 1$ ã‚ˆã‚Šï¼Œ

$$
\varphi_Z(t) = \exp(-t^2/2)
$$


:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: MGF of non-standard normal distribution**
<br>

$X \sim N(\mu, \sigma^2)$ ã®ç©ç‡æ¯é–¢æ•°ãŠã‚ˆã³ç‰¹æ€§é–¢æ•°ã¯

$$
\begin{align*}
M_X(t) &= \exp\left(\mu t + \frac{1}{2}\sigma^2t^2\right)\\
\varphi_X(t) &= \exp\left(i\mu t-\frac{t^2\sigma^2}{2}\right)
\end{align*}
$$
:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$Z\sim N(0, 1)$ ã¨ã™ã‚‹ã¨ï¼Œ$Z = \sigma Z + \mu$ ã¨è¡¨ã›ã‚‹ã®ã§ï¼Œ

$$
\begin{align*}
M_X(t) &= \mathbb E[\exp(t(\sigma Z + \mu))]\\[5pt]
       &= \exp(t\mu) \mathbb E[\exp(t\sigma Z)]\\[5pt]
       &= \exp(t\mu)\exp\left(\frac{1}{2}t^2\sigma^2\right)\\
       &=  \exp\left(\mu t + \frac{1}{2}\sigma^2t^2\right)
\end{align*}
$$

åŒæ§˜ã«

$$
\begin{align*}
\varphi_X(t) 
    &= \mathbb E[\exp(it(\sigma z + \mu))]\\[5pt]
    &= \exp(it\mu) \mathbb E[\exp(it\sigma z)]\\[5pt]
    &= \exp\left(i\mu t-\frac{t^2\sigma^2}{2}\right)
\end{align*}
$$


:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

$X\sim N(\mu, \sigma^2)$ ã¨ã™ã‚‹ï¼å®šæ•° $a, b$ ã«å¯¾ã—ã¦

$$
Y = aX + b
$$

ã¨ã—ãŸã¨ãï¼Œ$Y\sim N(a\mu + b, a^2\sigma^2)$ ã¨ãªã‚‹ï¼

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$N(a\mu + b, a^2\sigma^2)$ ã«å¾“ã†ç¢ºç‡å¤‰æ•°ã®ç‰¹æ€§é–¢æ•°ã¯

$$
\varphi(t) = \exp\left[(a\mu + b)it - \frac{a^2\sigma^2t^2 }{2}\right]
$$

ãªã®ã§ï¼Œ$Y$ ã®ç‰¹æ€§é–¢æ•°ãŒã“ã‚Œã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¤ºã›ã°è‰¯ã„ï¼

$$
\begin{align*}
\varphi_Y(t)
    &= \mathbb E\left[\exp(itY)\right]\\[5pt]
    &= \mathbb E\left[\exp(it(aX + b))\right]\\[5pt]
    &= \exp(itb)\exp\left(i a\mu t - \frac{a^2\sigma^2t^2}{2}\right)\\
    &=  \exp\left[(a\mu + b)it - \frac{a^2\sigma^2t^2 }{2}\right]
\end{align*}
$$

:::

### æ­£è¦åˆ†å¸ƒã®å†ç”Ÿæ€§

<div class="blog-custom-border">
<strong>Def: ç¢ºç‡åˆ†å¸ƒã®å†ç”Ÿæ€§</strong> <br>

ç¢ºç‡åˆ†å¸ƒ $F$ ã«ã¤ã„ã¦ï¼Œ2 ã¤ã®ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•° $X, Y$  ãŒ $F$ ã«å¾“ã†ã¨ã™ã‚‹ï¼ã“ã®ã¨ãï¼Œ

$$
\begin{align*}
Z &= X + Y\\
Z& \sim F
\end{align*}
$$

ãŒæˆç«‹ã™ã‚‹ã¨ãï¼Œç¢ºç‡åˆ†å¸ƒ $F$ ã¯å†ç”Ÿæ€§ã‚’ã‚‚ã¤ã¨ã„ã†ï¼

</div>

äºŒé …åˆ†å¸ƒï¼Œè² ã®äºŒé …åˆ†å¸ƒï¼Œãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒï¼Œæ­£è¦åˆ†å¸ƒãªã©ã¯ï¼Œå†ç”Ÿæ€§ã‚’æŒã¤ã“ã¨ãŒã—ã‚‰ã‚Œã¦ã„ã¾ã™ï¼

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: æ­£è¦åˆ†å¸ƒã®å†ç”Ÿæ€§**
<br>

æ­£è¦åˆ†å¸ƒã¯ï¼Œlocation parameter, scale parameterä¸¡æ–¹ã«ã¤ã„ã¦å†ç”Ÿæ€§ã‚’æŒã¤ï¼ã¤ã¾ã‚Šï¼Œ

$$
\begin{align*}
&X \sim N(\mu_x, \sigma^2_x), Y \sim N(\mu_y, \sigma^2_y)\\
\Rightarrow& X +Y \sim N(\mu_x+\mu_y, \sigma^2_x + \sigma^2_y) 
\end{align*}
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof: MGFã‚’ç”¨ã„ãŸè¨¼æ˜

ç¢ºç‡å¤‰æ•° $X, Y$ ã¯ç‹¬ç«‹ãªã®ã§

$$
\begin{align*}
M_{X+Y}(t)
    &= M_{X}(t) M_{Y}(t)\\
    &= \exp\left(\mu_xt + \frac{\sigma^2_xt}{2}\right)\exp\left(\mu_yt + \frac{\sigma^2_yt}{2}\right)\\
    &= \exp\left((\mu_x + \mu_y)t + \frac{(\sigma^2_x + \sigma^2_y)t}{2}\right)
\end{align*}
$$

$X+Y$ ã®MGFãŒ $N(\mu_x + \mu_y, \sigma^2_x + \sigma^2_y)$ ã®MGFã¨ä¸€è‡´ã™ã‚‹ã®ã§ 

$$
X+Y\sim N(\mu_x + \mu_y, \sigma^2_x + \sigma^2_y)
$$

:::

::: {.callout-note collapse="false" icon=false}
##  Proof: ç•³ã¿è¾¼ã¿ã‚’ç”¨ã„ãŸè¨¼æ˜

ç¢ºç‡å¤‰æ•° $X, Y$ ã®ãã‚Œãã‚Œã®å¯†åº¦é–¢æ•°ã‚’ $f_X(x), f_Y(y)$ ã§è¡¨ã—ãŸã¨ãï¼Œ$Z =X+Y$ ã®ç¢ºç‡å¯†åº¦é–¢æ•° $p(z)$ ã¯ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚Šä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã›ã¾ã™ï¼

$$
p(z) = \int^\infty_{-\infty} f_X(x)f_Y(z-x)\mathrm{d}x
$$

å¾“ã£ã¦ï¼Œ

$$
\begin{align*}
p(z)
    &= \frac{1}{2\pi\sigma_X\sigma_Y}\int^\infty_{-\infty}\exp\left(-\frac{(x -\mu_x)^2}{2\sigma_X^2}-\frac{((z-x) -\mu_y)^2}{2\sigma_Y^2}\right)\mathrm{d}x
\end{align*}
$$

ã“ã“ã§ï¼Œæœ€çµ‚é …ã®æŒ‡æ•°éƒ¨åˆ†ã«ã¤ã„ã¦ï¼Œ$x$ ã«ã¤ã„ã¦ã¾ã¨ã‚ã‚‹ã¨ 

$$
\begin{align*}
&-\frac{(x -\mu_x)^2}{2\sigma_X^2}-\frac{((z-x) -\mu_y)^2}{2\sigma_Y^2}\\
    &= -\frac{\sigma_x^2 + \sigma_y^2}{2\sigma_x^2\sigma_y^2}\left(x - \frac{z\sigma_x^2 -\mu_x\sigma_y^2 + \mu_y\sigma_x^2}{\sigma_x^2 + \sigma_y^2}\right)^2 - \frac{(z - (\mu_x+\mu_y))^2}{2(\sigma_x^2 + \sigma_y^2)}
\end{align*}
$$

ã“ã“ã§ã‚¬ã‚¦ã‚¹ç©åˆ†ã‚ˆã‚Šï¼Œ

$$
\int^\infty_{-\infty}\exp\left(-\frac{\sigma_x^2 + \sigma_y^2}{2\sigma_x^2\sigma_y^2}\left(x - C\right)^2 \right)\mathrm{d}x = \sqrt{\frac{2\pi\sigma_x^2\sigma_y^2}{\sigma_x^2 + \sigma_y^2}}
$$

ä»¥ä¸Šã‚ˆã‚Šï¼Œ

$$
p(z) = \frac{1}{\sqrt{2\pi\sigma_x^2\sigma^2_y}}\exp\left(-\frac{(z - (\mu_x+\mu_y))^2}{2(\sigma_x^2 + \sigma_y^2)}\right)
$$

ã“ã‚Œã¯ï¼Œ$N(\mu_x + \mu_y, \sigma^2_x + \sigma^2_y)$ ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã¨ä¸€è‡´ã™ã‚‹ã®ã§ï¼Œ

$$
X+Y\sim N(\mu_x + \mu_y, \sigma^2_x + \sigma^2_y)
$$

:::

### Differential Entropy

<div class="blog-custom-border">
<strong>Def: å¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong> <br>

é€£ç¶šç¢ºç‡å¤‰æ•° $X$ ã«ã¤ã„ã¦ï¼Œç¢ºç‡å¯†åº¦é–¢æ•°ãŒ $p(x)$ ã§ä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨ã™ã‚‹ï¼ã“ã®ã¨ãï¼Œå¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯ä»¥ä¸‹ã®å½¢ã§å®šç¾©ã•ã‚Œã‚‹

$$
\mathrm{H}(X) = - \int_{\mathcal{X}} p(x) \log_b p(x) \, \mathrm{d}x
$$

ãªãŠï¼Œ$b$ ã¯é€šå¸¸ $2, e$ ãŒç”¨ã„ã‚‰ã‚Œã‚‹

</div>

å¹³å‡ $\mu$, åˆ†æ•£ $\sigma^2$ ã‚’ã‚‚ã¤ç¢ºç‡åˆ†å¸ƒã®ã†ã¡ï¼Œæ­£è¦åˆ†å¸ƒã¯å¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æœ€å¤§ã«ã™ã‚‹åˆ†å¸ƒã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼

<strong > &#9654;&nbsp; $N(\mu, \sigma^2)$ ã®å¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong>

$N(\mu, \sigma^2)$ ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’ $f(x)$ ã¨ã—ã¦ï¼Œå¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®å®šç¾©ã‚ˆã‚Š

$$
\begin{align*}
\mathrm{H}
    &= - \int_{-\infty}^\infty f(x) \log_2 f(x) \, \mathrm{d}x\\
    &= - \int_{-\infty}^\infty f(x) \log_2 \left(\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)\right) \, \mathrm{d}x\\
    &= \frac{\log_2(2\pi\sigma^2)}{2}\int_{-\infty}^\infty f(x)\mathrm{d}x + \frac{\log_2 e}{2\sigma^2} \int_{-\infty}^\infty (x-\mu)^2f(x)\mathrm{d}x\\
    &= \frac{1}{2}\log_2(2\pi e\sigma^2)
\end{align*}
$$


ãªãŠï¼Œè‡ªç„¶å¯¾æ•°ã§è¡¨ç¾ã™ã‚‹å ´åˆï¼Œ$\mathrm{H} = \frac{1}{2}[1 + \ln(2\pi\sigma^2)]$


$$\tag*{\(\blacksquare\)}$$

<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

å¹³å‡ $\mu$, åˆ†æ•£ $\sigma^2$ ã‚’ã‚‚ã¤ç¢ºç‡åˆ†å¸ƒã®ã†ã¡ï¼Œæ­£è¦åˆ†å¸ƒã¯å¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æœ€å¤§ã«ã™ã‚‹åˆ†å¸ƒã§ã‚ã‚‹ï¼

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof: ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¿‚æ•°æ³•

ï¼ˆæ³¨æ„: åˆ¶ç´„ä»˜ãæœ€å¤§åŒ–å•é¡Œã‚’è§£ãã«ã‚ãŸã£ã¦ï¼Œãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¿‚æ•°æ³•ãŒä½¿ç”¨ã§ãã‚‹ã¨ä»®å®šã—ã¦ã¾ã™ï¼‰

<strong > &#9654;&nbsp; æ±é–¢æ•°ã®å®šç¾©</strong>

$$
\begin{align*}
&F(p(x), \lambda_1, \lambda_2, \lambda_3)\\
&= -\int^\infty_{-\infty}p(x)\ln(p(x))\,\mathrm{d}x + \lambda_1\left[\int^\infty_{-\infty}p(x)\,\mathrm{d}x-1\right]\\
&\qquad+\lambda_2\int^\infty_{-\infty}(x-\mu)p(x)\,\mathrm{d}x + \lambda_3\left[\int^\infty_{-\infty}(x-\mu)^2p(x)\,\mathrm{d}x-\sigma^2\right]\\
\end{align*}
$$

<strong > &#9654;&nbsp; æ¥µå€¤æ¡ä»¶ã®è¨ˆç®—</strong>

<div class="math display" style="overflow: auto">
$$
\begin{align*}
\frac{\partial F}{\partial p(x)} &= -\int^\infty_{-\infty}(1 + \ln(p(x)) - \lambda_1 - \lambda_2(x-\mu) - \lambda_3(x-\mu)^2)\,\mathrm{d}x = 0\tag{A}\\
\frac{\partial F}{\partial \lambda_1} &= \int^\infty_{-\infty}p(x)\,\mathrm{d}x-1 = 0\tag{B}\\
\frac{\partial F}{\partial \lambda_2} &= \int^\infty_{-\infty}(x-\mu)p(x)\,\mathrm{d}x\int^\infty_{-\infty}(x-\mu)p(x)\,\mathrm{d}x = 0\tag{C}\\
\frac{\partial F}{\partial \lambda_3} &= \int^\infty_{-\infty}(x-\mu)^2p(x)\,\mathrm{d}x-\sigma^2= 0\tag{D}
\end{align*}
$$
</div>

<strong > &#9654;&nbsp; æ¡ä»¶(A)ã®æ•´ç†</strong>

æ¡ä»¶ $\mathrm{(A)}$ ã‚ˆã‚Šä»¥ä¸‹ã‚’å¾—ã‚‹

<div class="math display" style="overflow: auto">
$$
p(x) = \exp(-1+\lambda_1 + \lambda_2(x-\mu)+ \lambda_3(x-\mu)^2)\tag{E}
$$
</div>

ãªãŠæ‰±ã„ã‚„ã™ã„ã‚ˆã†ã« $z = x - \mu$ ã¨ã—ã¦ä»¥ä¸‹ã®å½¢ã§è¡¨ã™ï¼

<div class="math display" style="overflow: auto">
$$
p(x) = \exp(-1+\lambda_1 + \lambda_2z+ \lambda_3z^2)\tag{E'}
$$
</div>

<strong > &#9654;&nbsp; $\lambda_1$ ã®æ¶ˆå»</strong>

$\mathrm{(E')}$ ã‚’ $\mathrm{(B)}$ ã«ä»£å…¥ã™ã‚‹ã¨ï¼Œ$\frac{\,\mathrm{d}x}{\,\mathrm{d}z}=1$ ã‚ˆã‚Š

$$
\begin{align*}
&\int^\infty_{-\infty}\exp(-1 + \lambda_1 + + \lambda_2z+ \lambda_3z^2)\,\mathrm{d}z\\
&=\exp(-1+\lambda_1)\exp\left(-\frac{\lambda^2}{4\lambda_3}\right) \int^\infty_{-\infty}\exp\left(\lambda_3\left(z + \frac{\lambda_2}{2\lambda_3}\right)^2\right)\,\mathrm{d}z\\
&=1
\end{align*}
$$

ã“ã®ã¨ãï¼Œç­‰å·ãŒæˆç«‹ã™ã‚‹ãŸã‚ã«ã¯ $\lambda_3 < 0$ ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ï¼ã¾ãŸï¼Œã‚¬ã‚¦ã‚¹ç©åˆ†ã‚ˆã‚Š

<div class="math display" style="overflow: auto">
$$
\int^\infty_{-\infty}\exp\left(\lambda_3\left(z + \frac{\lambda_2}{2\lambda_3}\right)^2\right)\,\mathrm{d}z = \frac{\sqrt{\pi}}{\sqrt{-\lambda_3}}\tag{F}
$$
</div>

å¾“ã£ã¦ï¼Œ

<div class="math display" style="overflow: auto">
$$
p(x) =  \frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\exp\left(\lambda_3\left(z + \frac{\lambda_2}{2\lambda_3}\right)^2\right)\tag{G}
$$
</div>


<strong > &#9654;&nbsp; $\lambda_2$ ã®æ¶ˆå»</strong>

$\mathrm{(G)}$ ã¨ $\mathrm{(C)}$ ã‚ˆã‚Š

<div class="math display" style="overflow: auto">
$$
 \frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\int^\infty_{-\infty}z\exp\left(\lambda_3\left(z + \frac{\lambda_2}{2\lambda_3}\right)^2\right)\,\mathrm{d}z = 0\tag{H} 
$$
</div>

$\mathrm{(H)} = 0$ ãŒæˆç«‹ã™ã‚‹ãŸã‚ã«ã¯ï¼Œ$\exp\left(\lambda_3\left(z + \frac{\lambda_2}{2\lambda_3}\right)^2\right)$ ãŒå¶é–¢æ•°ã«ãªã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§

$$
\begin{gather*}
\frac{\lambda_2}{2\lambda_3} = 0\\
\Rightarrow \lambda_2 = 0
\end{gather*}
$$

å¾“ã£ã¦ï¼Œ

<div class="math display" style="overflow: auto">
$$
p(x) = \frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\exp\left(\lambda_3z^2\right)\tag{I}
$$
</div>

<strong > &#9654;&nbsp; $\lambda_3$ ã®æ¶ˆå»</strong>

$\mathrm{(I)}, \mathrm{(D)}$ ã‚’æ•´ç†ã™ã‚‹ã¨

$$
\begin{align*}
\frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\int^\infty_{-\infty} z^2\exp\left(\lambda_3z^2\right)\,\mathrm{d}z = \sigma^2
\end{align*}
$$

$\int^\infty_{-\infty}x^2\exp(-ax^2)\mathrm{d}x = \frac{\sqrt{\pi}}{2a\sqrt{a}}$ ã‚ˆã‚Š

$$
\begin{align*}
\frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\int^\infty_{-\infty} z^2\exp\left(\lambda_3z^2\right)\,\mathrm{d}z
    &= \frac{\sqrt{-\lambda_3}}{\sqrt{\pi}}\frac{\sqrt{\pi}}{-2\lambda_3\sqrt{-\lambda_3}}\\
    &= \frac{1}{-2\lambda_3} 
\end{align*}
$$

å¾“ã£ã¦ï¼Œ

$$
\lambda_3 = -\frac{1}{2\sigma^2}
$$

ä»¥ä¸Šã‚ˆã‚Š, å¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æœ€å¤§åŒ–ã™ã‚‹ $p^*(x)$ ã¯

$$
p^*(x) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
$$

ã¨ãªã‚Šï¼Œæ­£è¦åˆ†å¸ƒã¨ãªã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ï¼

:::

<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

- $\lambda_2 = 0$ ã‚ˆã‚Š location paramter $\mu$ ã‚’å¤‰åŒ–ã•ã›ã¦ã‚‚ï¼Œå¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯é™ç•Œçš„ã«ã¯å¢—ãˆãªã„ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™
- $\lambda_3 < 0$ ã‚ˆã‚Š scale paramter $\sigma^2$ ã‚’å¢—å¤§ã•ã›ã‚‹ã¨ï¼Œå¾®åˆ†ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯é™ç•Œçš„ã«å¢—å¤§ã™ã‚‹ã“ã¨ã‚‚åˆ†ã‹ã‚Šã¾ã™

</div>