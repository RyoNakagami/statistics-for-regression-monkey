---
title: "æ¯é–¢æ•°"
author: "Ryo Nakagami"
date: "2024-09-22"
date-modified: last-modified
number_sections: false
code-fold: true
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
jupyter: python3
---

ç¢ºç‡åˆ†å¸ƒã‚’ç‰¹å¾´ã¥ã‘ã‚‹é–¢æ•°ã¨ã—ã¦æ¯é–¢æ•°ã¨ã„ã†é–¢æ•°ãŒã‚ã‚Šã¾ã™ï¼æ¯é–¢æ•°ã«ã¯ç¢ºç‡æ¯é–¢æ•°ï¼Œç©ç‡æ¯é–¢æ•°ï¼Œç‰¹æ€§é–¢æ•°ï¼Œã‚­ãƒ¥ãƒ ãƒ©ãƒ³ãƒˆæ¯é–¢æ•°ã¨ã„ã†ç¨®é¡ãŒã‚ã‚Šã¾ã™ï¼
è©³ã—ãã¯å¾Œã»ã©èª¬æ˜ã—ã¾ã™ãŒï¼Œæ¯é–¢æ•°ã¯å…¨ã¦ã®ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®æƒ…å ±ã‚’å«ã‚“ã§ã„ã‚‹ã®ã§

- ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®è¨ˆç®—ãŒç°¡å˜ã«ãªã‚‹
- æ¯é–¢æ•°ãŒä¸€è‡´ã™ã‚‹ï¼’ã¤ã®åˆ†å¸ƒã¯åŒã˜ã‚‚ã®ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹

ã¨ã„ã†æ•°ç†çµ±è¨ˆå­¦ä¸Šä¾¿åˆ©ãªæ€§è³ªã‚’æ¯é–¢æ•°ã¯æŒã£ã¦ã„ã¾ã™ï¼

## ç¢ºç‡æ¯é–¢æ•°

<div class="blog-custom-border">
<strong>Def: ç¢ºç‡æ¯é–¢æ•°(probability generating function)</strong> <br>

ç¢ºç‡å¤‰æ•° $X$ ã®æ¨™æœ¬ç©ºé–“ã‚’éè² ã®æ•´æ•°å…¨ä½“ $\mathcal{X} = \{0, 1, 2, \cdots\}$ ã¨ã—ï¼Œ
$p(k = \Pr(X=k))$ ã¨ã™ã‚‹ï¼ $\vert s\vert\leq 1$ ã¨ãªã‚‹ $s$ ã«å¯¾ã—ã¦ï¼Œ

$$
G_X(s) = \mathbb E[s^x] = \sum_{k=0}^\infty s^kp(k)
$$

ã‚’ç¢ºç‡æ¯é–¢æ•°ã¨ã„ã†ï¼

</div>

$p(x)\geq 0, \sum p(k)=1$ ã‚ˆã‚Š $\vert s\vert \leq 1$ ã®ç¯„å›²ã§ $\sum_{k=0}^\infty s^kp(k)$ ã®åæŸãŒä¿è¨¼ã•ã‚Œã‚‹ã®ã§ï¼Œ
ã€Œ$\vert s\vert\leq 1$ ã¨ãªã‚‹ $s$ ã«å¯¾ã—ã¦ã€ã¨ã„ã†æ¡ä»¶ãŒä»˜ãã¾ã™ï¼

<strong > &#9654;&nbsp; PGFã¨é›¢æ•£ç¢ºç‡é–¢æ•°</strong>

PGFã®å®šç¾©ã‚ˆã‚Š $p(0) = G_X(0), p(1) = G_X^\prime(0), p(2) = \frac{1}{2!}G_X^{\prime\prime}(0)$ ã¨ãªã‚Šã¾ã™ï¼ä¸€èˆ¬ã«ï¼Œ

$$
p(k) = \frac{1}{k!}\frac{\mathrm{d}^k}{\mathrm{s}^k}G_X(s)\bigg|_{s=0}
$$

ã¾ãŸï¼Œ$G_X(s) = \sum_{k=0}^\infty s^kp(k)$ ã‚ˆã‚Šï¼Œ

$$
G_X(1) = 1
$$

ã«ãªã‚‹ã“ã¨ã‚‚åˆ†ã‹ã‚‹ï¼ã“ã®ã‚ˆã†ã«ç¢ºç‡æ¯é–¢æ•°ãŒä¸ãˆã‚‰ã‚Œã‚Œã°ï¼Œ$G_X(s)$ ã‚’ $k$ å›å¾®åˆ†ã—ï¼Œ$s=0$ ã¨ç½®ãã“ã¨ã§ï¼Œ$p(k)$
ã‚’å†ç¾ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ã‹ã‚‰ï¼Œéè² æ•´æ•°ä¸Šã®ç¢ºç‡åˆ†å¸ƒã¨ãã®ç¢ºç‡æ¯é–¢æ•°ã¯ï¼‘å¯¾ï¼‘ã«å¯¾å¿œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

::: {#exm- .custom_problem }
**: PGFã‹ã‚‰ç¢ºç‡é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹**
<br>

ç¢ºç‡å¤‰æ•° $X$ ã«ã¤ã„ã¦ï¼ŒPGFãŒ $G_X(s) = \frac{s}{5}(2 + 3s^2)$ ã¨ä¸ãˆã‚‰ã‚Œã¦ã‚‹ã¨ã—ã¾ã™ï¼
ã“ã®ã¨ãï¼Œ

$$
\begin{align*}
G_X(0) &= \Pr(X=0) = 0\\
G_X^\prime(0) &= \Pr(X=1) = \frac{2}{5}\\
\frac{1}{2!}G_X^{\prime\prime}(0) &= \Pr(X=2) = 0\\
\frac{1}{3!}G_X^{\prime\prime\prime}(0) &= \Pr(X=3) = \frac{3}{5}\\
G_X^{(r)}(0) &= 0 \quad\forall r\geq 4
\end{align*}
$$

å¾“ã£ã¦ï¼Œ

$$
X = \bigg\{\begin{array}{c}
    1 &\text{with probability} \frac{2}{5}\\
    3 &\text{with probability} \frac{3}{5}
\end{array}
$$

ã¨ãªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™

:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: PGFã¨éšä¹—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ**
<br>

ç¢ºç‡å¤‰æ•° $X$ ã«ã¤ã„ã¦ï¼ŒPGFãŒ $G_X(s)$ ã¨ä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨ãï¼Œ

<div class="math display" style="overflow: auto">
$$
\begin{align*}
&\mathbb E[X] = G_X^\prime(1)\tag{a}\\
&\mathbb E[X(X-1)\cdots(X-k)] = G_X^{(k)}(1)\tag{b}
\end{align*}
$$
</div>

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

<strong > &#9654;&nbsp; (a)ã®è¨¼æ˜</strong>

$$
\begin{align*}
G^\prime_X(s) = \sum_{x=0}^\infty x s^{x-1}p(x)
\end{align*}
$$

å¾“ã£ã¦ï¼Œ

$$
\begin{align*}
G^\prime_X(1) 
    &= \sum_{x=0}^\infty x p(x)\\
    &= \mathbb E[X]
\end{align*}
$$


<strong > &#9654;&nbsp; (b)ã®è¨¼æ˜</strong>

$$
G^{(k)}_X(s) = \sum_{x=0}^\infty x(x-1)\cdots(x-k) s^{x-k}p(x)
$$

å¾“ã£ã¦ï¼Œ

$$
G^{(k)}_X(1) = \mathbb E[X(X-1)\cdots(X-k)]
$$


:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
**: ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•°ã®å’Œã«ã¤ã„ã¦ã®PGF**
<br>

äº’ã„ã«ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•° $X_1, \cdots, X_n$ ã«ã¤ã„ã¦ï¼Œ$Y = \sum_{i=1}^nX_i$ ã¨å®šç¾©ã™ã‚‹ï¼ã“ã®ã¨ãï¼Œ

$$
G_Y(s) = \prod_{i=1}^nG_{X_i}(s)
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
G_Y(s)
    &= \mathbb E[s^{(X_1+\cdots+X_n)}]\\
    &= \mathbb E[s^{X_1}\cdots s^{X_n}]\\
    &= \mathbb E[s^{X_1}]\cdots \mathbb E[s^{X_n}] \because\text{ äº’ã„ã«ç‹¬ç«‹}\\
    &=\prod_{i=1}^nG_{X_i}(s)
\end{align*}
$$


:::

<div class="blog-custom-border">
::: {#thm- .custom_problem }
<br>

ç¢ºç‡å¤‰æ•°åˆ— $X_1, X_2, \cdots \overset{\mathrm{iid}}{\sim}  F$ ã¨ã—ï¼Œå„ç¢ºç‡å¤‰æ•° $X_i$ ã®ç¢ºç‡æ¯é–¢æ•°ã‚’ $G_X(s)$ ã§è¡¨ã™ã¨ã™ã‚‹ï¼
$\{X_i\}_{i=1}$ ã¨äº’ã„ã«ç‹¬ç«‹ãªç¢ºç‡å¤‰æ•° $N$ ã‚’è€ƒãˆï¼Œæ–°ãŸã«ä»¥ä¸‹ã®å½¢ã§ç¢ºç‡å¤‰æ•° $T_N$ ã‚’å®šç¾©ã™ã‚‹:

$$
T_N = X_1 + \cdots + X_N
$$

ã“ã®ã¨ãï¼Œ$T_N$ ã«ã¤ã„ã¦ã®ç¢ºç‡æ¯é–¢æ•°ã¯

$$
G_{T_N}(s) = G_N(G_X(s))
$$

:::

</div>

::: {.callout-note collapse="false" icon=false}
## Proof

$$
\begin{align*}
G_{T_N}(s) 
&= \mathbb{E}(s^{T_N})\\
&= \mathbb{E}\left( s^{X_1 + \cdots + X_N} \right)\\
&= \mathbb{E}_N \left\{ \mathbb{E} \left( s^{X_1 + \cdots + X_N} \mid N \right) \right\} \quad \text{(conditional expectation)}\\
&= \mathbb{E}_N \left\{ \mathbb{E} \left( s^{X_1} \cdots s^{X_N} \mid N \right) \right\}\\
&= \mathbb{E}_N \left\{ \mathbb{E} \left( s^{X_1} \cdots s^{X_N} \right) \right\} \quad (X_i \text{ã¨} N \text{ã¯äº’ã„ã«ç‹¬ç«‹})\\
&= \mathbb{E}_N \left\{ \mathbb{E} \left( s^{X_1} \right) \cdots \mathbb{E} \left( s^{X_N} \right) \right\} \quad (X_i \text{ã¯äº’ã„ã«ç‹¬ç«‹})\\
&= \mathbb{E}_N \left\{ \left( G_X(s) \right)^N \right\}\\
&= G_N\left( G_X(s) \right) \quad (G_N\text{ã®å®šç¾©ã‚ˆã‚Š})
\end{align*}
$$

:::

::: {#exm- .custom_problem }
**: ATMã®å¼•ãå‡ºã—é‡‘é¡**
<br>

ã¨ã‚ã‚‹ATMã§ãŠé‡‘ã‚’å¼•ãå‡ºã™äººã®ä¸€æ—¥ã‚ãŸã‚Šã®åˆè¨ˆäººæ•° $N$ ã¨ã„ã†ç¢ºç‡å¤‰æ•°ã‚’è€ƒãˆã‚‹ï¼
ATMã§å„å€‹äººãŒå¼•ãå‡ºã™é‡‘é¡ $X_i$ ã¯ äº’ã„ã«ç‹¬ç«‹ã« å¹³å‡ $\mu$, åˆ†æ•£ $\sigma^2$, PGF $G_X(s)$ ã®åŒä¸€åˆ†å¸ƒã«å¾“ã†ã¨ã—ã¾ã™ï¼

ã“ã®ã¨ãï¼Œä¸€æ—¥ã‚ãŸã‚Šã®ATMå¼•ãå‡ºã—é‡‘é¡ $T_N = X_1 + \cdots + X_N$ ã«ã¤ã„ã¦ï¼Œ

$$
\begin{align*}
\mathbb E[T_n]
    &= G_N^\prime(G_X(1))\cdot G_X^\prime(1)\\
    &= G_N^\prime(1) \cdot \mathbb E[X_i] \quad\because G_X(1) = 1\\
    &= \mathbb E[N] \cdot \mathbb E[X_i]
\end{align*}
$$

ã¨æœŸå¾…å€¤ã‚’è¡¨ã™ã“ã¨ãŒã§ãã‚‹ï¼

:::

<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

ç©ç‡æ¯é–¢æ•°ã¨ç¢ºç‡æ¯é–¢æ•°ã«ã¤ã„ã¦ä»¥ä¸‹ã®é–¢ä¿‚ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™:

$$
\begin{align*}
G_X(t) &= M_X(\log(t))\\
M_X(t) &= G_X(\exp(t))
\end{align*}
$$

ä»¥ä¸Šã‚ˆã‚Šï¼Œä¸€æ–¹ãŒæ±‚ã¾ã£ã¦ã„ã‚Œã°ï¼Œãã‚Œã‚’ã‚‚ã¨ã«ã‚‚ã†ä¸€æ–¹ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼


</div>