---
title: "é †åºçµ±è¨ˆé‡"
jupyter: python3
author: "Ryo Nakagtami"
date: "2024-09-07"
date-modified: last-modified
comments:
    utterances:
         repo: RyoNakagami/statistics-for-regression-monkey
         label: discussion
# when you run this file locally, do not forget to run poetry shell
---

## é †åºçµ±è¨ˆé‡

<div class="blog-custom-border">
<strong>Def: é †åºçµ±è¨ˆé‡</strong> <br>

$X_1, \cdots, X_n \overset{\mathrm{iid}}{\sim} F$ ã¨ã™ã‚‹ã¨ãï¼Œã“ã‚Œkã‚‰ã®ç¢ºç‡å¤‰æ•°ã®å€¤ã‚’å°ã•ã„é †ã«ä¸¦ã³æ›¿ãˆãŸã‚‚ã®ã‚’

$$
X_{(1)}\leq\cdots\leq X_{(i)}\leq\cdots \leq X_{(n)}
$$

ã¨è¡¨ã—ï¼Œé †åºçµ±è¨ˆé‡(order statistic)ã¨ã„ã†ï¼

</div><br>

<strong > &#9654;&nbsp; $X_{(i)}$ ã®ç´¯ç©å¯†åº¦é–¢æ•°ã¨ç¢ºç‡å¯†åº¦é–¢æ•°</strong>

$F$ ã‚’å¯†åº¦é–¢æ•° $f$ ã‚’æŒã¤é€£ç¶šåˆ†å¸ƒã¨ã—ã¦ï¼Œ$X_{(i)} \leq x$ ã¨ãªã‚‹äº‹è±¡ã‚’è€ƒãˆã‚‹ï¼ã“ã®äº‹è±¡ã¯
$X_1, \cdots, X_n$ ã®ãªã‹ã§ $x$ ä»¥ä¸‹ã¨ãªã‚‹ã‚‚ã®ã®å€‹æ•°ãŒ $i$ å€‹ä»¥ä¸Šã§ã‚ã‚‹ã¨ã„ã†äº‹è±¡ã¨åŒåœ°ãªã®ã§

$$
B_k = \{X_1, \cdots, X_n\text{ã®ã†ã¡}k\text{å€‹ãŒ}x\text{ä»¥ä¸‹}\}
$$

ã¨äº‹è±¡ $B_k$ ã‚’è¨­å®šã™ã‚‹ã¨ï¼Œ

$$
\Pr(X_{(i)}\leq x) = \sum_{k=i}^n \Pr(B_k)
$$

ãã‚Œãã‚Œã® $X_j$ ã«ã¤ã„ã¦ï¼Œç‹¬ç«‹ã«æˆåŠŸç¢ºç‡ $p = F(x)$ ã®ãƒ™ãƒ«ãƒŒãƒ¼ã‚¤è©¦è¡Œã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§

$$
F_{X_{(i)}}(X) = \sum_{k=i}^n {}_nC_{k} p^k (1 - p)^{n-k}, \ \ p=F(x)
$$

ã¨ãªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ã¾ãŸï¼Œã“ã®å¼ã‚’ $x$ ã§å¾®åˆ†ã™ã‚‹ã“ã¨ã§ $X_{(i)}$ ã®ç¢ºç‡å¯†åº¦é–¢æ•°ãŒã‚ã‹ã‚‹ã®ã§, $p(k, m)$ ã‚’ $\operatorname{Binom}(m, p)$ ã®ç¢ºç‡é–¢æ•°ã¨ã™ã‚‹ã¨

$$
\begin{align*}
&\frac{\mathrm{d}}{\mathrm{d}p} {}_nC_{k} p^k (1 - p)^{n-k}\\
&= \frac{n!}{(k-1)!(n-k)!}p^{k-1}(1-p)^{n-k} - \frac{n!}{k!(n-k-1)!}p^{k-1}(1-p)^{n-k-1}\\
&= n (p(k-1, n-1) - p(k. n-1))
\end{align*}
$$

å¾“ã£ã¦ï¼Œ$p(n, n-1) =0$ ã¨ã™ã‚‹ã¨ï¼Œ

$$
\begin{align*}
f_{X_{(i)}}(x) &= nf(x)\sum_{k=i}^n(p(k-1, n-1) - p(k. n-1))\\
               &= nf(x) p(i-1, n-1)\\
               &= \frac{n!}{(i-1)!(n-i)!}f(x)F(x)^{i-1}(1 - F(x))^{n-i}
\end{align*}
$$

<strong > &#9654;&nbsp; æœ€å¤§å€¤ã®åˆ†å¸ƒé–¢æ•°</strong>

æœ€å¤§å€¤ã®åˆ†å¸ƒé–¢æ•° $\Pr(X_{(n)} \leq x)$ ã¯ 

$$
\max_i X_i \leq x \Leftrightarrow X_i \leq x, \  \ i = 1, \cdots, n
$$

ãªã®ã§ï¼Œ

$$
\begin{align*}
&\Pr(\max_i X_i \leq x )= F(x)^n\\
&f_{X_{(n)}}(x) = nf(x)F(x)^{n-1}
\end{align*}
$$

<strong > &#9654;&nbsp; æœ€å°å€¤ã®åˆ†å¸ƒé–¢æ•°</strong>

æœ€å°å€¤ã®åˆ†å¸ƒé–¢æ•° $\Pr(X_{(1)} \leq x) = \Pr(\min(X_i)\leq x)$ ã¯ 

$$
\min_i X_i > x \Leftrightarrow X_i > x, \  \ i = 1, \cdots, n
$$

ã‚ˆã‚Š

$$
\begin{align*}
&\Pr(\min_i X_i \leq x )= 1 - (1 - F(x))^n\\
&f_{X_{(1)}}(x) = nf(x)(1 - F(x))^{n-1}
\end{align*}
$$

<div style='padding-left: 2em; padding-right: 2em; border-radius: 0em; border-style:solid; border-color:#00008B;'>
::: {#exm- .custom_problem } 
**ä¸€æ§˜åˆ†å¸ƒã«å¾“ã†ç¢ºç‡å¤‰æ•°åˆ—ã®é †åºçµ±è¨ˆé‡ã¨ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒ**
<br>

$X_1, \cdots, X_n \overset{\mathrm{iid}}{\sim} \operatorname{Unif}(0, 1)$ ã¨ã™ã‚‹ã¨ãï¼Œç¬¬ $i$ é †åºçµ±è¨ˆé‡ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã¨åˆ†å¸ƒé–¢æ•°ã¯ãã‚Œãã‚Œä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹

$$
\begin{align*}
f_{X_{(i)}} &= \frac{n!}{(i-1)!(n-i)!} x^{i-1}(1 - x)^{n-i}\\
            &= \frac{x^{i-1}(1 - x)^{n-i}}{\operatorname{B}(i, n-i+1)}\\
F_{X_{(i)}} &= \sum_{k=i}^n \frac{n!}{(n-k)!k!} x^k (1 - x)^{n-k}\\
            &= \frac{n!}{(i-1)!(n-i)!}\int^x_0t^{i-1}(1 - t)^{n-i}\mathrm{d}t
\end{align*}
$$

å¾“ã£ã¦ï¼Œ$X_{(i)}$ ã¯ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒ $\operatorname{Beta}(i, n-i+1)$ ã«å¾“ã†ã“ã¨ãŒã‚ã‹ã‚‹ï¼ã“ã“ã‹ã‚‰ $\operatorname{Beta}(1, 1)$ ãŒ 
$\operatorname{Unif}(0, 1)$ ã«ç­‰ã—ããªã‚‹ã“ã¨ã‚‚ã‚ã‹ã‚‹ï¼

:::

</div>

```{python}
import numpy as np
from scipy.stats import beta
import plotly.express as px
import plotly.graph_objects as go

N = 10
ITER = 10000
I = 9
NBINS = 100
a, b = 10, 1
np.random.seed(42)


def random_sampling_from_unif(index, size):
    return sorted(np.random.uniform(0, 1, size))[index]


x = np.array(list(map(lambda x: random_sampling_from_unif(I, N), range(ITER))))
beta_x = np.linspace(beta.ppf(0.01, a, b), beta.ppf(0.99, a, b), NBINS)

# plot
newnames = {"0": "sample maximum"}
fig = px.histogram(x, histnorm="probability density", nbins=NBINS, title="maximum value distribution of 10 rvs from Unif(0, 1)")
fig.for_each_trace(
    lambda t: t.update(
        name=newnames[t.name],
        hovertemplate=t.hovertemplate.replace(t.name, newnames[t.name]),
    )
)
fig.add_trace(
    go.Scatter(
        x=beta_x, y=beta.pdf(beta_x, a, b), mode="lines", name="beta(10, 1) pdf"
    ),
    row=1,
    col=1,
)
fig.show()
```

## æœ€å¤§å€¤ã¨æœ€å°å€¤ã®åŒæ™‚å¯†åº¦é–¢æ•°

<div style='padding-left: 2em; padding-right: 2em; border-radius: 0em; border-style:solid; border-color:#00008B;'>
::: {#thm- .custom_problem }
**æœ€å¤§å€¤ã¨æœ€å°å€¤ã®åŒæ™‚å¯†åº¦é–¢æ•°**
<br>

$X_1, \cdots, X_n \overset{\mathrm{iid}}{\sim} F$ ã¨ã™ã‚‹ã¨ãï¼Œ$x<y$ ã¨ã™ã‚‹ã¨

$$
\begin{align*}
F_{X_{(1)},X_{(n)}}(x, y) &= \Pr(X_{(1)} \leq x,X_{(n)}\leq y)\\
                          &= [F(y)]^n - [F(y) - F(x)]^n
\end{align*}
$$

åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯

$$
f_{X_{(1)},X_{(n)}}(x, y) = n(n-1)[F(y) - F(x)]^{n-2}f(x)f(y)
$$


:::

</div>

$x < y$ ã®æ¡ä»¶ã®ã‚‚ã¨ã§ï¼Œ

$$
F_{X_{(1)},X_{(n)}}(x, y) = \Pr(X_{(1)} \leq x,X_{(n)}\leq y)
$$

ã«ã¤ã„ã¦ã¾ãšè€ƒãˆã‚‹ï¼ç¢ºç‡äº‹è±¡ã®æ’ä»–æ€§ã‚ˆã‚Š

$$
\Pr(X_{(n)} \leq y) = \Pr(X_{(1)}\leq x, X_{(n)}\leq y) + \Pr(X_{(1)}> x, X_{(n)}\leq y)
$$

ã“ã“ã‹ã‚‰ï¼Œ$\Pr(X_{(1)}\leq x, X_{(n)}\leq y) = \Pr(X_{(n)} \leq y) - \Pr(X_{(1)}> x, X_{(n)}\leq y)$ ã‚’å¾—ã‚‹ï¼

$$
\begin{align*}
&\Pr(X_{(1)}> x, X_{(n)}\leq y)\\
&= \Pr(x < X_{(1)} \leq y, \cdots, x < X_{(i)} \leq y, \cdots, x< X_{(n)}\leq y)\\
&= [F(y) - F(x)]^n \because{\operatorname{i.i.d}}
\end{align*}
$$

$\Pr(X_{(n)}\leq y) = [F(y)]^n$ ã§ã‚ã‚‹ã®ã¯ä¸Šã§ç¢ºèªã—ãŸã®ã§ï¼Œå¾“ã£ã¦ï¼Œ

$$
\begin{align*}
F_{X_{(1)},X_{(n)}}(x, y) &= \Pr(X_{(1)} \leq x,X_{(n)}\leq y)\\
                          &= [F(y)]^n - [F(y) - F(x)]^n
\end{align*}
$$

åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯

$$
\begin{align*}
f_{X_{(1)},X_{(n)}}(x, y) &= \frac{\mathrm{d}}{\mathrm{d}x}\frac{\mathrm{d}}{\mathrm{d}x}\{[F(y)]^n - [F(y) - F(x)]^n\}\\
&= \frac{\mathrm{d}}{\mathrm{d}x}\{n[F_y]^{n-1}f(y) - n[F(y) - F(x)]^{n-1}f(y)\}\\
&= n(n-1)[F(y) - F(x)]^{n-2}f(y)f(x)
\end{align*}
$$

<strong > &#9654;&nbsp; A heuristic approach for calculating the joint pdf</strong>

$\min X_i = x, \max X_i =y$, ã¨æ±ºã¾ã£ã¦ãŠã‚Š, ãã‚Œä»¥å¤–ã®å€¤ã¯ $(x, y)$ åŒºé–“ã«åã¾ã£ã¦ã„ã‚Œã°ä½•ã§ã‚‚è‰¯ã„ã®ã§ï¼Œ
indexé€šã‚Šã«é †ç•ªãŒã‚ã‚‹ãªã‚‰ã°

$$
f(x)[F(y) - F(x)]^{n-2}f(y)
$$

ã¾ãŸï¼Œã“ã®ä¸¦ã¹æ–¹ã¯ $n!$ é€šã‚Šå­˜åœ¨ã™ã‚‹ãŒï¼Œ$X_{(1)}, X_{(n)}$ ä»¥å¤–ã®ä¸¦ã³æ–¹ã«ã¯åŒºåˆ¥ã¯ã„ã‚‰ãªã„ã®ã§

$$
\frac{n!}{(n-2)!}f(x)[F(y) - F(x)]^{n-2}f(y) = n(n-1)f(x)[F(y) - F(x)]^{n-2}f(y)
$$

<div class="blog-custom-border">
<strong >ğŸ“˜ REMARKS</strong> <br>

ä¸¦ã³æ›¿ãˆã®è€ƒãˆã§åŒæ§˜ã« $(X_{(1)}, \cdots, X_{(n)})$ ã®åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯

$$
f_{X_{(1)}, \cdots, X_{(n)}}(x_1, \cdots, x_n) = n!f(x_1)f(x_2)\cdots f(x_n)
$$

ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ï¼

$X_{(i)}, X_{(j)}$ ã®åŒæ™‚ç¢ºç‡å¯†åº¦é–¢æ•°ã¯

$$
f_{X_{(i)}, X_{(j)}}(x, y)=\frac{n!}{(i-1)!(j-i-1)!}(n-j)!f(x)f(y)F(x)^{i-1}[F(y)-F(x)]^{j-i-1}[1 - F(y)]^{n-j}
$$



</div>
